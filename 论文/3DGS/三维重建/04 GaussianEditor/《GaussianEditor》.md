---
title: "GaussianEditor: Swift and Controllable 3D Editing with Gaussian Splatting"
uid: "202404090953"
create_time: 2024-04-09 09:36
title translation: GaussianEditor：使用高斯泼溅进行快速可控的 3D 编辑
grade: CVPR 2024
author: 
date: 
DOI: 
url:
  - https://arxiv.org/abs/2311.14521
banner: "[[]]"
---

> [!abstract] 
3D 编辑在游戏和虚拟现实等许多领域中起着至关重要的作用。传统的 3D 编辑方法，依赖于像网格和点云这样的表示方式，往往无法真实地描绘复杂的场景。另一方面，基于隐式 3D 表示的方法，如神经辐射场（NeRF），能够有效地渲染复杂的场景，但处理速度较慢，并且对特定场景区域的控制有限。
针对这些挑战，我们的论文提出了 GaussianEditor，一种基于高斯泼溅（GS）的创新高效的 3D 编辑算法，这是一种新颖的 3D 表示方法。GaussianEditor 通过我们提出的**高斯语义追踪**（Gaussian semantic tracing）来增强编辑的精度和控制能力，在训练过程中追踪编辑目标。此外，我们提出了**分层高斯泼溅**（HGS）来在二维扩散模型（2D diffusion models）的随机生成指导下实现稳定和精细的结果。我们还开发了高效的物体移除和整合（removal and integration）的编辑策略，这是现有方法面临的一个具有挑战性的任务。
我们的综合实验证明了 GaussianEditor 在控制能力、效果和快速性方面的优势，标志着 3D 编辑领域的重大进展。

## 1 介绍
在不断发展的计算机视觉领域中，开发用户友好的 3D 表示和编辑算法是一个关键目标。这些技术在各种应用中至关重要，从数字游戏到不断发展的元宇宙。传统的 3D 表示方法，如网格和点云，由于其交互式编辑能力而备受青睐。然而，这些方法在准确渲染复杂的 3D 场景方面面临挑战。
最近隐式3D 表示的兴起，以神经辐射场（NeRF）[28]为例，代表了3D 场景渲染的范式转变。NeRF 具有高保真度渲染的能力，结合其隐式性质提供的显著扩展性，相比传统方法[2, 55, 32]有了实质性的改进。这种双重优势使得 NeRF 框架在3D 编辑[45, 46, 12, 57, 31]中受到了重点关注，并确立了它作为一个重要方法的基础。**然而，NeRF 对于场景数据编码依赖于高维多层感知（MLP）网络，存在一定的限制。它限制了对特定场景部分的直接修改，并且使内部绘制（inpainting） 和场景合成等任务变得复杂。这种复杂性延伸到训练和渲染过程中，阻碍了实际应用。**

**鉴于这些挑战，我们的研究重点是开发一种先进的 3D 编辑算法。** 该算法旨在实现对 3D 场景的灵活和快速编辑，集成了隐式编辑（如基于文本的编辑）和显式控制（例如使用 bounding box 对特定区域进行修改）。为了实现这些目标，我们选择了高斯泼溅（GS）[15]，因为它具有实时渲染和显式**类点云（point cloud-like）** 表示的特点。
然而，编辑高斯泼溅（GS）[15]面临着独特的挑战。**一个主要问题是缺乏准确识别目标高斯的有效方法，这对于精确可控的编辑至关重要**。此外，已经观察到**使用高度随机的生成指导（generative guidance，如分数蒸馏采样[36]）优化高斯泼溅（GS）存在重大挑战**[7, 44, 52]。一个可能的解释是，与神经网络缓冲的隐式表示不同，GS 直接受到 loss 的随机性的影响。这种直接暴露导致更新不稳定，因为在训练过程中直接改变了高斯的属性。此外，GS 的每个训练步骤可能涉及对大量高斯点的更新。在没有神经网络风格的缓冲机制的调节影响下，这个过程会导致 3D GS 场景过于流动，使其在使用生成指导进行训练时无法收敛到像隐式表示那样精细的结果。

---

为了应对这些问题，在这项工作中，我们提出了一种新颖、快速、高度可控的高斯泼溅三维编辑算法 GaussianEditor。GaussianEditor 可以在几分钟内满足各种高质量编辑需求。**我们方法的一个关键特点是引入了高斯语义追踪（Gaussian semantic tracing），这使得对高斯泼溅（GS）的精确控制成为可能**。高斯语义追踪在训练过程中始终准确识别需要编辑的高斯。
这与传统的三维编辑方法形成对比，传统方法通常依赖于静态的二维或三维遮罩（masks）。随着三维模型的几何形状和外观在训练过程中的变化，这些遮罩的效果会逐渐减弱。**高斯语义追踪通过将 2D 分割遮罩映射到 3D 高斯并为每个高斯分配一个语义标签（semantic tag）来实现。** 随着高斯在训练过程中的演化，这些语义标签使得可以追踪特定的高斯用于编辑。我们的高斯追踪算法确保只有目标区域被修改，实现精确可控的编辑。

---

**此外，为了解决高斯泼溅（GS）在高度随机生成引导下难以适应精细结果（fine results）的重要挑战，我们提出了一种新的 GS 表示方法：分层高斯泼溅（HGS）。** 在 HGS 中，高斯根据它们在多次密集化过程中的顺序被组织成不同的世代（generations）:
- 在较早的密集化阶段形成的高斯被视为 **older  generations**，并受到更严格的约束，旨在保持它们的原始状态，从而减少它们的移动性。
- 相反，在后期形成的高斯被视为 **younger generations**，并受到较少或没有约束，从而具有更高的适应性。

HGS 的设计通过对 older  generations 的限制，同时保留 younger generations 的灵活性，有效地调节了 GS 的流动性。这种方法能够持续优化以获得更好的结果，从而**模拟通过神经网络实现的隐式表示中所实现的缓冲功能**。我们的实验还表明，**HGS 更擅长适应高度随机的生成指导。** 

---

**最后，我们专门为高斯泼溅（GS）设计了一种 3D 修复算法**。如图 1 所示，我们成功地从场景中移除了特定的对象，并将新对象无缝地集成到指定的区域。
- 对于对象的移除，我们开发了一种专门的局部修复算法，能够高效地消除对象和场景相交处的伪影。
- 对于添加对象，我们首先要求用户提供一个提示（prompt）和一个针对 GS 特定视角的二维内绘（inpainting）遮罩。随后，我们采用二维内绘方法生成待添加对象的单视角图像。
- 然后，将该图像使用图像到 3D 转换技术转换为粗糙（coarse） 3D 网格。随后，将 3D 网格转换为 HGS 表示并进行细化（refined）。最后，将这个细化的表示连接到原始的 GS 中。
上述整个修复过程在 5 分钟内完成。
![[Pasted image 20240409095848.png]]
>图 1：GaussianEditor 的结果。GaussianEditor 提供快速、可控和多功能的 3D 编辑。单个编辑会话（editing session）只需要 5-10 分钟。请注意我们精确的编辑控制，只修改所需的部分。以图中第一行的“让草着火”为例，场景中的其他对象，如长椅和树木，保持不受影响。

GaussianEditor 提供快速、可控和多功能的 3D 编辑。单个编辑会话（editing session）只需要 5-10 分钟，比以前的编辑过程快得多。**我们的贡献可以总结为四个方面：**
1. 我们引入了高斯语义追踪（Gaussian semantic tracing,），实现了更详细和有效的编辑控制。
2. 我们提出了分层高斯泼溅（HGS），这是一种新颖的 GS 表示，能够在高度随机生成的指导下更稳定地收敛到细化的结果。
3. 我们专门为高斯泼溅设计了一种 3D 修复算法，可以快速删除和添加对象。
4. 大量实验证明，我们的方法在效果、速度和可控性方面超过了以前的 3D 编辑方法。

## 2 相关工作
### 2.1 3D 表示
各种 3D 表示方法已经被提出来解决不同的 3D 任务。开创性的工作，神经辐射场（NeRF）[28]采用体积渲染，因其仅需 2D 监督即可实现 3D 优化而受到欢迎。然而，尽管在 3D 重建[21, 6, 3, 13]和生成[35, 22]任务中被广泛使用，但优化 NeRF 可能耗时较长。尽管已经努力加速 NeRF 训练[29, 40]，但这些方法主要集中在重建设置上，对生成设置的优化较少。常见的空间剪枝技术（spatial pruning）并不能有效加速生成设置。

最近，3D 高斯泼溅[15]已经成为 NeRF 的另一种替代 3D 表示方法，在 3D 和 4D 重建任务[15, 26, 50, 47, 51]中展示出令人印象深刻的质量和速度。它还在生成领域[7, 44, 52]引起了相当大的研究兴趣。其高效的可微分渲染实现和模型设计有助于快速训练，无需进行空间剪枝。

在这项工作中，我们首次将 3DGS 技术应用于 3D 编辑任务，旨在实现快速和可控的 3D 编辑，首次在这个背景下利用了这种表示的优势。

### 2.2 3D 编辑
由于形状和外观之间错综复杂的相互作用，编辑神经场本质上是具有挑战性的。EditNeRF [24]是该领域的开创性工作，他们通过对潜在代码进行调节来同时编辑神经场的形状和颜色。此外，一些工作[45, 46, 10, 1]利用 CLIP 模型通过文本提示或参考图像来促进编辑。

另一方面的研究关注于预定义的模板模型或骨架 （models or skeletons），以支持特定类别内的重新姿势或重新渲染等操作[33, 30]。基于几何的方法[54, 49, 48, 20]将神经场转化为网格，并将网格变形与隐式场同步。此外，3D 编辑技术涉及将 2D 图像处理（如修复）与神经场训练[23, 19]相结合。

并行工作[31, 57]利用静态的 2D 和 3D 遮罩来限制 NeRF 的编辑区域。然而，这些方法有其局限性，因为 3D 模型的训练是一个动态的过程，静态掩模无法有效地限制它。相比之下，我们的研究采用高斯语义追踪来跟踪整个训练过程中的目标高斯。

# 3  前期
## 3.1 3D 高斯泼溅介绍
略
##  3.2 基于扩散的编辑指导
Diffusion-based Editing Guidance

最近的进展已经看到许多作品将 2D 扩散过程提升到 3D，并广泛应用于 3D 编辑领域。广义上，这些作品可以分为两类。第一类[36, 31, 57, 42, 27, 8]，以 Dreamfusion 的[36]引入的 SDS 损失为例，将当前 3D 模型的噪声渲染以及其他条件输入到 2D 扩散模型[39]中。扩散模型生成的分数然后指导模型更新的方向。第二类[12, 43, 37, 5]侧重于根据给定的多视角渲染的提示进行 2D 编辑。这种方法创建一个多视角 2D 图像数据集，然后将其用作训练目标，为 3D 模型提供指导。

**我们的工作集中在利用 GS 的显式表示的优点来增强 3D 编辑。因此，我们不设计特定的编辑指导机制，而是直接使用上述的指导方法。**

我们的方法可以应用这两种类型的指导（guidance）。为简单起见，我们将 guidance 普遍表示为 $D$ 。给定 3D 模型的参数 $\Theta$ ，以及渲染的相机姿态 $p$ 和提示（prompt） $e$ ，从 2D 扩散先验的编辑 loss 可以表示如下：
$$
\mathcal{L}_{\mathrm{Edit}}=D(\Theta;p,e)\tag{5}
$$

# 4 方法
我们将基于高斯泼溅（GS）的 3D 编辑任务定义如下：
- 给定一个提示（prompt） $y$ 和由 3D 高斯表示的 3D 场景，记为 $\Theta$ ，其中每个 $\Theta_i=\{x_i,s_i,q_i,\alpha_i,c_i\}$ 表示第 $i$ 个高斯的参数
- 目标是实现一个编辑后的 3D 高斯，称为 $\Theta_y$ ，使其符合提示 $y$ 的规格。

然后，我们介绍了在 GS 上执行编辑任务的新框架。
- 第 4.1 节：介绍了高斯语义追踪
- 第 4.2 节：介绍一种称为分层高斯泼溅（HGS）的新表示方法。GS 语义追踪能够在 GS 内进行精确的分割和追踪，从而促进可控的编辑操作。相对于标准的 GS，HGS 表示在生成引导的随机性方面表现出更强的鲁棒性，并且更擅长适应各种编辑场景。
- 第 4.3 节：专门为 GS 设计了 3D 修复，包括物体的移除和添加。

## 4.1 高斯语义追踪
Gaussian Semantic Tracing

以往的研究[31, 57]在 3D 编辑中通常使用静态的 2D 或 3D 遮罩（mask），仅在遮罩像素内应用 loss ，从而将编辑过程限制在所需区域内。然而，这种方法存在局限性。随着 3D 表示在训练过程中动态变化，静态分割遮罩将变得不准确甚至无效。
此外，在 NeRF 编辑中使用静态遮罩来控制梯度存在显著的限制，因为它严格限制了编辑范围仅在遮罩区域内。此限制防止编辑内容自然地超出遮罩范围，从而将内容“锁定”在指定的空间边界内。
即使实施了语义 NeRF [56]，梯度控制仍然只在训练的最开始阶段有效，因为对 NeRF 的持续更新导致语义领域的准确性丧失。

**为解决上述问题，我们选择了高斯泼溅（GS）作为我们的 3D 表示，因为它具有显式特性。这使得我们能够直接为每个高斯点分配语义标签（semantic labels），从而便于在 3D 场景中进行语义追踪。**
**具体来说，我们通过添加一个新属性 $m$ 来增强 3D 高斯 $\Theta$ ，其中 $m_{ij}$ 表示第 $i$ 个高斯点和第 $j$ 个语义标签的高斯语义遮罩。有了这个属性，我们可以通过选择性地仅更新目标 3D 高斯来精确控制编辑过程。在密集化过程中，密集化产生的新点继承其父点的语义标签。这确保了在训练过程中的每一时刻都有准确的 3D 语义遮罩。**

![[Pasted image 20240409110507.png]] 
>图 2：高斯语义追踪的示意图。提示：把他变成一个老太太。图像中的红色遮罩表示将要更新和密集化的高斯投影。通过高斯的更新驱动，遮罩区域在训练过程中动态变化，确保在整个训练过程中保持一致的有效性。尽管由于 2D 分割错误而导致的潜在不准确的分割遮罩，高斯语义追踪仍然保证了高质量的编辑结果。

如图 2 所示，高斯语义跟踪能够在训练过程中持续追踪每个高斯的类别，根据其不断变化的属性和数量进行调整。
这个功能非常重要，因为它允许选择性地应用梯度，对与指定类别相关的高斯进行密集化和剪枝。此外，它通过仅渲染目标对象来加速复杂场景中的训练过程。

高斯语义遮罩 $m$ 作为一个动态的 3D 分割遮罩，随着训练的进行而演化，允许内容在空间中自由扩展。而 NeRF 中的内容被限制在一个固定的空间区域内。
### 高斯泼溅反投影
接下来，我们讨论**高斯泼溅反投影（GS unprojection）**，这是我们提出的一种**获取高斯语义遮罩 $m$ 的方法**。

对于一组 3D 高斯 $\Theta$，我们从多个视点渲染它们，生成一系列渲染图像 $\mathcal{I}$。然后，使用 2D 分割技术[18]处理这些渲染图像，得到 2D 分割遮罩 $\mathcal{M}$，其中每个遮罩 $\mathcal{M}_j$ 表示第 $j$ 个语义标签。 

为了获取每个高斯的语义标签，我们使用逆渲染将 2D 语义标签反投影回高斯。具体来说，我们为每个高斯维护一个权重和一个计数器。对于语义映射（semantic maps）上的像素 $\mathcal{p}$ ，我们通过下面的公式将语义标签反投影回影响它的高斯中：
$$
w_i^j=\sum o_i(\boldsymbol{p})*T_i^j(\boldsymbol{p})*\mathcal M^j(\boldsymbol{p})\tag{6}
$$
其中，
- $w_i^j$ ：第 $i$ 个高斯对第 $j$ 个语义标签的权重
- $o_i(\boldsymbol{p})$：第 $i$ 个高斯的不透明度
- $T_i^j(\boldsymbol{p})$：像素 $p$ 的透射率（对应第 $i$ 个高斯）
- $M^j(\boldsymbol{p})$：像素 $p$ 的语义遮罩（对应第 $i$ 个高斯）

在更新所有高斯函数的权重和计数器后，我们根据其平均权重是否超过手动设置的阈值来确定一个高斯函数是否属于第 $j$ 个语义类别。

整个标注过程非常快速，通常不到一秒钟。一旦完成了这种语义标签分配，我们就可以对整个高斯场景进行解析，从而实现各种操作。这些操作包括手动更改颜色，移动特定类别的属性以及删除特定类别。值得注意的是，在复杂场景中，2D 扩散引导通常难以有效地编辑小物体。由于高斯语义跟踪的帮助，我们现在可以独立地渲染这些小物体并将它们输入到 2D 扩散模型中，从而实现更精确的监督。

## 4.2 层次高斯泼溅
Hierarchical Gaussian Splatting (HGS)

GS [17] 在重建任务中的有效性在于由 SFM [41]导出的点云提供的高质量初始化，以及来自地面真实数据集的稳定监督。