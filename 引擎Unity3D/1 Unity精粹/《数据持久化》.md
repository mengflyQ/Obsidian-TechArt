---
title: ã€Šæ•°æ®æŒä¹…åŒ–ã€‹
aliases: []
tags: []
create_time: 2023-06-08 00:15
uid: 202306080015
banner: "[[Pasted image 20230716220142.png]]"
---

![[Pasted image 20230611210946.png]]
**ä»€ä¹ˆæ˜¯æ•°æ®æŒä¹…åŒ–ï¼Ÿ**
æ•°æ®æŒä¹…åŒ–å°±æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®æ¨¡å‹è½¬æ¢ä¸ºå­˜å‚¨æ¨¡å‹, ä»¥åŠå°†å­˜å‚¨æ¨¡å‹è½¬æ¢ä¸ºå†…å­˜ä¸­çš„æ•°æ®æ¨¡å‹çš„ç»Ÿç§°
è¯´äººè¯: **å°†æ¸¸æˆæ•°æ®å­˜å‚¨åˆ°ç¡¬ç›˜ï¼Œç¡¬ç›˜ä¸­æ•°æ®è¯»å–åˆ°æ¸¸æˆä¸­ï¼Œä¹Ÿå°±æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å­˜ç›˜ã€‚**

**å¦‚ä½•ç†è§£ä¸åŒåç¼€çš„æ–‡ä»¶?**
æ–‡ä»¶åç¼€åå†³å®šäº†æ–‡ä»¶çš„æ ¼å¼
ä¸åŒçš„è½¯ä»¶å¯ä»¥æ ¹æ®åç¼€åç”¨æ¥åˆ¤æ–­æ–‡ä»¶çš„ç±»å‹å¹¶ä¸”åœ¨æ‰“å¼€æ–‡ä»¶æ—¶ä»¥ç‰¹å®šçš„è¯»å–è§„åˆ™å»è§£æå®ƒ
æ–‡ä»¶åç¼€åæ˜¯äººä¸ºå®šçš„è§„åˆ™å¯ä»¥æœ‰æ— æ•°ç§ï¼Œå¯ä»¥è‡ªå®šä¹‰

# Playerprefs
## åŸºæœ¬æ–¹æ³•
prefsï¼šæ§åˆ¶å°

- Playerprefs æ˜¯ unity æä¾›çš„å¯ä»¥ç”¨äº**å­˜å‚¨è¯»å–ç©å®¶æ•°æ®çš„å…¬å…±ç±»**
- PlayerPrefs çš„æ•°æ®å­˜å‚¨ç±»ä¼¼äº**é”®å€¼å¯¹**å­˜å‚¨ï¼Œä¸€ä¸ªé”®å¯¹åº”ä¸€ä¸ªå€¼
    - æä¾›äº†å­˜å‚¨ 3 ç§æ•°æ®çš„æ–¹æ³•ï¼šint float string
    - é”®ï¼šstring ç±»å‹
    - å€¼ï¼šint float string  å¯¹åº” 3 ç§ API
- å¦‚æœä¸åŒç±»å‹ç”¨åŒä¸€é”®åè¿›è¡Œå­˜å‚¨ï¼Œä¼šè¦†ç›–æ•°æ®


> [!NOTE] æ•°æ®çš„å”¯ä¸€æ€§
> PlayerPrefs ä¸­ä¸åŒæ•°æ®çš„å”¯ä¸€æ€§æ˜¯ç”± key å†³å®šçš„ï¼Œä¸åŒçš„ key å†³å®šäº†ä¸åŒçš„æ•°æ®ï¼ŒåŒä¸€é¡¹ç›®ä¸­å¦‚æœä¸åŒæ•°æ® key ç›¸åŒï¼Œä¼šé€ æˆæ•°æ®ä¸¢å¤±è¦ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œå°±è¦å»ºç«‹ä¸€ä¸ªä¿è¯ key å”¯ä¸€çš„è§„åˆ™ã€‚

```cs file:å­˜å‚¨æ•°æ®
//ç›´æ¥è°ƒç”¨setç›¸å…³æ–¹æ³•åªä¼šæŠŠæ•°æ®å­˜åˆ°å†…å­˜é‡Œ
//å½“æ¸¸æˆç»“æŸæ—¶ Unityä¼šè‡ªåŠ¨æŠŠæ•°æ®å­˜åˆ°ç¡¬ç›˜ä¸­
PlayerPrefs.SetInt("myAge",18);  
PlayerPrefs.SetFloat("myHeight",1.75f);
PlayerPrefs.SetString("myName","å¼ ä¸‰");

//å¦‚æœæ¸¸æˆä¸æ˜¯æ­£å¸¸ç»“æŸçš„ï¼Œè€Œæ˜¯å´©æºƒï¼Œæ•°æ®æ˜¯ä¸ä¼šå­˜åˆ°ç¡¬ç›˜ä¸­çš„
//å¯ä»¥è°ƒç”¨saveæ–¹æ³•æ‰‹åŠ¨æŠŠæ•°æ®å­˜åˆ°ç¡¬ç›˜ä¸­
PlayerPrefs.Save();
```

**æ³¨æ„è¿è¡Œæ—¶åªè¦ä½  set äº†å¯¹åº”é”®å€¼å¯¹ï¼Œå³ä½¿ä½ æ²¡æœ‰é©¬ä¸Šå­˜å‚¨ save åœ¨æœ¬åœ°ï¼Œä¹Ÿèƒ½å¤Ÿè¯»å–å‡ºä¿¡æ¯**
```cs file:è¯»å–æ•°æ®
int age = PlayerPrefs.GetInt("myAge",20); //å¯é€‰ç¬¬äºŒå‚æ•°ï¼Œå¦‚æœæ‰¾ä¸åˆ°myAgeçš„å€¼ï¼Œå°±ä¼šè¿”å›ç¬¬äºŒä¸ªå‚æ•°   
float height = PlayerPrefs.GetFloat("myHeight");
string name = PlayerPrefs.GetString("myName");
```

```cs file:åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨
if(PlayerPrefs.HasKey("myAge"))
{
    print("myAgeå­˜åœ¨");
}
```

```cs file:åˆ é™¤æ•°æ®
//åˆ é™¤å•ä¸ªæ•°æ®
PlayerPrefs.DeleteKey("MyAge");
//åˆ é™¤æ‰€æœ‰å­˜å‚¨çš„æ•°æ®
PlayerPrefs.DeleteAll();
```

## å­˜å‚¨å…¶ä»–ç±»å‹
PlayerPrefs æ˜¯æœ‰å±€é™æ€§çš„å®ƒåªèƒ½å­˜ 3 ç§ç±»å‹çš„æ•°æ®ï¼Œå¦‚æœä½ æƒ³è¦å­˜å‚¨åˆ«çš„ç±»å‹çš„æ•°æ®åªèƒ½é™ä½ç²¾åº¦æˆ–è€…ä¸Šå‡ç²¾åº¦æ¥è¿›è¡Œå­˜å‚¨ï¼Œå½“ç„¶ä¹Ÿå¯é‡‡ç”¨ä¸‹é¢çš„å° trickï¼š

```cs file:trickå­˜å‚¨boolç±»å‹
bool sex = true;
PlayerPrefs.SetInt( "sex", sex ? 1 : 0);
```

**å­˜å‚¨æ›´å¤æ‚çš„ List<> ç±»å‹**

```cs file:å­˜å‚¨æ›´å¤æ‚çš„List<>ç±»å‹


public class Player
{
    private string _name;
    public int _age;
    private int _atk;
    private int _def;

    //è£…å¤‡ä¿¡æ¯
    public List<Equipment> EquipmentsList;

    //è¯¥å˜é‡æ—¶ä¸€ä¸ªå­˜å‚¨å’Œè¯»å–çš„å”¯ä¸€keyæ ‡è¯†ã€‚è¯†åˆ«å¤šä¸ªç©å®¶ï¼Œåˆ†åˆ«å­˜å‚¨
    private string _keyName;

    public void Save()
    {
        PlayerPrefs.SetString(_keyName + "name", _name);
        PlayerPrefs.SetInt(_keyName + "age", _age);
        PlayerPrefs.SetInt(_keyName + "atk", _atk);
        PlayerPrefs.SetInt(_keyName + "def", _def);

        //è£…å¤‡ä¿¡æ¯
        PlayerPrefs.SetInt("EquipmentsCount", EquipmentsList.Count);
        for (int i = 0; i < EquipmentsList.Count; i++)
        {
            //å­˜å‚¨æ¯ä¸€ä¸ªè£…å¤‡çš„idå’Œæ•°é‡
            PlayerPrefs.SetInt("EquipmentsID" + i, EquipmentsList[i]._id);
            PlayerPrefs.SetInt("EquipmentsCount" + i, EquipmentsList[i]._count);
        }
    }

    public void Load(string keyName)
    {
        this._keyName = keyName; 
        
        _name = PlayerPrefs.GetString(keyName + "name", "test");
        _age = PlayerPrefs.GetInt(keyName + "age", 18);
        _atk = PlayerPrefs.GetInt(keyName + "atk", 100);
        _def = PlayerPrefs.GetInt(keyName + "def", 1000);

        //è£…å¤‡ä¿¡æ¯
        int num = PlayerPrefs.GetInt("EquipmentsCount", 0);
        EquipmentsList = new List<Equipment>();
        for (int i = 0; i < num; i++)
        {
            Equipment equipment = new Equipment();
            equipment._id = PlayerPrefs.GetInt("EquipmentsID" + i, 0);
            equipment._count = PlayerPrefs.GetInt("EquipmentsCount" + i, 0);
            EquipmentsList.Add(equipment);
        }
    }
}

public class Equipment
{
    public int _id;
    public int _count;
}

public class NewBehaviourScript1 : MonoBehaviour
{
    void Start()
    {
        Player player1 = new Player();
        player1.Load("Player1");

        print("è£…å¤‡åˆ—è¡¨æ•°é‡ï¼š" + player1.EquipmentsList.Count);

        for (int i = 0; i < player1.EquipmentsList.Count; i++)
        {
            print("é“å…·IDï¼š" + player1.EquipmentsList[i]._id);
            print("é“å…·æ•°é‡ï¼š" + player1.EquipmentsList[i]._count);
        }


        Equipment equipment1 = new Equipment();
        equipment1._id = 1;
        equipment1._count = 1;

        Equipment equipment2 = new Equipment();
        equipment2._id = 2;
        equipment2._count = 2;

        player1.EquipmentsList.Add(equipment1);
        player1.EquipmentsList.Add(equipment2);

        player1.Save();

        print("è£…å¤‡åˆ—è¡¨æ•°é‡ï¼š" + player1.EquipmentsList.Count);
        for (int i = 0; i < player1.EquipmentsList.Count; i++)
        {
            print("é“å…·IDï¼š" + player1.EquipmentsList[i]._id);
            print("é“å…·æ•°é‡ï¼š" + player1.EquipmentsList[i]._count);
        }
        
        Player player2 = new Player();
        player2.Load("Player2");
        //...
        player2.Save();
        
        //...
    }
}
```

## å­˜å‚¨ä½ç½®
ä¸åŒå¹³å°å­˜å‚¨ä½ç½®ä¸åŒ
**Win**
å­˜å‚¨åœ¨ `HKCU\Software\[å…¬å¸åç§°]\[äº§å“åç§°]` é¡¹ä¸‹çš„æ³¨å†Œè¡¨ä¸­
å…¶ä¸­å…¬å¸å’Œäº§å“åç§°æ˜¯åœ¨â€œProject settingsâ€ä¸­è®¾ç½®çš„åç§°ã€‚ 

1. è¿è¡Œ regedit
2.  `HKEY_CURRENT_USER/SOFTWARE/Unity/UnityEditor/`å…¬å¸åç§°/äº§å“åç§°
**å®‰å“**
`/data/ data/åŒ…å/shared_prefs/pkg-name .xml`
 
**IOS**
`/Librany/Preferences/[åº”ç”¨ ID]. plist`


å•ç‹¬ä½¿ç”¨å®ƒçš„åŸç”ŸåŠŸèƒ½ï¼Œéå¸¸é€‚åˆå­˜å‚¨ä¸€äº›å¯¹å®‰å…¨æ€§è¦æ±‚ä¸é«˜çš„ç®€å•æ•°æ®
ä½†æ˜¯ä¹Ÿä¸èƒ½å°çœ‹å®ƒï¼Œå¯¹å®ƒè¿›è¡Œç®€å•çš„å°è£…ï¼Œä¹Ÿå¯ä»¥è®©å®ƒå˜å¾—æ–¹ä¾¿åˆå®‰å…¨

## Playerprefs æ•°æ®ç®¡ç†ç±» 
```cs
/*
 * æ•°æ®ç®¡ç†ç±»æä¾›ç»™å¤–éƒ¨çš„æ–¹æ³•ï¼š
 * 1. å­˜å‚¨æ•°æ®
 * 2. è¯»å–æ•°æ®
 * 3. å¤–éƒ¨å¯ä»¥ä¼ å…¥æ•°æ®ç›´æ¥è¿›è¡Œå­˜å‚¨
 * 4. å¤–éƒ¨å¯ä»¥ä¼ å…¥æ•°æ®ç±»å‹ç›´æ¥è¿›è¡Œæ•°æ®è·å–
 */
using System;
using System.Collections;
using System.Collections.Generic;
using System.Reflection;
using Unity.VisualScripting;
using Unity.VisualScripting.FullSerializer;
using UnityEngine;
using UnityEngine.UI;

/// <summary>
/// PlayerPrefsæ•°æ®ç®¡ç†ç±»ï¼Œç»Ÿä¸€ç®¡ç†æ•°æ®çš„å­˜å‚¨å’Œè¯»å–
/// </summary>
public class PlayerPrefsDataManager
{
    //å•ä¾‹æ¨¡å¼
    private static PlayerPrefsDataManager instance = new PlayerPrefsDataManager();

    public static PlayerPrefsDataManager Instance
    {
        get { return instance; }
    }

    private PlayerPrefsDataManager()
    {

    }

    /// <summary>
    /// å­˜å‚¨æ•°æ®
    /// </summary>
    /// <param name="data">æ•°æ®å¯¹è±¡</param>
    /// <param name="keyName">æ•°æ®å¯¹è±¡çš„å”¯ä¸€æ€§keyï¼Œè‡ªå·±æ§åˆ¶</param>
    public void SaveData(object data, string keyName)
    {
        //å°±æ˜¯è¦é€šè¿‡Typeå¾—åˆ°ä¼ å…¥æ•°æ®å¯¹è±¡çš„æ‰€æœ‰çš„å­—æ®µ
        //ç„¶åç»“åˆaYerPrefsæ¥è¿›è¡Œå­˜å‚¨

        #region ç¬¬ä¸€æ­¥ï¼šè·å–ä¼ å…¥æ•°æ®å¯¹è±¡çš„æ‰€æœ‰å­—æ®µ

        Type dataType = data.GetType();
        //å¾—åˆ°æ‰€æœ‰å­—æ®µ
        FieldInfo[] fieldInfos = dataType.GetFields();

        #endregion

        #region ç¬¬äºŒæ­¥ï¼šè‡ªå·±å®šä¹‰ä¸€ä¸ªkeyçš„è§„åˆ™ï¼Œè¿›è¡Œæ•°æ®å­˜å‚¨

        //æˆ‘ä»¬å­˜å‚¨éƒ½æ˜¯é€šè¿‡PlayerPrefsæ¥è¿›è¡Œå­˜å‚¨çš„
        //ä¿è¯keyçš„å”¯ä¸€æ€§æˆ‘ä»¬å°±éœ€è¦è‡ªå·±å®šä¸€ä¸ªkeyçš„è§„åˆ™
        //keyçš„è§„åˆ™ï¼škeyName_æ•°æ®ç±»å‹_å­—æ®µç±»å‹_å­—æ®µå

        #endregion

        #region ç¬¬ä¸‰æ­¥ï¼šéå†è¿™äº›å­—æ®µï¼Œè¿›è¡Œæ•°æ®å­˜å‚¨

        string saveKeyName = "";
        FieldInfo info;
        for (int i = 0; i < fieldInfos.Length; i++)
        {
            //å¯¹æ¯ä¸€ä¸ªå­—æ®µï¼Œè¿›è¡Œæ•°æ®å­˜å‚¨
            //å¾—åˆ°å…·ä½“çš„å­—æ®µä¿¡æ¯
            info = fieldInfos[i];
            //é€šè¿‡FieldInfoå¯ä»¥ç›´æ¥è·å–åˆ°å­—æ®µçš„ç±»å‹å’Œå­—æ®µçš„åå­—
            saveKeyName = keyName + "_" + dataType.Name + "_" + info.FieldType + "_" + info.Name;

            //ç°åœ¨å¾—åˆ°äº†KeyæŒ‰ç…§æˆ‘ä»¬çš„è§„åˆ™
            //æ¥ä¸‹æ¥å°±è¦æ¥é€šè¿‡PlayerPrefsæ¥è¿›è¡Œå­˜å‚¨
            SaveValue(info.GetValue(data), saveKeyName);
        }
        
        PlayerPrefs.Save();
        #endregion

    }

    /// <summary>
    /// å­˜å‚¨å€¼
    /// </summary>
    /// <param name="value">æ•°æ®å¯¹è±¡</param>
    /// <param name="saveKeyName">æ•°æ®å¯¹è±¡çš„å”¯ä¸€æ€§key</param>
    private void SaveValue(object value, string saveKeyName)
    {
        //ç›´æ¥é€šè¿‡PlayerPrefsæ¥è¿›è¡Œå­˜å‚¨äº†
        //å°±æ˜¯æ ¹æ®æ•°æ®ç±»å‹çš„ä¸åŒæ¥å†³å®šä½¿ç”¨å“ªä¸€ä¸ªAPIæ¥è¿›è¡Œå­˜å‚¨
        //PlayerPrefsåªæ”¯æŒ3ç§ç±»å‹å­˜å‚¨
        //åˆ¤æ–­æ•°æ®ç±»å‹æ˜¯ä»€ä¹ˆç±»å‹ ç„¶åè°ƒç”¨å…·ä½“çš„æ–¹æ³•æ¥å­˜å‚¨
        Type fieldType = value.GetType();

        //int,float,stringç±»å‹å­˜å‚¨
        //ç±»å‹åˆ¤æ–­
        if (fieldType == typeof(int))
        {
            PlayerPrefs.SetInt(saveKeyName, (int)value);
        }
        else if (fieldType == typeof(float))
        {
            PlayerPrefs.SetFloat(saveKeyName, (float)value);
        }
        else if (fieldType == typeof(string))
        {
            PlayerPrefs.SetString(saveKeyName, value.ToString());
        }
        else if (fieldType == typeof(bool))
        {
            //è‡ªå·±é¡¶ä¸€ä¸ªå­˜å‚¨boolçš„è§„åˆ™
            PlayerPrefs.SetInt(saveKeyName, (bool)value ? 1 : 0);
        }

        //List<T>ç±»å‹å­˜å‚¨
        //å¦‚ä½•åˆ¤æ–­æ³›å‹ç±»çš„ç±»å‹ï¼Ÿæ¯”å¦‚List<T>
        //é€šè¿‡åå°„åˆ¤æ–­çˆ¶å­å…³ç³»
        //è¿™ç›¸å½“äºåˆ¤æ–­å­—æ®µæ˜¯ä¸æ˜¯IListçš„å­ç±»
        //ä¸ºä»€ä¹ˆæƒ³åˆ°IListï¼Œå¯ä»¥é€šè¿‡ListæŸ¥çœ‹ä»–çš„çˆ¶ç±»ï¼ŒIListæ˜¯Listçš„çˆ¶ç±»ï¼Œå› æ­¤å¯ä»¥ç”¨çˆ¶ç±»è£…å­ç±»
        else if (typeof(IList).IsAssignableFrom(fieldType))
        {
            //çˆ¶ç±»è£…å­ç±»
            IList list = value as IList;
            //å…ˆå­˜å‚¨æ•°é‡
            PlayerPrefs.SetInt(saveKeyName, list.Count);
            int index = 0;
            foreach (object obj in list)
            {
                //å­˜å‚¨å…·ä½“çš„å€¼
                SaveValue(obj, saveKeyName + index); //é€’å½’ï¼
                ++index;
            }
        }

        //Dictionary<T>ç±»å‹å­˜å‚¨
        //åŒç†ï¼ŒIDictionaryæ˜¯Dictionaryçš„çˆ¶ç±»
        else if (typeof(IList).IsAssignableFrom(fieldType))
        {
            //çˆ¶ç±»è£…å­ç±»
            IDictionary dictionary = value as IDictionary;
            //å…ˆå­˜å‚¨å­—å…¸é•¿åº¦
            PlayerPrefs.SetInt(saveKeyName, dictionary.Count);
            //éå†å­˜å‚¨å­—å…¸é‡Œé¢çš„å…·ä½“å€¼
            int index = 0;
            foreach (object key in dictionary.Keys)
            {
                SaveValue(key, saveKeyName + "_key_" + index); //é€’å½’ï¼
                SaveValue(dictionary[key], saveKeyName + "_value_" + index);
                ++index;
            }

        }

        //å­˜å‚¨è‡ªå®šä¹‰ç±»ç±»å‹
        else
        {
            SavaData(value, saveKeyName); //é€’å½’
        }
    }


    /// <summary>
    /// è¯»å–æ•°æ®
    /// </summary>
    /// <param name="type">æƒ³è¦è¯»å–æ•°æ®çš„æ•°æ®ç±»å‹</param>
    /// <param name="keyName">æ•°æ®å¯¹è±¡çš„å”¯ä¸€æ€§keyï¼Œè‡ªå·±æ§åˆ¶</param>
    public object LoadData(Type type, string keyName)
    {
        //ä¸ç”¨objectå¯¹è±¡ä¼ å…¥ è€Œä½¿ç”¨Typeä¼ å…¥çš„åŸå› æ˜¯:
        //objectå¯¹è±¡ä¼ å…¥çš„è¯ï¼Œå¿…é¡»åœ¨å¤–éƒ¨newä¸€ä¸ªå¯¹è±¡ä¼ å…¥
        //è€ŒTypeä¼ å…¥çš„è¯ï¼Œåªéœ€è¦ä¸€ä¸ªType typeof(Player)ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨Activator.CreateInstance(type)æ¥åˆ›å»ºå¯¹è±¡
        //è¿™æ ·å¯ä»¥å°‘å†™ä¸€è¡Œä»£ç 

        //æ ¹æ®ä½ ä¼ å…¥çš„ç±»å‹å’ŒkeyName
        //ä¾æ®ä½ å­˜å‚¨æ•°æ®æ—¶keyçš„æ‹¼æ¥è§„åˆ™æ¥è¿›è¡Œæ•°æ®çš„è·å–èµ‹å€¼è¿”å›å‡ºå»

        //æ ¹æ®ä¼ å…¥çš„Type åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç”¨äºå­˜å‚¨æ•°æ®
        object data = Activator.CreateInstance(type);

        //è¦å¾€è¿™ä¸ªnewå‡ºæ¥çš„å¯¹è±¡ä¸­å¡«å……æ•°æ®
        //å¾—åˆ°æ‰€æœ‰å­—æ®µ
        FieldInfo[] fieldInfos = type.GetFields();
        //ç”¨äºæ‹¼æ¥keyçš„å­—ç¬¦ä¸²
        string saveKeyName = "";
        FieldInfo info;
        for (int i = 0; i < fieldInfos.Length; i++)
        {
            info = fieldInfos[i];
            //keyçš„æ‹¼æ¥è§„åˆ™ï¼Œä¸€å®šå’Œå­˜å‚¨æ—¶ä¸€æ¨¡ä¸€æ ·
            saveKeyName = keyName + "_" + type.Name + "_" + info.FieldType + "_" + info.Name;
            //æœ‰keyå°±å¯ä»¥ç»“åˆPlayerprefsæ¥è¯»å–æ•°æ®
            //å¡«å……æ•°æ®åˆ°dataä¸­
            info.SetValue(data, LoadValue(info.FieldType, saveKeyName));
        
        }

        return data;
    }

    /// <summary>
    /// å¾—åˆ°å•ä¸ªæ•°æ®çš„æ–¹æ³•
    /// </summary>
    /// <param name="fieldType">å­—æ®µç±»å‹ï¼Œç”¨äºåˆ¤æ–­ç”¨å“ªä¸ªapiæ¥è¯»å–</param>
    /// <param name="saveKeyName">ç”¨äºè·å–å…·ä½“æ•°æ®</param>
    /// <returns></returns>
    private object LoadValue(Type fieldType, string saveKeyName)
    {
        if (fieldType == typeof(int))
        {
            return PlayerPrefs.GetInt(saveKeyName, 0);
        }
        else if (fieldType == typeof(float))
        {
            return PlayerPrefs.GetFloat(saveKeyName, 0);
        }
        else if (fieldType == typeof(string))
        {
            return PlayerPrefs.GetString(saveKeyName, "");
        }
        else if (fieldType == typeof(bool))
        {
            return PlayerPrefs.GetInt(saveKeyName, 0) == 1 ? true : false;
        }
        else if (typeof(IList).IsAssignableFrom(fieldType))
        {
            //å¾—åˆ°é•¿åº¦
            int count = PlayerPrefs.GetInt(saveKeyName, 0);
            //åˆ›å»ºä¸€ä¸ªlistç”¨äºå­˜å‚¨æ•°æ®
            IList list = Activator.CreateInstance(fieldType) as IList;
            for (int i = 0; i < count; i++) 
            {
                //é€’å½’
                list.Add(LoadValue(fieldType.GetGenericArguments()[0], saveKeyName + i));
            }
        
            return list;
        }
        else if (typeof(IDictionary).IsAssignableFrom(fieldType))
        {
            //å¾—åˆ°é•¿åº¦
            int count = PlayerPrefs.GetInt(saveKeyName, 0);
            //åˆ›å»ºä¸€ä¸ªdictionaryç”¨äºå­˜å‚¨æ•°æ®
            IDictionary dictionary = Activator.CreateInstance(fieldType) as IDictionary;
            for (int i = 0; i < count; i++)
            {
                //é€’å½’
                dictionary.Add(LoadValue(fieldType.GetGenericArguments()[0], saveKeyName + "_key_" + i),
                    LoadValue(fieldType.GetGenericArguments()[1], saveKeyName + "_value_" + i));
            }

            return dictionary;
        }
        else
        {
            //è‡ªå®šä¹‰ç±»ç±»å‹
            return LoadData(fieldType, saveKeyName);
        }
    }
}
```

### æ¡ˆä¾‹
```cs
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class PlayerInfo
{
    public int age;
    public string name;
    public float height;
    public bool sex;

    public List<int> list;

    public Dictionary<int, string> dic1;
    
    //ä»¥ä¸‹éƒ½å±äºè‡ªå®šä¹‰ç±»å‹å­˜å‚¨
    public ItemInfo itemInfo;

    public List<ItemInfo> itemList;

    public Dictionary<int, ItemInfo> dic2;

}

public class ItemInfo
{
    public int id;
    public int num;

    public ItemInfo()
    {
        
    }
    
    public ItemInfo(int id, int num)
    {
        this.id = id;
        this.num = num;
    }
}
public class Test : MonoBehaviour
{
    // Start is called before the first frame update
    void Start()
    {
        //è¯»å–æ•°æ®
        PlayerInfo p1 = PlayerPrefsDataManager.Instance.LoadData(typeof(PlayerInfo),"Player1") as PlayerInfo;
        
        //æ¸¸æˆé€»è¾‘ä¸­å›å»ä¿®æ”¹è¿™ä¸ªç©å®¶æ•°æ®
        p1.age = 18;
        p1.name = "å¼ ä¸‰";
        p1.height = 185;
        p1.itemList.Add(new ItemInfo(1, 123));
        p1.itemList.Add(new ItemInfo(2, 456));
        p1.dic1.Add(3, "é•¿å‰‘");
        p1.dic2.Add(4, new ItemInfo(3,789));
        
        //éœ€è¦æŠŠè¿™ä¸ªæ•°æ®å¯¹è±¡çš„ä¿¡æ¯ å­˜å‚¨åˆ°ç¡¬ç›˜
        PlayerPrefsDataManager.Instance.SaveData(p1, "player1");
    }
    
    // Update is called once per frame
    void Update()
    {
        
    }
}
```
# Json
å…¨ç§°ï¼šJavaScript å¯¹è±¡ç®€è°± (JavaScript Object Notation) 
Json æ˜¯å›½é™…é€šç”¨çš„ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼
ä¸»è¦åœ¨ç½‘ç»œé€šè®¯ä¸­ç”¨äºä¼ è¾“æ•°æ®ï¼Œæˆ–æœ¬åœ°æ•°æ®å­˜å‚¨å’Œè¯»å–
æ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆï¼Œå¹¶æœ‰æ•ˆåœ°æå‡ç½‘ç»œä¼ è¾“æ•ˆç‡
![[Pasted image 20230611211123.png]]
æˆ‘ä»¬ä¸€èˆ¬**ä½¿ç”¨ Json æ–‡ä»¶æ¥è®°å½•å’Œä¼ è¾“æ•°æ®**

Json æ–‡æ¡£å°±æ˜¯ä½¿ç”¨ Json æ ¼å¼é…ç½®å¡«å†™çš„æ–‡æ¡£åç¼€ä¸€èˆ¬ä¸º.json
æˆ‘ä»¬åœ¨æ¸¸æˆä¸­å¯ä»¥æŠŠæ¸¸æˆæ•°æ®æŒ‰ç…§ Json çš„æ ¼å¼æ ‡å‡†å­˜å‚¨åœ¨ Json æ–‡æ¡£ä¸­ï¼Œå†å°† Json æ–‡æ¡£å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šæˆ–è€…ä¼ è¾“ç»™è¿œç«¯ï¼Œè¾¾åˆ°æ•°æ®æŒä¹…åŒ–æˆ–è€…æ•°æ®ä¼ è¾“çš„ç›®çš„ã€‚

|**Json å’Œ Xml çš„å¼‚åŒï¼ˆJson æ›´å¥½ç”¨ï¼ï¼‰** |   |
|:--|:--|
|**å…±åŒç‚¹**|**ä¸åŒç‚¹**|
|éƒ½æ˜¯çº¯æ–‡æœ¬|Jsoné…ç½®æ›´ç®€å•|
|éƒ½æœ‰å±‚çº§ç»“æ„|Jsonåœ¨æŸäº›æƒ…å†µä¸‹è¯»å†™æ›´å¿«é€Ÿ|
|éƒ½å…·æœ‰æè¿°æ€§|  |

**ä¼˜ç‚¹**
1. å’Œ XML ä¸€è‡´çš„ä¼˜ç‚¹
    1.  Json æ˜¯å›½é™…é€šç”¨è§„åˆ™
    2. è·¨å¹³å°ï¼ˆæ¸¸æˆï¼Œè½¯ä»¶ï¼Œç½‘é¡µç­‰ç­‰éƒ½èƒ½ç”¨ï¼Œä¸åŒæ“ä½œç³»ç»Ÿä¹Ÿèƒ½ç”¨)
    3. æ–‡ä»¶ç»“æ„æ¸…æ™°æ˜“æ‡‚ï¼Œéå¸¸å®¹æ˜“ç¼–è¾‘å’Œç†è§£
    4. å¯ä»¥ç”¨äºç½‘ç»œé€šä¿¡äº¤æ¢æ•°æ®

**ç¼ºç‚¹**
1. é‡å¤å·¥ä½œé‡ç¹å¤š
    1. è‡ªå®šä¹‰æ•°æ®ç±»ï¼Œéƒ½éœ€è¦è‡ªå·±å»å®ç°å­˜å‚¨è¯»å–çš„åŠŸèƒ½
    2. è€Œä¸”ä»£ç çš„ç›¸ä¼¼åº¦æé«˜
2. æ•°æ®å®¹æ˜“è¢«ä¿®æ”¹ï¼Œåªè¦æ‰¾åˆ°æ–‡ä»¶ä½ç½®ï¼Œå°±å¯ä»¥è½»æ˜“çš„è¿›è¡Œæ•°æ®ä¿®æ”¹

**ä¸»è¦ç”¨å¤„ï¼š**
ç½‘ç»œæ¸¸æˆï¼šå¯ä»¥ç”¨äºå­˜å‚¨ä¸€äº›å®¢æˆ·ç«¯çš„ç®€å•ä¸é‡è¦æ•°æ®ï¼Œå¯ä»¥ç”¨äºä¼ è¾“ä¿¡æ¯
å•æœºæ¸¸æˆï¼šç”¨äºå­˜å‚¨æ¸¸æˆç›¸å…³æ•°æ®ï¼Œç”¨äºé…ç½®æ¸¸æˆæ•°æ®ï¼ˆç»“åˆ UI ç¬¬ä¸‰éƒ¨æ›²ä¸€èµ·è®²è§£)

## è¯­æ³•è§„åˆ™
æ³¨é‡Šæ ¼å¼å’Œ cs ä¸€æ ·ï¼Œ`//` æˆ–è€… `/* */`
![[Pasted image 20230611211909.png]]
{
"vertexIndex":123
"pressure":165
}
![[Pasted image 20230611212009.png]]
```json
{
    "name":"å¤§å«",
    "age":18,
    "sex":true,
    "ids":[1,2,3,4,5,6],
    "students":[
        {"name":"å°çº¢","age":16,"sex":true},
        {"name":"å°æ˜","age":15,"sex":false}
    ],
    "home":{"address":"æˆéƒ½","street":"æ˜¥ç†™è·¯"},
    "son":null,
    
    //å­—å…¸ç±»å‹ï¼Œé”®ä¼šå˜æˆåŒå¼•å·ä»¥åè½¬æ¢æ—¶è¦æ³¨æ„!!!
    "dic":{"1":"123","2": "234"}
}
```
Json æ ¼å¼æ˜¯ä¸€ç§é”®å€¼å¯¹ç»“æ„
![[Pasted image 20230611211722.png|450]]

> [!NOTE] æ³¨æ„äº‹é¡¹
> 
> 1. å¦‚æœæ•°æ®è¡¨ç¤ºå¯¹è±¡ï¼Œé‚£ä¹ˆæœ€å¤–å±‚æœ‰å¤§æ‹¬å·
> 2. ä¸€å®šæ˜¯é”®å€¼å¯¹å½¢å¼
> 3. **é”®ä¸€å®šæ˜¯å­—ç¬¦ä¸²æ ¼å¼** 
> 4. é”®å€¼å¯¹ç”¨é€—å·åˆ†å¼€ 
> 5. æ•°ç»„ç”¨ `[ ]` åŒ…è£¹ 
> 6. å¯¹è±¡ç”¨`{}`åŒ…è£¹

### Excel è½¬ Json
1. åœ¨ Excel è¡¨ä¸­é…ç½®æ¸¸æˆæ•°æ®â€”â€”æ›´æ–¹ä¾¿ç­–åˆ’äººå‘˜é…ç½®
2. å°† Excel è¡¨ä¸­é…ç½®çš„æ•°æ®è½¬ä¸º Json é…ç½®â€”â€”æ–¹ä¾¿å°†æ•°æ®è¯»å–åˆ°å†…å­˜ä¸­

![[Pasted image 20230611213325.png]]
ä¸Šå›¾ XML ä¸­çš„æ•°æ®å¯¹åº”çš„ Excel è¡¨å¦‚ä¸‹ï¼š

| hp | speed  | volume | resName           | scale |
|----|--------|--------|-------------------|-------|
| 4  | 6      | 5      | Airplane/Airplan1 | 15    |
| 3  | 7      | 4      | Airplane/Airplan2 | 15    |
| 2  | 8      | 3      | Airplane/Airplan3 | 15    |
| 10 | 3      | 10     | Airplane/Airplan4 | 6     |
| 6  | 5      | 7      | Airplane/Airplan5 | 10    |

è½¬æ¢æ–¹æ³•ï¼š
1. åœ¨ç™¾åº¦æˆ–è€… Google æœç´¢ Excel è½¬ Json.
2.  åœ¨çº¿è½¬æ¢ç½‘ç«™ https://www.bejson.com/json/col2json/
3. è¿›è¡Œè½¬æ¢
4. ä¿å­˜ Json æ ¼å¼çš„æ•°æ®

**è½¬æ¢ç»“æœå¦‚ä¸‹ï¼š**
![[Pasted image 20230611214123.png|450]]

```Json file:Roleinfo.json
[
{"hp":4,"speed ":6,"volume":5,"resName":"Airplane/Airplan1","scale":15},
{"hp":3,"speed ":7,"volume":4,"resName":"Airplane/Airplan2","scale":15},
{"hp":2,"speed ":8,"volume":3,"resName":"Airplane/Airplan3","scale":15},
{"hp":10,"speed ":3,"volume":10,"resName":"Airplane/Airplan4","scale":6},
{"hp":6,"speed ":5,"volume":7,"resName":"Airplane/Airplan5","scale":10}
]
```

## JsonUtlity
`JsonUtlity` æ˜¯ unity è‡ªå¸¦çš„ç”¨äºè§£æ Json çš„å…¬å…±ç±»

> [!NOTE] åºåˆ—åŒ–ä¸ååºåˆ—åŒ–
>1. åºåˆ—åŒ–æ˜¯å°†å¯¹è±¡è½¬æ¢ä¸ºäºŒè¿›åˆ¶æµçš„è¿‡ç¨‹ã€‚æŠŠå†…å­˜ä¸­çš„æ•°æ®ï¼ˆç±»çš„å¯¹è±¡æ•°æ®ï¼‰å­˜å‚¨åˆ°ç¡¬ç›˜ä¸Šã€‚
>2. ååºåˆ—åŒ–æ˜¯å°†äºŒè¿›åˆ¶æµè½¬æ¢ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ã€‚æŠŠç¡¬ç›˜ä¸Šçš„æ•°æ®è¯»å–åˆ°å†…å­˜ï¼ˆç±»çš„å¯¹è±¡æ•°æ®ï¼‰ä¸­
>3. åºåˆ—åŒ–ä¸»è¦è§£å†³å¯¹è±¡çš„ä¼ è¾“é—®é¢˜ã€‚

**åŠŸèƒ½ï¼š**
1. å°†å†…å­˜ä¸­å¯¹è±¡åºåˆ—åŒ–ä¸º Json æ ¼å¼çš„å­—ç¬¦ä¸² 
2. å°† Json å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºç±»å¯¹è±¡

### åœ¨æ–‡ä»¶ä¸­è¯»å†™å­—ç¬¦ä¸²
å¯¼å…¥å‘½åç©ºé—´ `using System.IO;`

æ–‡ä»¶å¤¹è·¯å¾„ç›¸å…³ï¼š [[ã€ŠUnity Primerã€‹#1 æ–‡ä»¶å¤¹è·¯å¾„è·å–]]

```cs
//1.å­˜å‚¨å­—ç¬¦ä¸²åˆ°æŒ‡å®šè·¯å¾„æ–‡ä»¶ä¸­
//å‚æ•°ä¸€ï¼šæ˜¯å­˜å‚¨çš„è·¯å¾„ï¼ˆè‹¥è·¯å¾„ä¸­æœ‰æ–‡ä»¶å¤¹åï¼Œå¿…é¡»ä¿è¯æ–‡ä»¶å¤¹å­˜åœ¨ï¼‰
//å‚æ•°äºŒï¼šå­˜å‚¨çš„å­—ç¬¦ä¸²å†…å®¹
File.WriteAllText(Application.persistentDataPath + "/test.json", "Hello World"); 
print(Application.persistentDataPath); //æ‰“å°è·¯å¾„æ–¹ä¾¿å®šä½æ–‡ä»¶

//2.åœ¨æŒ‡å®šè·¯å¾„æ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸²
string str = File.ReadAllText(Application.persistentDataPath + "/test.json");
print(str); 
        
```


### åºåˆ—åŒ–
**åºåˆ—åŒ–ï¼šæŠŠå†…å­˜ä¸­çš„æ•°æ®ï¼ˆç±»çš„å¯¹è±¡æ•°æ®ï¼‰å­˜å‚¨åˆ°ç¡¬ç›˜ï¼ˆä»¥ Json æ–‡ä»¶ç­‰æ–¹å¼ä¿å­˜ï¼‰ä¸Š**  
**æ–¹æ³•**ï¼š`JsonUtility.ToJson(å¯¹è±¡)` æŠŠå¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²

**æ³¨æ„:**
1. float åºåˆ—åŒ–æ—¶çœ‹èµ·æ¥ä¼šæœ‰ä¸€äº›è¯¯å·®
2. è‡ªå®šä¹‰ç±»éœ€è¦åŠ ä¸Šåºåˆ—åŒ–ç‰¹æ€§`[System.Serializable]`
3. æƒ³è¦åºåˆ—åŒ–ç§æœ‰å˜é‡éœ€è¦åŠ ä¸Šç‰¹æ€§ `[SerializeField]`
4. `JsonUtility` ä¸æ”¯æŒå­—å…¸
5. `JsonUtlity` å­˜å‚¨ null å¯¹è±¡ä¸ä¼šæ˜¯ null ï¼Œè€Œæ˜¯é»˜è®¤å€¼çš„æ•°æ®

```cs file:åºåˆ—åŒ–
[System.Serializable]
public class Student
{
    public int age;
    public string name;

    public Student(int age, string name)
    {
        this.age = age;
        this.name = name;
    }
}

[System.Serializable]
public class MyData
{
    public string name;
    public int age;
    public float height;
    public double weight;
    public bool sex;

    public int[] ids1;
    public List<int> ids2;
    public Dictionary<int, string> dic1;
    public Dictionary<string,string> dic2;
    
    public Student stu;
    public List<Student> stus;
    
    [SerializeField]
    private int id;
    [SerializeField]
    protected string address;
}

public class Test : MonoBehaviour
{
    void Start()
    {
        //1. åˆ›å»ºç±»çš„å¯¹è±¡
        MyData data = new MyData();
        
        data.name = "å¼ ä¸‰";
        data.age = 18;
        data.height = 1.75f;
        data.weight = 175.0;
        data.sex = true;
        
        data.ids1 = new int[]{1,2,3,4,5};
        data.ids2 = new List<int>(){1,2,3,4,5};
        data.dic1 = new Dictionary<int, string>()
        {
            {1,"å¼ ä¸‰"},
            {2,"æå››"},
            {3,"ç‹äº”"},
        };
        data.dic2 = new Dictionary<string, string>()
        {
            { "1", "123" },
            { "2", "456" },
            { "3", "789" },
        };

        data.stu = null;
        
        data.stus = new List<Student>()
        {
            new Student(18, "å¼ ä¸‰"),
            new Student(12, "å¼ s"),
            new Student(18, "å¼ sd"),
        };

        //2. åºåˆ—åŒ–ï¼Œå­˜å‚¨å­—ç¬¦ä¸²
        string jsonStr = JsonUtility.ToJson(data);
        File.WriteAllText(Application.persistentDataPath+ "/data.json", jsonStr);
        print(Application.persistentDataPath);
    }
}
```

å¾—åˆ°çš„ Json æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š
```json file:data.json
{"name":"å¼ ä¸‰","age":18,"height":1.75,"weight":175.0,"sex":true,"ids1":[1,2,3,4,5],"ids2":[1,2,3,4,5],"stu":{"age":0,"name":""},"stus":[{"age":18,"name":"å¼ ä¸‰"},{"age":12,"name":"å¼ s"},{"age":18,"name":"å¼ sd"}],"id":0,"address":""}
```

### ååºåˆ—åŒ–
**ååºåˆ—åŒ–ï¼šæŠŠç¡¬ç›˜ä¸Šçš„æ•°æ®ï¼ˆJson æ–‡ä»¶æ•°æ®ï¼‰è¯»å–åˆ°å†…å­˜ï¼ˆç±»çš„å¯¹è±¡æ•°æ®ï¼‰ä¸­**

æ–¹æ³•ï¼š`JsonUtility.FromJson(å­—ç¬¦ä¸²)`

ä»¥ data. json ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯¹å®ƒååºåˆ—åŒ–ï¼š
```json file:data.json
{"name":"å¼ ä¸‰","age":18,"height":1.75,"weight":175.0,"sex":true,"ids1":[1,2,3,4,5],"ids2":[1,2,3,4,5],"stu":{"age":0,"name":""},"stus":[{"age":18,"name":"å¼ ä¸‰"},{"age":12,"name":"å¼ s"},{"age":18,"name":"å¼ sd"}],"id":0,"address":""}
```

```cs file:ååºåˆ—åŒ–
//ååºåˆ—åŒ–è¦æ±‚æˆ‘ä»¬è¦å†™å‡ºç¬¦åˆJsonæ–‡ä»¶å†…å®¹çš„æ•°æ®ç»“æ„
[System.Serializable]
public class Student
{
    public int age;
    public string name;

    public Student(int age, string name)
    {
        this.age = age;
        this.name = name;
    }
}
[System.Serializable]
public class MyData
{
    public string name;
    public int age;
    public float height;
    public double weight;
    public bool sex;

    public int[] ids1;
    public List<int> ids2;
    public Dictionary<int, string> dic1;
    public Dictionary<string,string> dic2;
    
    public Student stu;
    public List<Student> stus;
    
    [SerializeField]
    private int id;
    [SerializeField]
    protected string address;
}


public class Test : MonoBehaviour
{
    void Start()
    {
        //1. è¯»å–æ–‡ä»¶ä¸­çš„Jsonå­—ç¬¦ä¸²
        string jsonStr = File.ReadAllText(Application.persistentDataPath+ "/data.json");
        
        //2. ååºåˆ—åŒ–,å°†Jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºç±»å¯¹è±¡
        //MyData data = JsonUtility.FromJson(jsonString,typeof(MyData)) as MyData;
        //æ›´æ¨èä½¿ç”¨æ³›å‹æ–¹æ³•ï¼ï¼ï¼
        MyData data = JsonUtility.FromJson<MyData>(jsonStr);
        
        //3. è·å–dataå¯¹è±¡çš„ä¿¡æ¯
        print(data.age); 
        print(data.name);
        print(data.height);
        //...çœç•¥
    }
}
```

### æ³¨æ„äº‹é¡¹
1. **`JsonUtlity` æ— æ³•ç›´æ¥è¯»å–æ•°æ®é›†åˆï¼ˆç”¨ `[]` åŒ…å«çš„æ•°ç»„ï¼‰**
2. Jsonæ–‡æœ¬ç¼–ç æ ¼å¼è¦æ—¶ UTF-8 ä¸ç„¶æ— æ³•åŠ è½½

å‰æ–‡æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª json æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œå¦‚æœç›´æ¥å¯¹å…¶ååºåˆ—åŒ–ä¼šæŠ¥é”™ï¼Œå› ä¸º Unity ååºåˆ—åŒ–ä¸æ”¯æŒè¯»å–æ•°ç»„
```Json file:Roleinfo.json
[
{"hp":4,"speed ":6,"volume":5,"resName":"Airplane/Airplan1","scale":15},
{"hp":3,"speed ":7,"volume":4,"resName":"Airplane/Airplan2","scale":15},
{"hp":2,"speed ":8,"volume":3,"resName":"Airplane/Airplan3","scale":15},
{"hp":10,"speed ":3,"volume":10,"resName":"Airplane/Airplan4","scale":6},
{"hp":6,"speed ":5,"volume":7,"resName":"Airplane/Airplan5","scale":10}
]
```

```cs
[System.Serializable]
public class Roleinfo
{
    public int hp;
    public int speed;
    public int volume;
    public string resName;
    public int scale;
} 

jsonStr = File.ReadAllText(Application.streamingAssetsPath + "/Roleinfo.json");
print(jsonstr);

//ä¼å›¾ç”¨ä¸€ä¸ªListæ•°ç»„å‚¨å­˜,æŠ¥é”™ï¼
List<Roleinfo> roleinfoList = JsonUtility.FronJson<List<Roleinfo>>(jsonStr);
```

**æ­£ç¡®çš„è¯»å–æ–¹æ³•ï¼š**
1. ä¿®æ”¹ Json æ–‡ä»¶ï¼š
```cs
{
    "List":[
    {"hp":4,"speed ":6,"volume":5,"resName":"Airplane/Airplan1","scale":15},
    {"hp":3,"speed ":7,"volume":4,"resName":"Airplane/Airplan2","scale":15},
    {"hp":2,"speed ":8,"volume":3,"resName":"Airplane/Airplan3","scale":15},
    {"hp":10,"speed ":3,"volume":10,"resName":"Airplane/Airplan4","scale":6},
    {"hp":6,"speed ":5,"volume":7,"resName":"Airplane/Airplan5","scale":10}
    ]
}
```

2. æ·»åŠ ç±», ç„¶åè¯»å–
```cs
[System.Serializable]
public class Roleinfo
{
    public int hp;
    public int speed;
    public int volume;
    public string resName;
    public int scale;
} 

[System.Serializable]
public class RoleData
{
    public List<RoleInfo> list;
}


jsonStr = File.ReadAllText(Application.streamingAssetsPath + "/Roleinfo.json");
print(jsonstr);

RoleData data = JsonUtility.FronJson<RoleData>(jsonStr); //ååºåˆ—åŒ–æˆåŠŸ
```

## LitJson
- LitJson æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œç”¨äºå¤„ç† Json çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ– 
- LitJson æ˜¯ cs ç¼–å†™çš„ï¼Œä½“ç§¯å°ã€é€Ÿåº¦å¿«ã€æ˜“äºä½¿ç”¨
- å®ƒå¯ä»¥å¾ˆå®¹æ˜“çš„åµŒå…¥åˆ°æˆ‘ä»¬çš„ä»£ç ä¸­
- åªéœ€è¦å°† LitJson ä»£ç æ‹·è´åˆ°å·¥ç¨‹ä¸­å³å¯


### è·å– LitJson
1. å‰å¾€ LitJson å®˜ç½‘[LitJSON - Home](https://litjson.net/)
2. é€šè¿‡å®˜ç½‘å‰å¾€ GitHub è·å–æœ€æ–°ç‰ˆæœ¬ä»£ç 
3. å°† src æ–‡ä»¶å¤¹ä¸‹çš„ LitJson æ–‡ä»¶å¤¹æ‹·è´åˆ° unity å·¥ç¨‹ä¸­ï¼Œå³å¯å¼€å§‹ä½¿ç”¨ LitJson
4. ä½¿ç”¨æ—¶å¼•ç”¨ LitJson å‘½åç©ºé—´ `using LitJson;`
### åºåˆ—åŒ–
æ–¹æ³•ï¼š`JsonMapper.ToJson(å¯¹è±¡)`

æ³¨æ„:
1. ç›¸å¯¹ JsonUtlity **ä¸éœ€è¦åŠ ç‰¹æ€§**
2.  **ä¸èƒ½åºåˆ—åŒ–ç§æœ‰å˜é‡**
3. **æ”¯æŒå­—å…¸ç±»å‹**ï¼Œå»ºè®®**å­—å…¸çš„é”®å€¼éƒ½æ˜¯å­—ç¬¦ä¸²**ï¼Œå› ä¸º Json çš„ç‰¹ç‚¹ï¼Œé”®ä¼šåŠ ä¸ŠåŒå¼•å·
4. å¯ä»¥ä¿å­˜ null ç±»å‹

```cs file:åºåˆ—åŒ–
public class Student
{
    public int age;
    public string name;

    public Student(int age, string name)
    {
        this.age = age;
        this.name = name;
    }
}

public class MyData
{
    public string name;
    public int age;
    public float height;
    public double weight;
    public bool sex;

    public int[] ids1;
    public List<int> ids2;
    public Dictionary<string,string> dic;
    
    public Student stu;
    public List<Student> stus;
    
    private int id;
    protected string address;
}


public class Test : MonoBehaviour
{
    void Start()
    {
        //1. åˆ›å»ºç±»çš„å¯¹è±¡
        MyData data = new MyData();
        
        data.name = "å¼ ä¸‰";
        data.age = 18;
        data.height = 1.75f;
        data.weight = 175.0;
        data.sex = true;
        
        data.ids1 = new int[]{1,2,3,4,5};
        data.ids2 = new List<int>(){1,2,3,4,5};
        data.dic = new Dictionary<string, string>()
        {
            { "1", "123" },
            { "2", "456" },
            { "3", "789" },
        };

        data.stu = null;
        
        data.stus = new List<Student>()
        {
            new Student(18, "å¼ ä¸‰"),
            new Student(12, "å¼ s"),
            new Student(18, "å¼ sd"),
        };
        
        //2. åºåˆ—åŒ–ï¼Œå­˜å‚¨å­—ç¬¦ä¸²
        string jsonStr = JsonMapper.ToJson(data);
        File.WriteAllText(Application.persistentDataPath+ "/data.json", jsonStr);
        print(Application.persistentDataPath);
    }
}

```

å¾—åˆ°çš„ Json æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

```json file:data.json
{"name":"\u5F20\u4E09","age":18,"height":1.75,"weight":175.0,"sex":true,"ids1":[1,2,3,4,5],"ids2":[1,2,3,4,5],"dic":{"1":"123","2":"456","3":"789"},"stu":null,"stus":[{"age":18,"name":"\u5F20\u4E09"},{"age":12,"name":"\u5F20s"},{"age":18,"name":"\u5F20sd"}]}
```

### ååºåˆ—åŒ–
**æ–¹æ³•ï¼š** `JsonMapper.ToObject(å­—ç¬¦ä¸²)`

**æ³¨æ„ï¼š**
1. **ç±»ç»“æ„éœ€è¦æ— å‚æ„é€ å‡½æ•°**ï¼Œå¦åˆ™ååºåˆ—åŒ–æ—¶æŠ¥é”™
2. å­—å…¸è™½ç„¶æ”¯æŒï¼Œä½†æ˜¯**é”®**åœ¨ä½¿ç”¨ä¸ºæ•°å€¼æ—¶ä¼šæœ‰é—®é¢˜ï¼Œ**éœ€è¦ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹**


```cs
public class Student
{
    public int age;
    public string name;

    //å› ä¸ºè¿™é‡Œè‡ªå·±å†™äº†æ„é€ å‡½æ•°è¦†ç›–æ‰äº†æ— å‚æ„é€ å‡½æ•°
    //æ‰€ä»¥è¦æ‰‹åŠ¨æ·»åŠ æ— å‚æ„é€ å‡½æ•°
    public Student()
    { }
    
    public Student(int age, string name)
    {
        this.age = age;
        this.name = name;
    }
}

public class MyData
{
    public string name;
    public int age;
    public float height;
    public double weight;
    public bool sex;

    public int[] ids1;
    public List<int> ids2;
    public Dictionary<string,string> dic;
    
    public Student stu;
    public List<Student> stus;
    
    private int id;
    protected string address;
}

public class Test : MonoBehaviour
{
    void Start()
    {
        //1. è¯»å–æ–‡ä»¶ä¸­çš„Jsonå­—ç¬¦ä¸²
        string jsonStr = File.ReadAllText(Application.persistentDataPath+ "/data.json");
        
        //2. ååºåˆ—åŒ–ï¼Œå°†Jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºç±»å¯¹è±¡
        MyData data = JsonMapper.ToObject<MyData>(jsonStr);
        
        //3. è·å–dataå¯¹è±¡çš„ä¿¡æ¯
        print(data.age);
        print(data.name);
        print(data.height);
        //çœç•¥...
    }
}
```

### æ³¨æ„äº‹é¡¹
1. LitJson **å¯ä»¥ç›´æ¥è¯»å–æ•°æ®é›†åˆ**ï¼ˆç”¨ `[]` åŒ…å«çš„æ•°ç»„ï¼‰
2. æ–‡æœ¬ç¼–ç æ ¼å¼éœ€è¦æ˜¯ UTF-8ï¼Œ ä¸ç„¶æ— æ³•åŠ è½½

å‰æ–‡æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª json æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–
```Json file:Roleinfo.json
[
{"hp":4,"speed ":6,"volume":5,"resName":"Airplane/Airplan1","scale":15},
{"hp":3,"speed ":7,"volume":4,"resName":"Airplane/Airplan2","scale":15},
{"hp":2,"speed ":8,"volume":3,"resName":"Airplane/Airplan3","scale":15},
{"hp":10,"speed ":3,"volume":10,"resName":"Airplane/Airplan4","scale":6},
{"hp":6,"speed ":5,"volume":7,"resName":"Airplane/Airplan5","scale":10}
]
```

```cs
public class RoleInfo
{
    public int hp;
    public int speed;
    public int volume;
    public string resName;
    public int scale;
} 

jsonStr = File.ReadAllText(Application.streamingAssetsPath + "/RoleInfo.json");
print(jsonstr);

//ååºåˆ—åŒ–
//æ–¹å¼ä¸€ï¼š
RoInfo[] arr = JsonMapper.ToObject<RoleInfo[]>(jsonStr);
//æ–¹å¼äºŒï¼š
List<RoInfo> list = JsonMapper.ToObject<List<RoInfo>>(jsonStr); 
```

## Json æ•°æ®ç®¡ç†ç±»

```cs file:JsonDataManager.cs
/*  
* Jsonæ•°æ®ç®¡ç†ç±» ä¸»è¦ç”¨äºè¿›è¡Œ Jsonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–  
* éœ€è¦å¼•ç”¨ LitJson åº“
* åˆ›å»ºStreamingAssetsæ–‡ä»¶å¤¹ 
* 
* åºåˆ—åŒ–ï¼šJsonDataManager.Instance.SaveData(data, "fileName");  
* ååºåˆ—åŒ–ï¼šMyData data = JsonDataManager.Instance.LoadData<MyData>("fileName", JsonType.LitJson); 
*/
using System.Collections;
using System.Collections.Generic;
using System.IO;
using LitJson;
using UnityEngine;

/// <summary>
/// Jsonåºåˆ—åŒ–æ–¹æ¡ˆ
/// </summary>
public enum JsonType
{
    JsonUtlity,
    LitJson,
}

/// <summary>
/// Jsonæ•°æ®ç®¡ç†ç±» ä¸»è¦ç”¨äºè¿›è¡Œ Jsonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–
/// </summary>
public class JsonDataManager
{
    //å•ä¾‹æ¨¡å¼
    private static JsonDataManager instance = new JsonDataManager();
    
    public static JsonDataManager Instance => instance;

    private JsonDataManager()
    {
    }
    
    //åºåˆ—åŒ–ï¼Œå­˜å‚¨Jsonæ•°æ®åˆ°ç¡¬ç›˜
    public void SaveData(object data, string fileName, JsonType type = JsonType.LitJson)
    {
        //1. ç¡®å®šå­˜å‚¨è·¯å¾„
        string path = Application.persistentDataPath + "/" + fileName + ".json";
        
        //2. åºåˆ—åŒ– å¾—åˆ°Jsonå­—ç¬¦ä¸²
        string jsonStr = "";
        switch (type)
        {
            case JsonType.JsonUtlity:
                jsonStr = JsonUtility.ToJson(data);
                break;
            case JsonType.LitJson:
                jsonStr = JsonMapper.ToJson(data);
                break;
            default:    
                break;
        }
        //3. æŠŠJsonå­—ç¬¦ä¸²å­˜å‚¨åˆ°ç¡¬ç›˜æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ä¸­
        File.WriteAllText(path, jsonStr);
    }

    public T LoadData<T>(string fileName, JsonType type = JsonType.LitJson) where T : new() //é™åˆ¶æ³›å‹å­˜åœ¨æ— å‚å…¬å…±æ„é€ å‡½æ•°
    {
        //1. ç¡®å®šä»å“ªä¸ªè·¯å¾„è¯»å–
        //é¦–å…ˆå…ˆåˆ¤æ–­ï¼ŒæµåŠ¨èµ„æºæ–‡ä»¶å¤¹ä¸­æ˜¯å¦æœ‰æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼Œå¦‚æœæœ‰å°±ä»ä¸­è·å–
        string path = Application.streamingAssetsPath + "/" + fileName + ".json";
        //å¦‚æœæ²¡æœ‰ï¼Œå°±ä»æŒä¹…æ•°æ®æ–‡ä»¶å¤¹ä¸­è·å–
        if (!File.Exists(path))
        {
            path = Application.persistentDataPath + "/" + fileName + ".json";
        }
        //å¦‚æœæŒä¹…æ•°æ®æ–‡ä»¶å¤¹ä¸­ä¹Ÿæ²¡æœ‰,é‚£å°±è¿”å›é»˜è®¤å¯¹è±¡
        if (!File.Exists(path))
        {
            return new T();
        }
        
        //2. è¯»å–æ–‡ä»¶ä¸­çš„Jsonå­—ç¬¦ä¸²
        string jsonStr = File.ReadAllText(path);
        
        //3. ååºåˆ—åŒ–ï¼Œå°†Jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºç±»å¯¹è±¡
        T data =  default(T);
        switch (type)
        {
            case JsonType.JsonUtlity:
                data = JsonUtility.FromJson<T>(jsonStr);
                break;
            case JsonType.LitJson:
                data = JsonMapper.ToObject<T>(jsonStr);
                break;
        }
        
        //4. è¿”å›å¯¹è±¡ï¼Œé€šè¿‡è¯¥å¯¹è±¡å³å¯è·å–å¯¹è±¡ä¿¡æ¯
        return data;
    }
}
```
### åºåˆ—åŒ–
```cs file:åºåˆ—åŒ–
public class Student
{
    public int age;
    public string name;

    public Student()
    { }
    public Student(int age, string name)
    {
        this.age = age;
        this.name = name;
    }
}

public class MyData
{
    public string name;
    public int age;
    public float height;
    public double weight;
    public bool sex;

    public int[] ids1;
    public List<int> ids2;
    public Dictionary<string, string> dic;

    public Student stu;
    public List<Student> stus;

    private int id;
    protected string address;
}


public class NewBehaviourScript : MonoBehaviour
{
    void Start()
    {
         //1. åˆ›å»ºç±»çš„å¯¹è±¡
         MyData data = new MyData();
        
         data.name = "å¼ ä¸‰";
         data.age = 18;
         data.height = 1.75f;
         data.weight = 175.0;
         data.sex = true;
        
         data.ids1 = new int[] { 1, 2, 3, 4, 5 };
         data.ids2 = new List<int>() { 1, 2, 3, 4, 5 };
         data.dic = new Dictionary<string, string>()
         {
             { "1", "123" },
             { "2", "456" },
             { "3", "789" },
         };
        
         data.stu = null;
        
         data.stus = new List<Student>()
         {
             new Student(18, "å¼ ä¸‰"),
             new Student(12, "å¼ s"),
             new Student(18, "å¼ sd"),
         };
        
         //2. åºåˆ—åŒ–ï¼Œå­˜å‚¨å­—ç¬¦ä¸²
         JsonDataManager.Instance.SaveData(data, "myfile");
    }
}
```

### ååºåˆ—åŒ–
```cs
public class Student
{
    public int age;
    public string name;

    public Student()
    { }
    public Student(int age, string name)
    {
        this.age = age;
        this.name = name;
    }
}

public class MyData
{
    public string name;
    public int age;
    public float height;
    public double weight;
    public bool sex;

    public int[] ids1;
    public List<int> ids2;
    public Dictionary<string, string> dic;

    public Student stu;
    public List<Student> stus;

    private int id;
    protected string address;
}


public class NewBehaviourScript : MonoBehaviour
{
    void Start()
    {
         //1. ååºåˆ—åŒ–ï¼Œå°†Jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºç±»å¯¹è±¡
         MyData data = JsonDataManager.Instance.LoadData< MyData>("myfile", JsonType.LitJson);
        
        //2. è·å–dataå¯¹è±¡çš„ä¿¡æ¯
        print(data.name);
        print(data.age);
        print(data.height);
        //çœç•¥...
    }
}
```

### æ‰©å±•

![[Pasted image 20230612002808.png]]
Excel è½¬æ¢è¿‡ç¨‹ç‰¹åˆ«éº»çƒ¦ï¼Œæœ€å¥½å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œè‡ªåŠ¨å°† Excel è½¬æ¢æˆ Jsonï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„æ•°æ®ç»“æ„ã€‚ï¼ˆä¹‹åçš„ç¼–è¾‘å™¨è¯¾ç¨‹è®²ï¼‰
![[Pasted image 20230612002828.png]]

# CSV
### ç¨‹åºåœ¨è¡¨æ ¼æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚

*   é¦–é€‰åˆ›å»º excelï¼Œå¹¶ä¿å­˜ä¸º csv æ ¼å¼ã€‚ç”¨æ–‡æœ¬æ‰“å¼€ï¼Œå¯ä»¥çœ‹åˆ°ä¸€è¡Œè¡Œçš„å­—ç¬¦ä¸²ï¼Œä»¥é€—å·åˆ†éš”ã€‚

![](1686645065163.png)

![](1686645065208.png)

*   ä¸º csv æ–‡ä»¶ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œç”¨äºå¯¹æ­¤æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œæ‰“å¼€è¯»å– csv æ–‡ä»¶ï¼Œå°† csv ä¸­æ•°æ®å­˜å‚¨åˆ°ä¸€ä¸ª list ä¸­ï¼Œå¯¹ list çš„æ•°æ®è¯»å–çš„æ“ä½œï¼Œè„šæœ¬ä¸º csvController ï¼š

```cs
using UnityEngine;
using System.Collections;
using System.IO;
using System.Collections.Generic;

public class csvController  {

    static csvController csv;
    public List<string[]> arrayData;  

    private csvController()   //å•ä¾‹ï¼Œæ„é€ æ–¹æ³•ä¸ºç§æœ‰
    {
        arrayData = new List<string[]>();
    }

    public static csvController GetInstance()   //å•ä¾‹æ–¹æ³•è·å–å¯¹è±¡
    {
        if(csv == null)
        {
            csv = new csvController();
        }
        return csv;
    }

    public void loadFile(string path,string fileName)
    {
        arrayData.Clear();
        StreamReader sr = null;
        try
        {
            string file_url = path + "//" + fileName;    //æ ¹æ®è·¯å¾„æ‰“å¼€æ–‡ä»¶
            sr = File.OpenText(file_url);
            Debug.Log("File Find in " + file_url);
        }
        catch
        {
            Debug.Log("File cannot find ! ");
            return; 
        }

        string line;
        while((line = sr.ReadLine()) != null)   //æŒ‰è¡Œè¯»å–
        {
            arrayData.Add(line.Split(','));   //æ¯è¡Œé€—å·åˆ†éš”,split()æ–¹æ³•è¿”å› string[]
        }
        sr.Close();
        sr.Dispose();
    }

    public string getString(int row,int col)
    {
        return arrayData[row][col];
    }
    public int getInt(int row,int col)
    {
        return int.Parse(arrayData[row][col]);
    }
}
```

*   åœ¨å…¶ä»–è„šæœ¬ä¸­è°ƒç”¨

```c
void Start () {
        //csvControlleråŠ è½½csvæ–‡ä»¶ï¼Œå•ä¾‹æ¨¡å¼ï¼Œè¿™ä¸ªç±»åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åªèƒ½åŠ è½½ä¸€ä¸ªcsvæ–‡ä»¶
        csvController.GetInstance().loadFile(Application.dataPath + "/Res", "csvTest.csv");
        //æ ¹æ®ç´¢å¼•è¯»å–csvControllerä¸­çš„listï¼ˆcsvæ–‡ä»¶çš„å†…å®¹ï¼‰æ•°æ®
        speed = csvController.GetInstance().getInt(1, 2);
        Debug.Log("Player speed is " + csvController.GetInstance().getInt(1,2));
    }
```

å‚è€ƒï¼š[http://www.jianshu.com/p/ffda934b5e15#](https://www.jianshu.com/p/ffda934b5e15#)

ç¨‹åºè¯»å–æ–‡ä»¶ä¿¡æ¯ï¼Œè¿™ä¸ªæ„Ÿè§‰å’Œä»¥å‰ C++ è¯»å– text/dat æ–‡ä»¶å·®ä¸å¤šçš„ã€‚  
unity å­˜å‚¨æ•°æ®æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå‚è€ƒ [http://www.wtoutiao.com/a/2139080.html](https://link.jianshu.com?t=http://www.wtoutiao.com/a/2139080.html)

# ScriptableObject

åœ¨[æ¸¸æˆå¼€å‘](https://so.csdn.net/so/search?q=%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91&spm=1001.2101.3001.7020)è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸ä¸æ•°æ®æ‰“äº¤é“ã€‚å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä¸ºæ¸¸æˆå¯¹è±¡é…ç½®æ•°æ®ï¼Œæ¯”å¦‚ç©å®¶åˆå§‹ç”Ÿå‘½å€¼ã€æŠ€èƒ½ä¼¤å®³ç­‰ã€‚é‚£ä¹ˆå°±éœ€è¦æœ‰ä¸ªèƒ½å¤Ÿå­˜å‚¨æ•°æ®çš„ä¸œè¥¿æ¥å’Œæ¸¸æˆå¯¹è±¡è¿›è¡Œäº¤äº’ã€‚

å‡è®¾ç°åœ¨è¦åšä¸€ä¸ª â€œæ‰“é£æœºâ€ çš„æ¸¸æˆï¼Œç©å®¶æ“æ§çš„é£æœºåœ¨åƒäº†ä¸åŒé“å…·åä¼šå‘å°„ä¸åŒç±»å‹çš„å­å¼¹ï¼Œè¿™äº›å­å¼¹çš„é£è¡Œé€Ÿåº¦å’Œä¼¤å®³å„ä¸ç›¸åŒã€‚é‚£ä¹ˆæ˜¾ç„¶æˆ‘è¦ä¸ºæ¯ä¸€ç§å­å¼¹é…ç½®å¥½å®ƒçš„å±æ€§å€¼ã€‚

å®ç°æ–¹å¼æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚æˆ‘ä¸ºæ¯ç§å­å¼¹åˆ›å»ºé¢„åˆ¶ä½“ï¼Œç„¶åå†™è„šæœ¬å»å®šä¹‰ä»£è¡¨å­å¼¹å„ä¸ªå±æ€§çš„æˆå‘˜å˜é‡ï¼Œå†æŠŠè„šæœ¬æŒ‚è½½åˆ°å­å¼¹é¢„åˆ¶ä½“ä¸Šã€‚ä¸ºäº†æ–¹ä¾¿åœ¨å¼€å‘æ—¶è°ƒè¯•æˆ‘ä»¬å¯ä»¥å°†è¿™äº›å˜é‡å£°æ˜ä¸º public ï¼Œä»¥ä¾¿æˆ‘ä»¬åœ¨ç¼–è¾‘å™¨é¢æ¿ä¸­å¯¹æ•°æ®è¿›è¡Œæ”¹åŠ¨ã€‚  

![[4e1d663836a8844b9b98207bded7f381_MD5.png]]

è¿™ä¹ˆåšå…¶å®æ˜¯æœ‰ç¼ºç‚¹çš„ï¼š

1ï¼‰ **æ¯ç”Ÿæˆä¸€ä¸ªå­å¼¹å°±ä¼šå¯¹åŸæ¥çš„é¢„åˆ¶ä½“è¿›è¡Œæ‹·è´ï¼Œå…¶æŒ‚è½½çš„ Bullet æ•°æ®è„šæœ¬åŒæ ·ä¼šè¢«æ‹·è´ï¼Œå› æ­¤åŒæ ·çš„æ•°æ®ä¼šè¢«æ‹·è´å¤šæ¬¡**ã€‚è€Œæˆ‘ä»¬è§„å®šåŒä¸€ç§å­å¼¹çš„æ•°æ®æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ç§å­å¼¹ï¼Œä¸ç®¡ç”Ÿæˆäº†å¤šå°‘ä¸ªï¼Œå®ƒä»¬éƒ½å…±ç”¨ä¸€å¥—æ•°æ®ã€‚å› æ­¤ï¼Œè¿™ç§æ–¹æ³•ä¼š**åˆ›å»ºå¤šä½™çš„æ•°æ®è„šæœ¬ï¼Œé€ æˆå†…å­˜æµªè´¹**ã€‚  
2ï¼‰ å¦‚æœé¢„åˆ¶ä½“ä¸Šçš„è„šæœ¬ä¸¢å¤±ï¼Œä¹‹å‰åœ¨ Inspector é¢æ¿ä¸­é…ç½®çš„æ•°æ®ä¹Ÿä¼šæ¶ˆå¤±ã€‚  
ğŸ˜«ğŸ˜«ğŸ˜«ğŸ˜«ğŸ˜«ğŸ˜«ğŸ˜«

ä¸è¿‡è§£å†³æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š

1ï¸âƒ£ æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå…¨å±€çš„æ•°æ®ç®¡ç†ä¸­å¿ƒè„šæœ¬ï¼Œé€šè¿‡é™æ€å˜é‡å»è°ƒç”¨æ¯ç§å­å¼¹çš„æ•°æ®ã€‚ä¸è¿‡è¿™ç§æ•°æ®é…ç½®æ–¹å¼ä¸èƒ½å®ç°æ•°æ®çš„æŒä¹…åŒ–ï¼Œè€Œä¸”å¿…é¡»è¦æ‰“å¼€ä»£ç æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œé¢å¯¹èŒ«èŒ«ä»£ç å¯èƒ½ä¸æ˜¯é‚£ä¹ˆç›´è§‚ã€‚  
2ï¸âƒ£ æˆ‘ä»¬è¿˜å¯ä»¥ç”¨ä¸Šåƒ **excelï¼ŒJsonï¼Œxml ç­‰æŒä¹…åŒ–æ•°æ®å­˜å‚¨**çš„æ–¹æ³•ï¼Œç»“åˆ Unity å¯¹å‡†å¤‡å¥½çš„æ•°æ®æ–‡ä»¶è¿›è¡Œæ•°æ®è¯»å†™ã€‚è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯å¯ä»¥å®ç°æ•°æ®çš„æŒä¹…åŒ–ï¼Œæ¯”å¦‚åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­ä¿®æ”¹äº†æ•°æ®ï¼Œé€€å‡ºæ¸¸æˆåä¸‹ä¸€æ¬¡æ‰“å¼€æ¸¸æˆä½¿ç”¨çš„å°±æ˜¯ä¹‹å‰ä¿®æ”¹è¿‡çš„æ•°æ®ã€‚

é‚£ä¹ˆç°åœ¨ï¼Œæˆ‘å°†ä»‹ç»å¦ä¸€ç§ç”¨äº**æ•°æ®å­˜å‚¨çš„è§£å†³æ–¹æ¡ˆâ€”â€”ScriptableObject**ã€‚å®ƒä¹Ÿèƒ½å¼¥è¡¥é€šè¿‡æŒ‚è½½ç»§æ‰¿è‡ª MonoBehaviour çš„è„šæœ¬æ¥é…ç½®æ•°æ®çš„ä¸€äº›ä¸è¶³ã€‚ç›¸è¾ƒäº excelï¼ŒJsonï¼Œxml è¿™ç±»æŒä¹…åŒ–æ•°æ®å­˜å‚¨çš„æ–¹æ³•ï¼Œå®ƒæœ‰äº›é¢å¤–çš„ä¼˜ç‚¹ï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ä¸€äº›å±€é™æ€§ã€‚æˆ‘å°†ä¼šåœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†è¯¦ç»†è¯´æ˜ã€‚

## ğŸ” ä»€ä¹ˆæ˜¯ ScriptableObject

*   ScriptableObject æ˜¯ Unity æä¾›çš„ä¸€ä¸ª**æ•°æ®é…ç½®å­˜å‚¨åŸºç±»**ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥ä¿å­˜å¤§é‡æ•°æ®çš„**æ•°æ®å®¹å™¨**ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä¿å­˜ä¸ºè‡ªå®šä¹‰çš„**æ•°æ®èµ„æºæ–‡ä»¶**ã€‚
*   ScriptableObject æ˜¯ä¸€ä¸ªç±»ä¼¼ MonoBehaviour çš„åŸºç±»ï¼Œç»§æ‰¿è‡ª UnityEngine. Object ã€‚è¦æƒ³ä½¿ç”¨å®ƒï¼Œéœ€è¦æˆ‘ä»¬å†™ä¸ªè„šæœ¬å»ç»§æ‰¿ ScriptableObject ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»§æ‰¿è‡ª SctiptableObject çš„è„šæœ¬æ— æ³•æŒ‚è½½åˆ°æ¸¸æˆç‰©ä½“ä¸Šï¼Œæ¯•ç«Ÿå®ƒä¸æ˜¯ç»§æ‰¿è‡ª MonoBehaviourã€‚
*   ScriptableObject ç±»çš„**å®ä¾‹**ä¼šè¢«ä¿å­˜æˆèµ„æºæ–‡ä»¶ï¼ˆ. asset æ–‡ä»¶ï¼‰ï¼Œå’Œé¢„åˆ¶ä½“ï¼Œæè´¨çƒï¼ŒéŸ³é¢‘æ–‡ä»¶ç­‰ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸€ç§èµ„æºæ–‡ä»¶ï¼Œå­˜æ”¾åœ¨ Assets æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºå‡ºæ¥çš„å®ä¾‹ä¹Ÿæ˜¯å”¯ä¸€å­˜åœ¨çš„ã€‚

ç®€å•çš„çœ‹ä¸€ä¸‹ ScriptableObject çš„å®ä¾‹é•¿å•¥æ ·ï¼š  

![[1e5f113aea457891c1416f9a301fb188_MD5.png]]

ä¸Šå›¾æ˜¯ç¼–è¾‘å™¨çª—å£ä¸­çš„æ ·å­ï¼Œå†æ¥çœ‹çœ‹æœ¬åœ°æ–‡ä»¶å¤¹ä¸­çš„æ¨¡æ ·ï¼š  

![[693da9ec55e4e252b4d18f0a25991a8b_MD5.png]]

  
å¯ä»¥çœ‹åˆ° ScriptableObject å®ä¾‹å°±æ˜¯ä¸€ç§èµ„æºæ–‡ä»¶ã€‚ç»†å¿ƒçš„ä½ å¯èƒ½ä¼šå‘ç°æˆ‘è¿™é‡Œå¼ºè°ƒçš„æ˜¯ **ScriptableObject çš„å®ä¾‹ï¼ˆinstanceï¼‰**ï¼Œé‚£ä¹ˆä½ ä¹Ÿè®¸ä¼šè”æƒ³åˆ°ç±»ä¸å®ä¾‹ï¼ˆæˆ–è€…å«å¯¹è±¡ï¼‰çš„å…³ç³»ã€‚å…¶å® ScriptableObject ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ**å®ƒæœ¬èº«æ˜¯ä¸ªç±»ï¼Œå®ä¾‹åŒ–ä¹‹åå¾—åˆ°çš„å°±æ˜¯æ•°æ®èµ„æºæ–‡ä»¶**ã€‚

é‚£ä¹ˆï¼Œè¦å¦‚ä½•ä½¿ç”¨ ScriptableObject è¿™ä¸ªç±»ï¼Œåˆå¦‚ä½•åˆ›å»ºå‡ºç¼–è¾‘å™¨é¢æ¿ä¸­çš„è¿™ä¸ªæ•°æ®èµ„æºæ–‡ä»¶å‘¢ï¼Ÿåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ ScriptableObject çš„ä¸»è¦ä½œç”¨ï¼Œæ¥åŠ æ·±å¤§å®¶å¯¹å®ƒçš„ç†è§£ã€‚åˆšåˆšå·²ç»ä»‹ç»äº†å®ƒæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œé‚£ä¹ˆç°åœ¨å°†è¿›ä¸€æ­¥ä»‹ç»å®ƒä¸€èˆ¬èƒ½ç”¨æ¥åšä»€ä¹ˆã€‚

## ğŸ” ScriptableObject çš„ä¸»è¦ä½œç”¨

å¤§ä½“ä¸Šå¯ä»¥åˆ†æˆä¸‰ç‚¹ï¼š  
1ï¼‰ ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ•°æ®æŒä¹…åŒ–
2ï¼‰ é…ç½®æ–‡ä»¶ ï¼ˆé…ç½®æ¸¸æˆä¸­çš„æ•°æ®ï¼‰  
3ï¼‰ æ•°æ®å¤ç”¨ ï¼ˆå¤šä¸ªå¯¹è±¡å…±ç”¨ä¸€å¥—æ•°æ®ï¼‰

### ğŸ’ª ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ•°æ®æŒä¹…åŒ–

æ•°æ®æŒä¹…åŒ–ï¼šä½¿ç”¨æ•°æ®æ—¶ä»ç¡¬ç›˜ä¸­è¯»å–ï¼Œæ•°æ®æ”¹å˜åä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œæ¸¸æˆé€€å‡ºåæ•°æ®ä¿¡æ¯è¢«å­˜å‚¨åˆ°ç¡¬ç›˜ä¸Šï¼Œè¾¾åˆ°æŒä¹…åŒ–çš„ç›®çš„ã€‚

å½“æˆ‘ä»¬åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ä¿®æ”¹äº†ç»§æ‰¿è‡ª ScriptableObject å¯¹è±¡çš„æ•°æ®æ–‡ä»¶å†…å®¹æ—¶ï¼Œä¿®æ”¹çš„æ•°æ®å°†è¢«ä¿å­˜åˆ°ç£ç›˜ä¸Šã€‚ä½†æ˜¯åœ¨å‘å¸ƒè¿è¡Œåï¼Œå³ä½¿åœ¨æ¸¸æˆä¸­ä¿®æ”¹äº† ScriptableObject çš„æ•°æ®ï¼Œæ”¹åçš„æ•°æ®å¹¶ä¸ä¼šä¿å­˜åœ¨æœ¬åœ°ï¼Œ**é‡æ–°æ‰“å¼€è¿è¡Œæ—¶æ•°æ®å¹¶è¿˜æ˜¯é…ç½®çš„åˆå§‹æ•°æ®**ã€‚

**å› æ­¤ ScriptableObject é€‚åˆåœ¨ç¼–è¾‘æ¨¡å¼ä¸‹è°ƒè¯•æ•°æ®ï¼Œä½†ä¸é€‚åˆå­˜å‚¨åœ¨æ¸¸æˆæ‰“åŒ…å‘å¸ƒåçš„è¿è¡ŒæœŸé—´ä¼šæ”¹å˜çš„æ•°æ®** â—

### ğŸ’ª é…ç½®æ–‡ä»¶

ScriptableObject éå¸¸é€‚åˆç”¨æ¥åšé…ç½®æ–‡ä»¶ã€‚å› ä¸ºï¼š  
1ï¼‰é…ç½®æ–‡ä»¶çš„æ•°æ®åœ¨æ¸¸æˆå‘å¸ƒä¹‹å‰å°±å®šå¥½äº†è§„åˆ™  
2ï¼‰é…ç½®æ–‡ä»¶çš„æ•°æ®åœ¨æ¸¸æˆè¿è¡Œæ—¶åªä¼šè¯»å‡ºæ¥ä½¿ç”¨ï¼Œä¸ä¼šä¿®æ”¹æ•°æ®çš„å†…å®¹  
3ï¼‰ä¼ ç»Ÿçš„é…ç½®æ–‡ä»¶ä¸€èˆ¬ä¼šé€šè¿‡ xmlã€jsonã€excel ç­‰æ–¹å¼æ¥é…ç½®æ¸¸æˆæ•°æ®  
ï¼Œç›¸å¯¹æ¥è¯´éƒ½æ˜¯åœ¨ Unity å¤–éƒ¨é€šè¿‡å…¶å®ƒæ ¼å¼çš„æ–‡ä»¶å¯¹æ•°æ®è¿›è¡Œé…ç½®ã€‚  
è€Œé€šè¿‡ ScriptableObject æˆ‘ä»¬å¯ä»¥ç›´æ¥**åœ¨ Unity å†…éƒ¨çš„ Inspector é¢æ¿ä¸­è¿›è¡Œæ•°æ®çš„é…ç½®**ï¼Œæœ‰æ—¶å€™ä¼šæ›´åŠ æ–¹ä¾¿ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨ ScriptableObject æ•°æ®æ–‡ä»¶æ¥åˆ¶ä½œç¼–è¾‘å™¨ç›¸å…³åŠŸèƒ½ï¼Œæ¯”å¦‚åˆ¶ä½œ Unity å†…ç½®çš„æŠ€èƒ½ç¼–è¾‘å™¨ã€å…³å¡ç¼–è¾‘å™¨ç­‰ã€‚å› ä¸ºå†…ç½®ç¼–è¾‘å™¨åªåœ¨ç¼–è¾‘æ¨¡å¼ä¸‹è¿è¡Œï¼Œåœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ ScriptableObject æ­£å¥½å…·æœ‰æ•°æ®æŒä¹…åŒ–çš„ç‰¹æ€§ã€‚

### ğŸ’ª æ•°æ®å¤ç”¨

å¯¹äºåªç”¨ä¸å˜çš„æ•°æ®ï¼Œé€šè¿‡ä½¿ç”¨ ScriptableObject å¯ä»¥æœ‰æ•ˆé¿å…å†…å­˜çš„æµªè´¹ï¼Œå› ä¸ºå®ƒå°†å…±ç”¨çš„æ•°æ®å•ç‹¬æŠ½ç¦»å‡ºæ¥ï¼Œä¾›ç›¸åŒçš„ä¸€ç±»å¯¹è±¡ä½¿ç”¨ã€‚

è¿˜æ˜¯åˆ©ç”¨å‰è¨€ä¸­ä¸¾çš„ä¾‹å­ï¼Œæ¯”å¦‚ä¸€ä¸ªå­å¼¹å¯¹è±¡ï¼Œé€šè¿‡é¢å‘å¯¹è±¡çš„æ€æƒ³ï¼Œä¼šå†™ä¸€ä¸ªç»§æ‰¿è‡ª MonoBehaviour çš„è„šæœ¬ï¼Œå£°æ˜ç›¸å…³çš„å±æ€§ï¼Œç„¶åæŒ‚è½½åˆ°å­å¼¹é¢„è®¾ä½“ä¸Šï¼ŒæŠŠå­å¼¹éœ€è¦çš„æ•°æ®èµ‹ç»™å­å¼¹å¯¹è±¡ã€‚å¦‚æœæˆ‘ä»¬è¦æ±‚å­å¼¹çš„æ•°æ®æ˜¯**ä¸ä¼šæ”¹å˜**çš„ï¼Œé‚£ä¹ˆè¿™æ ·æ¯æ¬¡å®ä¾‹åŒ–ä¸€ä¸ªå­å¼¹ï¼Œå¯¹å†…å­˜æ¥è¯´ä¼šé€ æˆä¸€å®šçš„æµªè´¹ï¼Œå› ä¸ºæ¯æ¬¡ç”Ÿæˆä¸€ä¸ªå­å¼¹éƒ½ä¼šå¤åˆ¶ Assets ä¸‹å­å¼¹é¢„åˆ¶ä½“çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¤šæ¬¡å¤åˆ¶äº†ç›¸åŒçš„æ•°æ®ã€‚  

![[65d2a4a611ac044c5abbacc9b610ec39_MD5.png]]

![[4f6b0bcd41992e531c687a571c9fdd21_MD5.png]]

**è¿™æ ·æ¯ä¸€ä¸ªå­å¼¹é¢„è®¾ä½“ä¸Šéƒ½æœ‰è¯¥è„šæœ¬ï¼Œè¯¥è„šæœ¬ä¸­çš„æ‰€æœ‰çš„å±æ€§éƒ½ä¼šåˆ†é…ä¸€æ¬¡å†…å­˜**ã€‚

ä½†æ˜¯å¦‚æœæ˜¯ç”¨ ScriptableObjectï¼Œå¯¹äºæŸä¸€ç§å­å¼¹ï¼Œæˆ‘ä»¬**åªéœ€è¦æ‹¥æœ‰ä¸€ä»½ ScriptableObject çš„å®ä¾‹ï¼Œä¹Ÿå«åšæ•°æ®èµ„æºæ–‡ä»¶ï¼Œç„¶åè¿™ä¸€ç§å­å¼¹çš„æ‰€æœ‰æ¸¸æˆç‰©ä½“éƒ½å¼•ç”¨è¿™ä¸ªæ•°æ®èµ„æºæ–‡ä»¶**ï¼Œå°±å¯å®ç°ä¸ç®¡ç”Ÿæˆå¤šå°‘ä¸ªå­å¼¹ï¼Œåªè¦å®ƒä»¬å±äºåŒä¸€ç±»ï¼Œéƒ½ä¼šå…±ç”¨ä¸€ä»½æ•°æ®ã€‚  

![[553cf2048f555db8969ad84bbfa5c3e5_MD5.png]]

è¿™é‡Œæ¯ä¸ªå­å¼¹é¢„åˆ¶ä½“ä¸­çš„å­å¼¹è„šæœ¬éƒ½åªæ˜¯æŒæœ‰ Bullet Data è¿™ä¸€ä¸ª ScriptableObject å®ä¾‹çš„å¼•ç”¨ï¼ŒçœŸæ­£åœ¨å†…å­˜å½“ä¸­åˆ†é…ç©ºé—´çš„åªæœ‰çº¢çº¿æ‰€æŒ‡å‘çš„ ScriptableObject å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„æ•°æ®èµ„æºæ–‡ä»¶ã€‚

## ğŸ” å¦‚ä½•åˆ›å»º ScriptableObject

ScriptableObject æ˜¯ä¸ªç±»ï¼Œå› æ­¤è‡ªç„¶ä¼šæœ‰å…ˆå£°æ˜ï¼Œåå®ä¾‹åŒ–çš„æ­¥éª¤ã€‚

### ğŸ“• æ­¥éª¤ä¸€ï¼šå£°æ˜è‡ªå®šä¹‰çš„æ•°æ®å®¹å™¨

ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªè„šæœ¬ç»§æ‰¿è‡ª ScriptableObject ç±»  
ç¬¬äºŒæ­¥ï¼šåœ¨è¯¥ç±»ä¸­å£°æ˜æˆå‘˜ï¼Œè§„å®šè¦å­˜å“ªäº›ç±»å‹çš„æ•°æ® ï¼ˆå¦‚æœåç»­åˆ›å»ºäº†æ•°æ®èµ„æºæ–‡ä»¶ï¼Œè¦åœ¨ Inspector çª—å£ä¸­çœ‹åˆ°è¿™äº›æˆå‘˜ï¼Œéœ€è¦æŠŠå®ƒä»¬å£°æ˜ä¸º public ï¼‰

```
public class BulletData : ScriptableObject
{
    public float speed;
    public float damage;
}
```

è¿™ä¸€æ­¥å°±ç›¸å½“äºå®šä¹‰äº†ä¸€ä¸ªæ•°æ®çš„æ¨¡æ¿ã€‚

### ğŸ“• æ­¥éª¤äºŒï¼šæ ¹æ®è‡ªå®šä¹‰çš„ ScriptableObject æ•°æ®å®¹å™¨åˆ›å»ºæ•°æ®æ–‡ä»¶

è¿™ä¸€æ­¥å°±ç›¸å½“äºæ ¹æ®å®šä¹‰çš„æ¨¡æ¿å®ä¾‹åŒ– ScriptableObject ï¼Œå…·ä½“æœ‰ä¸¤ç§æ–¹æ³•ï¼š

#### ğŸ˜Š æ–¹æ³•ä¸€ï¼šä¸ºç±»æ·»åŠ  CreateAssetMenu ç‰¹æ€§ï¼Œåœ¨ç¼–è¾‘å™¨çš„èœå•ä¸­åˆ›å»ºèµ„æºæ–‡ä»¶

```
[CreateAssetMenu (fileName = "BulletData", menuName = "ScriptableObject/å­å¼¹æ•°æ®", order = 0)]
public class BulletData : ScriptableObject
{
    public float speed;
    public float damage;
}
```

è¿™ç§åˆ›å»º ScriptableObject èµ„æºæ–‡ä»¶çš„æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒç®€å•ä¸”å¸¸è§çš„ï¼Œä¸»è¦å°±æ˜¯åœ¨ç±»çš„ä¸Šæ–¹åŠ ä¸€ä¸ª CreateAssetMenu ç‰¹æ€§ã€‚

fileName è¡¨ç¤ºæ•°æ®èµ„æºæ–‡ä»¶åˆ›å»ºå‡ºæ¥çš„æ–‡ä»¶åã€‚  
menuName è¡¨ç¤ºåœ¨ Assets/Create ä¸‹çš„åå­—ã€‚  
order è¡¨ç¤ºåœ¨ Assets/Create ä¸‹çš„ä½ç½®é¡ºåºã€‚

è¿™é‡Œæ¶‰åŠåˆ°ä¸€ç‚¹ç¼–è¾‘å™¨æ‰©å±•çš„çŸ¥è¯†ã€‚å…‰çœ‹è¿™ä¸€æ®µæ–‡å­—æè¿°ä¹Ÿè®¸çœ‹ä¸å‡ºä¸ªæ‰€ä»¥ç„¶ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä¼šå¸¦ç€å¤§å®¶å®æ“ä¸€éï¼Œè¿‡ç¨‹å…¶å®éå¸¸çš„ç®€å•ç²—æš´ğŸ˜‰ã€‚  
æ—¢ç„¶è¦åˆ›å»ºèµ„æºæ–‡ä»¶ï¼Œå¤§å®¶å…¶å®å¯ä»¥ç±»æ¯”åˆ›å»ºæè´¨ã€é¢„åˆ¶ä½“ï¼Œå®ƒä»¬ä¹Ÿæ˜¯ä¸€ç§èµ„æºæ–‡ä»¶ã€‚è¦æƒ³åˆ›å»ºå®ƒä»¬ï¼Œæˆ‘ä»¬åªè¦åœ¨ç¼–è¾‘å™¨ä¸­çš„ Asset ç›®å½•æˆ–è€…å®ƒçš„å­ç›®å½•ä¸­æŒ‰ä¸‹é¼ æ ‡å³é”®ï¼ˆæˆ–è€…ç›´æ¥ç‚¹å‡»ç¼–è¾‘å™¨æœ€ä¸Šæ–¹èœå•æ çš„ Assetsï¼‰ï¼Œç„¶åç‚¹å‡» Createï¼Œæ‰¾åˆ°æˆ‘ä»¬æƒ³è¦åˆ›å»ºçš„èµ„æºå°±è¡Œäº†ã€‚  

![[6a54d05cff033c5abbd0c5e5f1968a7c_MD5.png]]

![[cce25a63f89be9ccaecf1528e07dcaeb_MD5.png]]

  
ï¼ˆæ³¨ï¼šç‚¹å‡» Project é¢æ¿ä¸­çš„ â€œ+â€ ä¹Ÿèƒ½å®ç°ï¼‰

é‚£ä¹ˆ ScriptableObject ä¹Ÿæ˜¯ä¸€æ ·ï¼Œåªä¸è¿‡**æˆ‘ä»¬è¦æ‰‹åŠ¨ä¸ºç»§æ‰¿è‡ª ScriptableObject çš„ç±»æ·»åŠ  CreateAssetMenu ç‰¹æ€§ï¼Œè®©å®ƒèƒ½åƒé¢„åˆ¶ä½“ã€æè´¨çƒè¿™ç±»èµ„æºæ–‡ä»¶ä¸€æ ·èƒ½å¤Ÿåœ¨ç¼–è¾‘å™¨é¢æ¿ä¸­æ‰‹åŠ¨åˆ›å»ºã€‚**

å¦‚æœä½ åƒæˆ‘æ¼”ç¤ºçš„ä»£ç é‚£æ ·æ·»åŠ äº† CreateAssetMenu ç‰¹æ€§ï¼Œä½ ä¼šå‘ç° Create çš„ä¸‹ä¸€çº§ç›®å½•çš„æœ€ä¸Šæ–¹å‡ºç°äº†ä¸€ä¸ª ScritableObjectã€‚  

![[f331e30c66459ff2c433feadbea5a632_MD5.png]]

æˆ‘ä»¬è¿˜å¯ä»¥æŠŠé¼ æ ‡ç§»åˆ°èœå•ä¸­ ScriptableObject çš„ä½ç½®ï¼Œå¯ä»¥å‘ç°å®ƒåˆå±•å¼€äº†ä¸‹ä¸€çº§ç›®å½•ï¼š  

![[d82ba5e8713ff5a2433f2b8e28b60252_MD5.png]]

è¿™æ—¶å€™å‡ºç°äº†æˆ‘ä»¬çš„ â€œå­å¼¹æ•°æ®â€ ï¼ˆè¿™ä¸€çº§ç›®å½•ä¸‹è¿˜æœ‰æˆ‘ä¹‹å‰åˆ›å»ºçš„å…¶ä»– ScriptableObjectï¼‰ ï¼ŒScriptableObject ä¸‹çš„â€œå­å¼¹æ•°æ®â€ å°±æ˜¯æˆ‘ä»¬åˆšåˆšåœ¨ menuName ä¸­å®šä¹‰çš„ï¼Œç„¶åæˆ‘ä»¬ç‚¹å‡»å®ƒã€‚  

![[1e5f113aea457891c1416f9a301fb188_MD5.png]]

è¿™æ—¶å€™å°±æˆåŠŸåˆ›å»ºäº†æˆ‘ä»¬çš„æ•°æ®èµ„æºæ–‡ä»¶ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨ Inspector é¢æ¿ä¸­é…ç½®æ•°æ®äº†ã€‚  
å›çœ‹ CreateAssetMenu ç‰¹æ€§, ä½ æ˜¯å¦èƒ½ç†è§£å®ƒçš„ä¸€äº›å±æ€§äº†å‘¢ï¼Ÿ

fileName çš„å€¼å°±å¯¹åº”äº†æˆ‘ä»¬åˆ›å»ºå‡ºæ¥çš„æ•°æ®èµ„æºæ–‡ä»¶çš„æ–‡ä»¶åã€‚  
menuName çš„å€¼å¯¹åº”äº†æˆ‘ä»¬è¦å¦‚ä½•åœ¨ç¼–è¾‘å™¨é¢æ¿ä¸­åˆ›å»ºå‡ºæ•°æ®èµ„æºæ–‡ä»¶çš„è·¯å¾„ï¼Œä» Assets/Create å¼€å§‹ï¼Œæˆ‘ä»¬å¦‚æœæƒ³å°†è·¯å¾„åˆ†çº§ï¼Œå¯ä»¥åœ¨è·¯å¾„åä¹‹é—´ç”¨ â€œ/â€ éš”å¼€ã€‚  
é‚£ order æ˜¯æ€ä¹ˆä¸€å›äº‹å‘¢ï¼Ÿå®ƒçš„é»˜è®¤å€¼æ˜¯ 0ï¼Œæˆ‘ä»¬ä¹‹å‰çœ‹åˆ° ScriptableObject ç›®å½•ä¸‹ â€œå­å¼¹æ•°æ®â€ æ˜¯æ’åœ¨ç¬¬ä¸€ä½çš„ï¼Œé‚£æˆ‘å¦‚æœæŠŠ order çš„å€¼ç”± 0 æ”¹æˆ 1 ä¼šå‘ç”Ÿä»€ä¹ˆäº‹å‘¢ï¼Ÿè¯·çœ‹ï¼š  

![[4ca118182146752514fc333a59e78251_MD5.png]]

  
äº‹å…ˆè¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘çš„å¦å¤–ä¸¤ä¸ª ScriptableObject çš„ order ä¹Ÿæ˜¯è®¾æˆ 0ï¼Œé‚£ä¹ˆä½ å¯ä»¥çœ‹åˆ° â€œå­å¼¹æ•°æ®â€ ç°åœ¨æ’åœ¨äº†ç¬¬ä¸‰ä½ã€‚  
é‚£ä¹ˆè¿™ä¸ª order å…¶å®å°±è§„å®šäº†åˆ›å»º ScriptableObject æ•°æ®èµ„æºæ–‡ä»¶çš„è·¯å¾„åœ¨èœå•ä¸Šæ˜¾ç¤ºçš„ä½ç½®ï¼Œorder è¶Šä½ï¼Œå°±æ˜¾ç¤ºåœ¨è¶Šä¸Šé¢ã€‚å¦‚æœ order ç›¸åŒï¼Œåˆ™æ˜¯æŒ‰ç…§ç»§æ‰¿è‡ª ScriptableObject çš„è„šæœ¬åˆ›å»ºæ—¶é—´æ’åºï¼Œæ–°åˆ›å»ºçš„æ’åœ¨ä¸Šé¢ã€‚

#### ğŸ˜Š æ–¹æ³•äºŒï¼šåˆ©ç”¨ ScriptableObject çš„é™æ€æ–¹æ³•åˆ›å»ºæ•°æ®å¯¹è±¡ï¼Œç„¶åå°†æ•°æ®å¯¹è±¡ä¿å­˜åœ¨å·¥ç¨‹ç›®å½•ä¸‹

å¯ä»¥æ–°å»ºä¸€ä¸ªè„šæœ¬ï¼ˆå¯ä»¥ä¸ç”¨ç»§æ‰¿è‡ª MonoBehavoiurï¼Œè¿™ä¸ªè„šæœ¬ä¸ç”¨æŒ‚è½½åˆ°æ¸¸æˆç‰©ä½“ä¸Šï¼‰ï¼Œå¼•å…¥ UnityEditor å‘½åç©ºé—´ï¼š

```
using UnityEngine;
using UnityEditor;
public class ScriptableObjectTool 
{
    [MenuItem ("ScritableObject/CreateMyData")]
    public static void CreateMyData()
    {
        //åˆ›å»ºæ•°æ®èµ„æºæ–‡ä»¶
        //æ³›å‹æ˜¯ç»§æ‰¿è‡ªScriptableObjectçš„ç±»
        BulletData asset = ScriptableObject.CreateInstance<BulletData>();
        //å‰ä¸€æ­¥åˆ›å»ºçš„èµ„æºåªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œç°åœ¨è¦æŠŠå®ƒä¿å­˜åˆ°æœ¬åœ°
        //é€šè¿‡ç¼–è¾‘å™¨APIï¼Œåˆ›å»ºä¸€ä¸ªæ•°æ®èµ„æºæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºèµ„æºæ–‡ä»¶åœ¨Assetsç›®å½•ä¸‹çš„è·¯å¾„
        AssetDatabase.CreateAsset(asset, "Assets/Resources/ScriptableObject/BulletData.asset");
        //ä¿å­˜åˆ›å»ºçš„èµ„æº
        AssetDatabase.SaveAssets();
        //åˆ·æ–°ç•Œé¢
        AssetDatabase.Refresh();
    }
}
```

ä¿å­˜è„šæœ¬åï¼Œä¼šå‘ç°ç¼–è¾‘å™¨æœ€ä¸Šæ–¹çš„èœå•æ å¤šå‡ºäº†è¿™ä¸ªï¼ˆMenuItem ç‰¹æ€§èµ·çš„ä½œç”¨ï¼‰ï¼š  

![[372912b963bcc47098df28a5274fa252_MD5.png]]

  
ç‚¹å‡»åï¼Œå¯ä»¥çœ‹åˆ° Assets/Resources/ScriptableObject æ–‡ä»¶å¤¹ä¸‹å¤šäº†æˆ‘ä»¬æƒ³è¦çš„æ•°æ®èµ„æºæ–‡ä»¶ï¼š  

![[9169cae06e4925acec6959d3a8bf1e3f_MD5.png]]

**æ³¨æ„ï¼š**  
1ï¸âƒ£ ä½¿ç”¨è¿™ç§æ–¹æ³•æ— éœ€åœ¨ç»§æ‰¿è‡ª ScriptableObject çš„ç±»ä¸Šå¢åŠ  CreateAssetMenu ç‰¹æ€§ã€‚  
2ï¸âƒ£ **åˆšåˆšåˆ›å»ºçš„ ScriptableObjectTool è„šæœ¬éœ€è¦æ”¾åœ¨ Assets æ–‡ä»¶å¤¹ä¸‹ä»»ä¸€ä½ç½®çš„ Editor æ–‡ä»¶å¤¹ä¸‹**ï¼ˆè¿™ä¸ªæ–‡ä»¶å¤¹æ”¾å“ªéƒ½è¡Œï¼Œçœ‹è‡ªå·±éœ€æ±‚ï¼Œåªè¦åœ¨ Assets æ–‡ä»¶å¤¹æˆ–å…¶å­æ–‡ä»¶å¤¹ä¸‹å°±å¥½ï¼‰ã€‚**å› ä¸ºæˆ‘ä»¬å¼•å…¥äº† UnityEditor å‘½åç©ºé—´ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªè„šæœ¬åªåœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ä¼šç”¨åˆ°ï¼Œå®é™…æ‰“åŒ…å‘å¸ƒåæ˜¯ä¸ä¼šç”¨åˆ°çš„**ã€‚å¦‚æœæ²¡æ”¾åœ¨ Editor æ–‡ä»¶å¤¹ä¸‹ï¼ŒUnity æ‰“åŒ…æ—¶ä¼šè®¤ä¸ºæ­¤è„šæœ¬æ˜¯ä¼šè¢«ä¸€èµ·æ‰“åŒ…ï¼Œä½œç”¨äºæ¸¸æˆè¿è¡ŒæœŸé—´ï¼Œä¸ Editor å‘½åç©ºé—´çš„æ€§è´¨ç›¸çŸ›ç›¾ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚ï¼ˆè¿™é‡Œå°±æ¶‰åŠåˆ°ä¸€äº›æ‰©å±•ç¼–è¾‘å™¨çš„çŸ¥è¯†ï¼‰  

![[8b32c27a0db09a13b6f0ffe140ed0698_MD5.png]]

### ğŸ˜Š æ€»ç»“åˆ›å»º ScriptableObject çš„æ­¥éª¤

1ï¼‰å†™ä¸ªè„šæœ¬ï¼Œç»§æ‰¿ ScriptableObject ç±»  
2ï¼‰å£°æ˜éœ€è¦çš„æ•°æ®å˜é‡  
3ï¼‰æ·»åŠ ç‰¹æ€§æ¥åˆ›å»ºæ•°æ®èµ„æºæ–‡ä»¶ã€‚è¿™ç›¸å½“äºä¸€ç§ä¸“é—¨ç”¨æ¥è®°å½•æ•°æ®çš„èµ„æºï¼Œå’Œé¢„åˆ¶ä½“ï¼Œæè´¨çƒï¼ŒéŸ³é¢‘æ–‡ä»¶ä¸€æ ·éƒ½æ˜¯èµ„æºï¼Œåªä¸è¿‡æ˜¯é€šè¿‡ç»§æ‰¿è‡ª ScriptableObject ç±»ç”Ÿæˆçš„æ•°æ®èµ„æºæ–‡ä»¶ã€‚

## ğŸ” å¦‚ä½•ä½¿ç”¨ ScriptableObject

æˆ‘ä»¬åˆšåˆšä»‹ç»äº†å¦‚ä½•åˆ›å»º ScriptableObjectï¼Œä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®èµ„æºï¼Œå¹¶æ²¡æœ‰å°†å®ƒå­˜å‚¨çš„æ•°æ®å’Œæˆ‘ä»¬çš„æ¸¸æˆå¯¹è±¡å…³è”èµ·æ¥ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘å°†ä»‹ç»å¦‚ä½•å»è¿ç”¨åˆ›å»ºå‡ºæ¥çš„æ•°æ®èµ„æºæ–‡ä»¶ã€‚

### ğŸ“• â… . æ•°æ®æ–‡ä»¶çš„ä½¿ç”¨

#### ğŸ˜Šæ–¹æ³•ä¸€ï¼šé€šè¿‡ Inspector é¢æ¿ä¸­çš„ public å˜é‡è¿›è¡Œå…³è”

æ­¥éª¤ä¸€ï¼šåˆ›å»ºä¸€ä¸ªæ•°æ®æ–‡ä»¶  
æ­¥éª¤äºŒï¼šåœ¨ç»§æ‰¿è‡ª MonoBehaviour ç±»ä¸­å£°æ˜æ•°æ®å®¹å™¨ç±»å‹çš„æˆå‘˜ï¼Œåœ¨ Inspector é¢æ¿ä¸­è¿›è¡Œå…³è”ï¼ˆæ‹–æ‹½çš„æ˜¯æ•°æ®æ–‡ä»¶è€Œä¸æ˜¯ç»§æ‰¿è‡ª ScriptableObject ç±»çš„è„šæœ¬ï¼‰  

![[564200183c038bc2577039137227c635_MD5.png]]

ä¸ä½¿ç”¨ ScriptableObject çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„å­å¼¹è„šæœ¬æ˜¯è¿™ä¹ˆå†™çš„ï¼š  

![[733ebd2f19481b7dc3415d4562c806a5_MD5.png]]

  
é‚£ä¹ˆç°åœ¨æˆ‘ä»¬åªéœ€æŠŠæ•°æ®æœ‰å…³çš„éƒ¨åˆ†æ›¿æ¢æˆ ScriptableObject çš„å¼•ç”¨å°±è¡Œäº†ï¼š  

![[c9dbc2093c66bf771b0190672238f238_MD5.png]]

  
ç„¶ååœ¨ Inspector é¢æ¿ä¸­æ‹–æ‹½èµ‹å€¼ï¼š  

![[b09f13f16b2b6fc509d2f5a3be836038_MD5.png]]

è¿™ä¸ªæ—¶å€™æ¸¸æˆå¯¹è±¡å°±å’Œæ•°æ®èµ„æºå…³è”èµ·æ¥äº†ï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªç‰©ä½“æŒ‚è½½äº† Bullet è„šæœ¬ï¼Œå®ƒä»¬å…³è”çš„éƒ½æ˜¯åŒä¸€ä»½æ•°æ®èµ„æºã€‚

#### ğŸ˜Šæ–¹æ³•äºŒï¼šç›´æ¥åŠ è½½æ•°æ®èµ„æºæ–‡ä»¶

å¯ä»¥ç”¨ Resourcesï¼ŒAddressBundleï¼ŒAddressables ç­‰æ–¹å¼åŠ è½½æ•°æ®èµ„æºæ–‡ä»¶ã€‚

### ğŸ“• â…¡. ç”Ÿå‘½å‘¨æœŸå‡½æ•°

ScriptableObject å’Œ MonoBehaviour ç±»ä¼¼ï¼Œä¹Ÿå­˜åœ¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä½†æ˜¯æ•°é‡ä¼šå°‘å¾ˆå¤šã€‚

```
Awake æ•°æ®æ–‡ä»¶åˆ›å»ºæ—¶è°ƒç”¨
OnDestroy å¯¹è±¡å°†è¢«é”€æ¯æ—¶è°ƒç”¨
OnEnable åˆ›å»ºæˆ–åŠ è½½å¯¹è±¡æ—¶è°ƒç”¨
OnDisable å¯¹è±¡é”€æ¯æ—¶ï¼Œå³å°†åŠ è½½è„šæœ¬ç¨‹åºé›†æ—¶è°ƒç”¨
OnValidate ç¼–è¾‘å™¨æ‰ä¼šè°ƒç”¨çš„å‡½æ•°ï¼ŒUnity åœ¨åŠ è½½è„šæœ¬æˆ–è€… Inspector é¢æ¿ä¸­æ›´æ”¹å€¼æ—¶è°ƒç”¨
```

é™¤æ­¤ä¹‹å¤–ç»§æ‰¿è‡ª ScriptableObject çš„ç±»ä¸­ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å‡½æ•°ï¼Œå¹¶ä¸æ˜¯åªèƒ½å£°æ˜å’Œæ•°æ®æœ‰å…³çš„å˜é‡ã€‚

### ğŸ“• â…¢. å®ç°éæŒä¹…åŒ–æ•°æ®

æˆ‘ä»¬çŸ¥é“ ScriptableObject åœ¨æ‰“åŒ…å‘å¸ƒåæ˜¯ä¸å…·å¤‡æ•°æ®æŒä¹…åŒ–çš„åŠŸèƒ½çš„ï¼Œä½†æ˜¯å®ƒèƒ½å®ç°ç¼–è¾‘æ¨¡å¼ä¸‹çš„æŒä¹…åŒ–æ•°æ®ã€‚åªè¦æˆ‘ä»¬åœ¨ç¼–è¾‘å™¨é¢æ¿ä¸­æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªæ•°æ®èµ„æºæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™ç›¸å½“äºæˆ‘ä»¬åœ¨ç£ç›˜ä¸­çœŸæ­£åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹‹ååœ¨ç¼–è¾‘æ¨¡å¼ä¸­ ScriptableObject çš„æ•°æ®æ”¹åŠ¨ä¼šè¢«ä¿å­˜åœ¨ç£ç›˜ä¸­ã€‚

å…¶å®ï¼Œå¯¹äºæŸäº›æ•°æ®èµ„æºï¼Œæˆ‘ä»¬ä¸ä¸€å®šè¦å°†æ•°æ®ä¿å­˜ä¸ºç£ç›˜ä¸­çš„èµ„æºæ–‡ä»¶å æ®ç©ºé—´ï¼Œè€Œåªå¸Œæœ›è¿è¡ŒæœŸé—´åœ¨å†…å­˜ä¸­ä¸´æ—¶ç”Ÿæˆä¸€ç»„å…±ç”¨çš„æ•°æ®ç»™å¯¹è±¡ä½¿ç”¨å°±å¤Ÿäº†ï¼Œé€€å‡ºæ¸¸æˆåå°±é‡Šæ”¾æ‰ç”Ÿæˆçš„æ•°æ®èµ„æºã€‚**è¿™ä¸ªæ—¶å€™ä¸è®ºæ˜¯åœ¨ç¼–è¾‘æ¨¡å¼è¿˜æ˜¯æ‰“åŒ…å‘å¸ƒåï¼Œæ•°æ®éƒ½æ˜¯éæŒä¹…åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯æ”¹åŠ¨çš„æ•°æ®ä¸ä¼šè¢«ä¿å­˜åˆ°ç£ç›˜ä¸­è€Œæ˜¯å†…å­˜ä¸­**ã€‚é€€å‡ºæ¸¸æˆåé‡æ–°æ‰“å¼€ï¼Œè¯»å–çš„è¿˜æ˜¯åˆå§‹é…ç½®çš„æ•°æ®ã€‚

**å¦‚ä½•ç”ŸæˆéæŒä¹…åŒ–æ•°æ®ï¼Ÿ**  
åˆ©ç”¨ ScriptableObject ç±»ä¸­çš„é™æ€æ–¹æ³• CreateInstance<>() ã€‚è¯¥æ–¹æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ›å»ºå‡ºæŒ‡å®šç»§æ‰¿è‡ª ScriptableObject çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åªå­˜åœ¨äºå†…å­˜ä¸­ï¼Œå¯ä»¥è¢« GC åƒåœ¾å›æ”¶ï¼Œè°ƒç”¨ä¸€æ¬¡å°±åˆ›å»ºä¸€æ¬¡ã€‚

```
public BulletData bulletData;
void Start (){
//é€šè¿‡è¿™ç§æ–¹å¼åˆ›å»ºçš„æ•°æ®å¯¹è±¡ï¼Œå®ƒé‡Œé¢çš„é»˜è®¤å€¼ä¸ä¼šå—åˆ°è„šæœ¬ä¸­è®¾ç½®çš„å½±å“ 
    bulletData=ScriptableObject.CreateInstance<BulletData>();   
}
```

ç°åœ¨æˆ‘ä»¬æŠŠåˆšåˆšåˆ›å»ºçš„æ•°æ®èµ„æºæ–‡ä»¶åœ¨æ–‡ä»¶å¤¹ä¸­åˆ æ‰ï¼Œåšä¸ªå°æµ‹è¯•ï¼Œåœ¨è„šæœ¬ä¸­ç”¨ä¸Š CreateInstance<>() æ–¹æ³•ï¼š  

![[de5e3d91f9b2b2c8ce783f010fa29e16_MD5.png]]

  
åœ¨ç¼–è¾‘æ¨¡å¼ä¸­ï¼Œæ¸¸æˆè¿˜æœªè¿è¡Œæ—¶ bulletData å¼•ç”¨çš„æ˜¯ç©ºæ•°æ®ã€‚  
ç„¶åè¿è¡Œæ¸¸æˆï¼Œå¯ä»¥å‘ç° bulletData å·²ç»å…³è”ä¸Šäº†ä¸€ä¸ªå­å¼¹æ•°æ®èµ„æºï¼š  

![[edf8e6b1e0a54551985d38c40c071bd1_MD5.png]]

  
è¿™ä¸ªæ•°æ®èµ„æºæ–‡ä»¶æ˜¯è¢«åŠ¨æ€åˆ›å»ºå‡ºæ¥çš„ï¼Œåªè¢«åˆ›å»ºåœ¨å†…å­˜ä¸­ã€‚å½“æˆ‘ä»¬å…³é—­æ¸¸æˆå bulletData å¼•ç”¨çš„èµ„æºé‡æ–°å˜æˆç©ºæ•°æ®ã€‚

### ğŸ“• â…£. è®© ScriptableObject çœŸæ­£æ„ä¹‰ä¸ŠæŒä¹…åŒ–

æ—¢ç„¶ ScriptableObject æœ¬èº«æ— æ³•åœ¨æ¸¸æˆæ‰“åŒ…å‘å¸ƒåå®ç°æ•°æ®æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é…åˆ Jsonï¼ŒPlayerPrefsï¼Œ xml ï¼ŒäºŒè¿›åˆ¶ç­‰æ–¹å¼æ¥å®ç° ScriptableObject çœŸæ­£æ„ä¹‰ä¸Šçš„æ•°æ®æŒä¹…åŒ–ã€‚

ä»¥ Json ä¸ºä¾‹ï¼š  
**åˆ©ç”¨ Json ç»“åˆ ScriptableObject å­˜å‚¨æ•°æ®**

```
public class TestScriptableObject : MonoBehaviour
{
    public BulletData bulletData;
    void Start() {
        bulletData= ScriptableObject.CreateInstance<BulletData>();
        bulletData.speed = 9.5f;
        bulletData.damage = 100.0f;
        //å°†æ•°æ®å¯¹è±¡åºåˆ—åŒ–ä¸ºJsonå­—ç¬¦ä¸²
        string str = JsonUtility.ToJson(bulletData);
        //å°†æ•°æ®åºåˆ—åŒ–åçš„ç»“æœå­˜å…¥æŒ‡å®šè·¯å¾„å½“ä¸­
        File.WriteAllText(Application.persistentDataPath + "/testJson.json", str);
    }

}
```

**åˆ©ç”¨ Json ç»“åˆ ScriptableObject è¯»å–æ•°æ®**

```
//ä»æœ¬åœ°è¯»å–Jsonå­—ç¬¦ä¸²
        string text = File.ReadAllText(Application.persistentDataPath + "/testJson.json");
        JsonUtility.FromJsonOverwrite(str, bulletData); //æ ¹æ®Jsonå­—ç¬¦ä¸²ååºåˆ—åŒ–å‡ºæ•°æ®ï¼Œå°†å†…å®¹è¦†ç›–åˆ°bulletDataæ•°æ®æ–‡ä»¶ä¸­
```

ä½†æ˜¯å®é™…ä¸Šï¼Œè®© ScriptableObject çœŸæ­£æ„ä¹‰ä¸Šæ•°æ®æŒä¹…åŒ–æœ‰ç‚¹ç”»è›‡æ·»è¶³çš„æ„Ÿè§‰ã€‚å› ä¸ºæ—¢ç„¶å·²ç»è¦ç”¨åˆ°æŒä¹…åŒ–æ•°æ®çš„æ–¹æ³•ï¼Œé‚£ä¸ºä»€ä¹ˆä¸å…¨éƒ¨ç”¨å®ƒä»¬æ¥è¿›è¡Œæ•°æ®äº¤äº’å‘¢ï¼Ÿå…¶å®å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ•°æ®ç»“æ„ç±»ï¼Œè®©å®ƒä¸æ•°æ®æŒä¹…åŒ–çš„æ–¹æ³•è¿›è¡Œäº¤äº’ï¼Œè€Œä¸æ˜¯å†å»åˆ›å»ºä¸€ä¸ªç±»ç»§æ‰¿è‡ª ScriptableObjectã€‚

### ğŸ“• â…¤. å•ä¾‹æ¨¡å—è·å–æ•°æ®

ä¹‹å‰ä»‹ç»ä½¿ç”¨æ•°æ®æ–‡ä»¶çš„æ—¶å€™ï¼Œè¦ä¹ˆæ˜¯é€šè¿‡å£°æ˜ public å˜é‡åœ¨ Inspector é¢æ¿ä¸­è¿›è¡Œæ‹–æ‹½å…³è”ï¼Œè¦ä¹ˆæ˜¯ä½¿ç”¨èµ„æºåŠ è½½çš„æ–¹æ³•ã€‚

å¦‚æœç”¨æ‹–æ‹½çš„æ–¹å¼ï¼Œç‰©ä½“ä¹‹é—´çš„æ‹–æ‹½å…³ç³»å¯èƒ½ä¼šéšç€é¡¹ç›®é‡çš„å¢é•¿è€Œå˜å¤æ‚ï¼Œä¸åˆ©ç”¨åç»­çš„ç»´æŠ¤ã€‚ğŸ˜Ÿ  
å¦‚æœç”¨èµ„æºåŠ è½½çš„æ–¹å¼ï¼Œä»¥ Resources ä¸ºä¾‹ï¼Œå¯èƒ½å°±è¦å†™å¤§é‡çš„ Resources. Load æ–¹æ³•ï¼Œå…¶å®æ˜¯æœ‰ä¸€ç‚¹é‡å¤å·¥ä½œçš„ã€‚ğŸ˜Ÿ

å› æ­¤å¯ä»¥å°† ScriptableObject å®ä¾‹**é€šè¿‡å•ä¾‹æ¨¡å¼åŒ–**å»è·å–ï¼Œå‡å°‘é‡å¤ä»£ç ï¼Œæé«˜ç¼–ç æ•ˆç‡ï¼š

```cs
public class SingleScriptableObject<T> : ScriptableObject where T :ScriptableObject
{
    //æ‰€æœ‰æ•°æ®èµ„æºæ–‡ä»¶éƒ½æ”¾åœ¨Resourcesæ–‡ä»¶å¤¹ä¸‹åŠ è½½å¯¹åº”çš„æ•°æ®èµ„æºæ–‡ä»¶
    //å¯¹éœ€è¦å¤ç”¨çš„å”¯ä¸€çš„æ•°æ®èµ„æºæ–‡ä»¶åå®šä¸€ä¸ªè§„åˆ™ï¼šæ–‡ä»¶åå’Œç±»åä¸€è‡´
    private static string scriptableObjectPath = "ScriptableObject/"+typeof(T).Name;
    private static T instance;
    public static T Instance
    {
        get
        {
            if (instance == null)
            {
                //å¦‚æœä¸ºç©ºï¼Œé¦–å…ˆåº”è¯¥å»èµ„æºè·¯å¾„ä¸‹åŠ è½½å¯¹åº”çš„æ•°æ®èµ„æºæ–‡ä»¶
                instance = Resources.Load<T>(scriptableObjectPath);
            }
            //å¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªæ•°æ®
            if (instance == null)
            {
                instance = CreateInstance<T>();
            }
            return instance;
        }      
    }
}
```

å‡å¦‚è¯´æˆ‘è¦å»è°ƒç”¨å­å¼¹æ•°æ®ï¼Œæˆ‘å°±è®© BulletData ç±»ç»§æ‰¿è‡ª SingleScriptableObject ç±»ï¼Œç„¶åç›´æ¥è¿™æ ·è°ƒç”¨å°±è¡Œäº†ï¼š

```cs
BulletData. Instance. speed
```

## ğŸ” æ€»ç»“

é‚£ä¹ˆ ScriptableObject çš„ç›¸å…³åŸºç¡€çŸ¥è¯†ç‚¹å·®ä¸å¤šå°±ä»‹ç»å®Œäº†ã€‚  
å¯¹äº**åªç”¨ä¸å˜**çš„æ•°æ®ï¼Œå°±é€‚åˆç”¨ ScriptableObject åš**æ•°æ®é…ç½®æ–‡ä»¶**ï¼Œå†åŠ ä¸Š**ç¼–è¾‘æ¨¡å¼ä¸‹å¯å®ç°æ•°æ®æŒä¹…åŒ–**çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ **Inspector é¢æ¿ä¸­è¿›è¡Œæ•°æ®çš„é…ç½®ä¸è°ƒè¯•**ï¼Œæœ‰çš„æ—¶å€™æ˜¯æ›´åŠ æ–¹ä¾¿çš„ï¼Œå¹¶ä¸”å¯ä»¥è¾¾åˆ°**æ•°æ®å¤ç”¨**çš„ç›®çš„ï¼Œå‡å°‘å†…å­˜æ¶ˆè€—ã€‚ä½†æ˜¯å®ƒæ— æ³•åœ¨æ¸¸æˆæ‰“åŒ…å‘å¸ƒåå°†æ•°æ®çš„å˜åŠ¨å­˜å‚¨åˆ°ç£ç›˜ä¸­ã€‚å› æ­¤æˆ‘ä»¬è¦ç†Ÿæ‚‰ ScriptableObject çš„ä¼˜ç¼ºç‚¹ï¼Œç»“åˆå®é™…éœ€æ±‚é€‰æ‹©ä½¿ç”¨ã€‚ğŸŒ¹