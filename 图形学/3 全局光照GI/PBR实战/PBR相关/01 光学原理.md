---
title: 3 光学原理
aliases: []
tags: []
create_time: 2023-07-10 12:28
uid: 202307101228
banner: ""
---
# 1 光的性质

## 2 光是什么？

狭义上说，光是电磁辐射的某一部分内人眼可见的电磁频谱，即可见光，它是人眼可感知的可见光谱，是造成视觉的原因。

可见光通常被定义为具有波长在 400-700 纳米（nm）的范围内，不可见的有红外线（具有更长的波长）和紫外线（具有更短的波长）。

广义上说，光指的是任何波长的电磁辐射，无论是否可见。包括伽马射线、X 射线、微波和无线电波。而可见光（400-700 纳米）只是所有波长区域的一小部分：  

![[1679148478105.png]]

## 3 电磁频谱和可见光（Electromagnetic spectrum and visible light）

电磁辐射（Electromagnetic Radiation，EMR）按波长从长到短分为：无线电波、微波、红外线、可见光、紫外线、X 射线和伽玛射线。

EMR 的行为取决于其波长。较高频率具有较短波长，较低频率具有较长波长。不同波长的电磁辐射携带着不同的能量。当 EMR 与单个原子和分子相互作用时，其行为取决于它携带的每个量子的能量。

不同波长的可见光代表着不同的颜色。太阳光、日光灯等可见光是一组不同波长的电磁辐射的集合，在三棱镜下可以被分离出不同的颜色：  

![[1679148478354.png]]

不同来源对可见光的定义略有不同，有的将可见光定义为狭窄的 420-680nm，有的宽达 380-800nm。在理想的实验室条件下，人们可以看到至少 1050 纳米的红外线; 儿童和年轻人可能会感知波长低至约 310-313 纳米的紫外线。  

![[1679148478410.png]]

## 3 人眼感知可见光原理

上节阐述了可见光的范围和简单的感知理论，本小节将深入阐述人类为什么会感知并且只感知波长为 380-800 纳米的可见光。

首先要了解人眼的结构和视觉的分子机制。

人眼的结构类似于一架高精度的照相机，光线穿过透明的角膜（cornea）和虹膜（iris）包围的瞳孔（pupil），经过晶状体（lens）的折射在视网膜（retina）上形成空间分布的像。而视网膜上则分布着主要检测**光强度**的视杆细胞（rod cell）和主要检测**颜色**的视锥细胞（cone cell），它们是视觉形成的细胞基础。  

![[1679148478475.png]]

视杆细胞与视锥细胞对光的响应程度虽然略有差异，但它们发生光响应的机制都是类似的。以视杆细胞上的视紫红质（rhodopsin）为例，它由一个细胞膜上的七次跨膜蛋白（视蛋白，opsin）和视黄醛（retinal）辅基组成。视蛋白是 G 蛋白偶联受体（GPCR）的一种，视黄醛辅基以共价键结合在其第七个跨膜$\alpha$螺旋片段的赖氨酸残基上。

视黄醛分子是由维生素 A 氧化而来的，一个维生素 A 分子氧化得到一个视黄醛。视黄醛具有两种构型：11 位顺式（11-cis）和 全反式（All-trans），正常与视蛋白结合的是 11 位顺式构型。恰巧在可见光（对视紫红质而言是波长 500 nm 左右的电磁波）照射下，11 位顺式构型可以转变为全反式构型，从而导致视黄醛辅基从视蛋白上脱离。辅基的脱离造成视紫红质**构象变化**，经过信号转导导致细胞膜内外**离子电位发生变化，产生神经电信号**。这一信号经过视神经传入大脑，就使得我们产生了视觉。  

![[1679148478739.png]]

  
_(a) 视紫红质的结构；(b) 视黄醛分子的光敏异构反应。_

因此，从视觉的分子机制出发，可以这么回答：正由于视黄醛分子的构型转变反应恰好响应了可见光波段的电磁波，这才导致这一波段的电磁波能被人类 “看见”。

此外，视黄醛分子是维生素 A 的部分氧化产物，又可由植物中广泛存在的天然色素——β- 胡萝卜素氧化得到，来源和代谢路径明确，被大多数生物进化选中作为光敏分子也在情理之中。

**那为什么高度进化的人类不能感知可见光谱之外的电磁辐射呢？为什么视黄醛分子刚好只对可见波段的电磁波产生反应？**

这个可以从各个波段的电磁辐射的性质来回答。

波长最短的伽马射线（Gamma ray）和高能 X 射线（X ray）由于携带的能量（光子）太高，很快就会导致分子电离、分解甚至激发原子核（导致原子核爆发）。首先被排除。

波长较短的深紫外（deep Ultraviolet）和软 X 射线激发的电子能级一般是内层电子或高能电子，这种激发得到的分子高能态很不稳定，在常温下的水溶液或空气中都难以保证信息的有效传递。也被排除。

波长较长的红外（Infrared）与微波（Microwave）频段的电磁波主要与分子的振动、转动和平动相耦合，而这些运动主要以随机热运动形式存在，很难实现信息的准确表达。

波长更长的中波、长波（Radio）的运动尺度超过了单个分子能够接收的尺度，更不适合以细胞为基础的生物选择。

这样考察的结果，如果细胞一定要采取分子层面上的光敏机制对电磁波进行响应，那么最合适的波段可能就是现在的可见光波段。**这一波段在分子运动中相当于电子光谱的外层电子激发能量，与分子中化学键的能量高低大致相当而略低，既不至于损伤一般较为稳定的化学键（尤其是作为生命体基础的 C-C、C-H、C=O、C-N 等化学键），又可以使得一些 “动态” 化学键（例如视黄醛中具有顺反异构的 11 位双键）发生光响应，并实现信息的有效传递。**

所以，人类感知当前波段的可见光，是亿万年不断进化的结果。换个角度说，感知其它波段的人类祖先已经被淘汰了，他们的基因无法遗传传承下来。

可谓：**物竞天择，适者生存**。

## 4 光的来源

众所皆知，光是电磁波，而物质是由原子组成，原子是由原子核与核外运转着的电子组成。那么，物质原子中的电磁波是哪里来的？电磁波难道会无中生有？

奥斯特实验发现了直流导线的周围产生磁场，因为电子的运动伴生着磁场。电子的运动分为**线性运动**和**振动**：

*   **线性运动**：电子的线性运动是核外电子的绕核运动及在导电时电子的流动，它所伴生电磁波的宏观表现是**磁场**。电子的线性运动不是产生光的原因。
*   **振动**：电子的振动与发光息息相关，它会使电磁脱离场源形成电磁波，也就是产生了光，而不是所谓的光子。引起电子振动有两种原因：
    *   一是高温物质核外电子的跃迁引发的振动，这种振动需要物质的温度大大高于环境温度，运转速率很高的核外电子跃迁辐射才能达到可见光的频率。这种高温物质核外电子的跃迁辐射所形成发光的光源叫**热光源**。岩浆、铁水、火焰、灯丝等高温物质的发光属于热光源。
    *   二是电子在磁场或电场的作用下引发的受激振动，这样的电子振动与温度无关、与核外电子运转速率无关。这种不需要高温而使电子振动所形成辐射的光源叫**冷光源**。日光灯、节能灯、极光、萤火虫的发光、半导体发光（LED）等属于冷光源。

本小节开头的问题有了答案：光源中的光来自于电子的振动，电子振动所伴生的电磁波辐射形成了光波，电子振动的频率构成了光波的频率，大量电子振动所伴生的电磁波辐射形成了光源。

## 5 光的理论

光的研究和理论经过数百年的发展，至今出了很多理论学说，每种理论都是为了解释部分光的物理现象。

目前，光存在的理论主要有：粒子理论、波动理论、电磁理论、量子理论及波粒二象性等。

### 光的粒子理论 (Particle theory)

光的粒子说又称光的微粒说，这种理论认为光的本质与通过它反射而可见的实体物质一样，是一种粒子（下图）。  

![[1679148478775.png]]

  
_光的粒子性示意图_

法国数学家皮埃尔 · 加森迪（Pierre Gassendi）于 1660 年提出了一种光的粒子理论。 Isaac Newton 在 Gassendi 的理论基础上做了扩展：光是由来自各个方向或从各个方向发射的微粒（物质粒子）组成的。

牛顿随后对于加森迪的这种观点进行研究，他根据光的直线传播规律、光的偏振现象，最终于 1675 年提出假设，认为光是从光源发出的一种物质微粒，在均匀媒质中以一定的速度传播。

微粒说很容易解释光的直进性，也很容易解释光的反射，因为粒子与光滑平面发生碰撞的反射定律与光的反射定律相同。

然而微粒说在解释一束光射到两种介质分界面处会同时发生反射和折射，以及几束光交叉相遇后彼此毫不妨碍的继续向前传播等现象时，却发生了很大困难。

### 2 光的波动理论 (Wave theory)

在 1660 年代，胡克（Robert Hooke）发表了他的光波动理论。他认为光线在一个名为光以太（Luminiferous ether）的介质中以波的形式四射，并且由于波并不受重力影响，光在进入高密度介质时会减速。

光的波理论预言了干涉现象以及光的偏振性。

欧拉是波动学说的支持者之一，他认为波理论更容易解释衍射现象。

菲涅耳也支持并独立完成了他的波动理论。在 1821 年，菲涅尔使用数学方法使光的偏振在波动理论上得到了唯一解释。  

![[1679148478828.png]]

  
_上图：光的偏振现象，回旋光波先后经过四分一波偏振板和线性偏振板的情形。_

但是，波动理论的弱点在于，波类似于声波，传播需要介质。虽然曾有过光以太介质的假想，但因为 19 世纪迈克耳孙 - 莫雷实验陷入了强烈的质疑。

牛顿推测光速在高密度下变高，惠更斯和其他人觉得正相反，但当时并没有准确测量光速的条件。直到 1850 年，莱昂 · 傅科（Léon Foucault）的实验得到了和波动理论同样的结果。之后，经典粒子理论才真正被抛弃。

### 3光的电磁理论 (Electromagnetic theory)

光的电磁理论是关于光的本性的一种现代学说，19 世纪 60 年代由麦克斯韦提出。把光看成是频率在某一范围的电磁波。能解释光的传播、干涉、衍射、散射、偏振等现象，以及光与物质相互作用的规律。

电磁理论还认为，电磁波具有互相垂直的电场与磁场，电场与磁场的频率、振幅、波长、传播方向是一致的。  

![[1679148478925.png]]

但由于光还具有粒子性，所以它不能解释光电效应、康普顿效应等物理现象。

### 4 光的量子理论 (Quantum theory)

光的量子理论是以辐射的量子理论研究光的产生、传输、检测及光与物质相互作用的学科。  

![[1679148478962.png]]

  
_量子光学示意图_

1900 年，普朗克在研究黑体辐射时，为了从理论上推导出得到的与实际相符甚好的经验公式，他大胆地提出了与经典概念迥然不同的假设，即 “组成黑体的振子的能量不能连续变化，只能取一份份的分立值”。

1905 年，爱因斯坦在研究光电效应时推广了普朗克的上述量子论，进而提出了光子的概念。他认为光能并不像电磁波理论所描述的那样分布在波阵面上，而是集中在所谓光子的微粒上。在光电效应中，当光子照射到金属表面时，一次为金属中的电子全部吸收，而无需电磁理论所预计的那种累积能量的时间，电子把这能量的一部分用于克服金属表面对它的吸力即作逸出功，余下的就变成电子离开金属表面后的动能。

1923 年，亚瑟 · 霍利康普顿表明，当从电子散射的低强度 X 射线（所谓的康普顿散射）中看到的波长漂移可以通过 X 射线的粒子理论来解释，而不是波动理论。

1926 年 Gilbert N. Lewis 将这些光量子粒子命名为**光子**。

2018 年 2 月，科学家首次报道了一种可能涉及极化子的新型光的发现，这可能对量子计算机的发展有用。

量子力学作为一门 “很数学” 化的物理体系，已经像经典力学那样成熟了，并成为洞悉微观世界的重要工具。

但量子力学也给留下了许多物理上的困惑，如粒子运动的波粒二象性问题、几率波问题、粒子纠缠问题、波函数崩塌问题等等。

### 5 光的波粒二象性 (Wave-particle duality)

历史上关于光是粒子还是波动的争论，已有两千多年（下图）。  

![[1679148478986.png]]

光的种种现象和性质表明它既有粒子的特征又有波动的特征，处于两个派别立场的研究者各执一词，互不相让。

直到 1905 年，爱因斯坦在德国《物理年报》上发表了题为《关于光的产生和转化的一个推测性观点》的论文。他认为对于时间的平均值，光表现为波动；对于时间的瞬间值，光表现为粒子性。这是历史上第一次揭示微观客体波动性和粒子性的统一，即**波粒二象性**。这一科学理论最终得到了学术界的广泛接受。

在新的事实与理论面前，光的波动说与粒子说之争以 “光具有波粒二象性” 而落下了帷幕。

即：**光粒子的运动轨迹是呈周期性的波**。

Wikipedia 提供了[一个视频](https://upload.wikimedia.org/wikipedia/commons/transcoded/e/e4/Wave-particle_duality.ogv/Wave-particle_duality.ogv.720p.webm)，形象地描述了光在各种理论下的特征。

## 6 光的能量

光是能量的一种传播方式。光能量也被称为光子能量（按粒子性）或电磁辐射（按波动性）。每个光子都具有一定量的能量，频率越高，能量也越高。

光的度量跟能量或辐射测量类似，常被用于太阳能、加热、照明、电信、计算机图形学等领域。

光能量作为能量，可被测量，单位是焦耳（J）。可以通过将辐射通量（或功率）相对于时间、面积、空间积分来计算辐射能量的量。

测量辐射能量的概念和符号非常多，[完整的表](https://en.wikipedia.org/wiki/Radiant_energy)有数十个

# 3 光学原理（Optics theory）

**光学**（Optics）是物理学的一个分支，研究光的行为和性质，包括它与物质的相互作用以及使用或检测它的仪器的结构。

光学通常描述可见光、紫外光和红外光的行为。由于光是电磁波，其它波段的电磁辐射（如 X 射线、微波和无线电波）表现出类似的特性。

光学按照不同角度、不同粒度和不同侧重点大致可以分为以下几类：

*   **电磁光学**。将光分为大多数光学现象可以使用光的经典电磁描述来解释。然而，光的完整电磁描述通常难以应用于实践中，需要借助其它光学类型。
*   **几何光学**。几何光学系统将光线视为一组光线，它们以直线传播，并在通过或从表面反射时弯曲。是物理应用中简化的一种模型。由于 PBR 的 BRDF 几乎都是基于几何光学，后面章节会侧重地介绍几何光学。
*   **物理光学**。物理光学是一种更全面的光模型，包括衍射和干涉等波效应几何光学中无法解释的。历史上，首先开发基于射线的光模型，然后是波的光模型。19 世纪电磁理论的进步才发现光波实际上是电磁辐射。
*   **运动物理光学**。主要研究天体运动的光速差、光漂移、多普勒效应等。当前已经发展成一支庞大的独立的物理分支。
*   **量子光学**。一些现象取决于光具有波状和粒子状特性的事实。这些效应的解释需要量子力学。当考虑光的粒子特性时，光被建模为称为 “光子” 的粒子集合。量子光学涉及量子力学在光学系统中的应用。

光学与许多相关学科联合进行研究，包括天文学、工程领域、摄影、计算机和医学等等。光学的应用存在于各种日常物品中，包括镜子、透镜、望远镜、显微镜、激光器和光纤等等。

##  光的反射（Reflection）

光的反射是当光在两种物质分界面上改变传播方向又返回原来物质中的现象。  

![[1679148479241.png]]

  
_上图：光的反射现象。_

产生反射的原理：光是电磁波，射在物体上的光波引起单个原子中的极化振荡（或电子在金属中的振荡），致使每个粒子在各个方向上辐射小的二次波，如偶极天线（ dipole antenna）。根据惠更斯 - 菲涅耳原理，所有这些波加起来就产生反射和折射。

光的反射细分为以下几种：

*   **镜面反射**（Specular reflection）：平行光线射到光滑表面上时反射光线也是平行的现象。表面平滑的物体，易形成光的镜面反射，形成刺目的强光，反而看不清楚物体。
*   **漫反射**（Diffuse reflection）：平行光线射到凹凸不平的表面上，反射光线射向各个方向的现象。
*   **方向反射**（Directional reflection）：是介于漫反射和镜面反射之间反射，也称非朗伯反射。其表现为各向都有反射，且各向反射强度不均一。
*   **回射**（Retroreflection）：入射光射在介质表面上，反射光的方向与入射光一致的现象。飞机在飞越被阳光照射的云层时，在飞机阴影周围看到的区域将显得更亮，从草地上的露水可以看到类似的效果。

## 光的折射（Refraction）

光的折射是指光从一种介质斜射入另一种介质时，传播方向发生改变，从而使光线在不同介交界处发生的偏折。  

![[1679148479282.png]]

  
_上图：光的折射现象。_

折射的原理与反射类似：光波是一种特定频段的电磁波，光在传播过程中有两个垂直于传播方向的分量：电场分量和磁场分量。当电场分量与介质中的原子发生相互作用，引起电子极化，形成电子云和原子荷重心发生相对位移。导致光的一部分能量被吸收，同时光在介质中的速度被减慢，方向发生变化，引发了折射。  

![[1679148479351.png]]

  
_上图：光从一种物质进入另一种物质后发生了折射，波长、方向、速率都发生了改变。_

近代物理学指出，光是一种没有静质量、体积非常小、运动速度比较高的物质。光和其它物质有相同的性质。光和物质间的相互作用力使光的运动方向发生改变即折射。

##  光的散射（Scattering）

光通过不均匀媒质时，部分光束将偏离原来方向而分散传播，从侧向也可以看到光的现象。

散射发生的原理：当光子与分子或原子相互接近时，由于双方具有很强的相互斥力，迫使它们在接触前就偏离了原来的运动方向而分开。

散射是观察和辨别物体的主要现象，是自然中最普遍存在的现象。漫反射其实也是散射的一种。

## 光的色散（Dispersion）

光的色散指的是复色光分解为单色光的现象。  

![[1679148479609.png]]

色散现象说明光在介质中的速度 $v=\frac{c}{n}$（$n$为介质的折射率）随光的频率 $f$而变。光的色散可以用三棱镜、衍射光栅、干涉仪等来实现。

光的色散说明了光具有波动性。因为色散是光的成分（不同色光）折射率不同引起的，而折射率由波的频率决定。

对同一种介质，光的频率越高，介质对这种光的折射率就越大。在可见光中，紫光的频率最高，红光频率最小。当白光通过三棱镜时，棱镜对紫光的折射率最大，光通过棱镜后，紫光的偏折程度最大，红光偏折程度最小。这样，三棱镜将不同频率的光分开，就产生了光的色散。

**为什么在同一介质中，不同波长的光，其速度和折射率会不同呢？**

由于光有粒子性，与介质的原子、分子有相互作用力。对于波长越短的光，其携带的能量越大、运动越强，与介质的原子、分子的相互作用力越大，致使其速度越小、折射率越大。_（这个回答是笔者根据经典物理学结合波动论的推测，未找到确切的依据和论据，有待考证！）_

##  光的吸收（Absorption）

电磁理论认为，光的吸收是光 (电磁辐射) 通过材料时，与材料发生相互作用，电磁辐射能量被部分地转化为其他能量形式的物理过程。

当被吸收的光能量以热能的形式被释放，即形成了光热转化；当未被吸收的光能量被物体反射、散射或透射，便影响着我们看到的物体的色彩。

量子理论认为，光的吸收是指分子或原子在光波辐射场（光照）下，会吸收光子的能量由低能态跃迁到高能态的现象。这种跃迁也等效于一个具有一定固有频率的振子。

电磁理论证明，当物体对某种频率光的吸收系数很大时，它对该频率光的反射率也大。若干电介质具有很强的吸收带，故它们对于吸收带附近频率的光也有很强的反射，这称为**选择反射**。

半导体材料在不同的程度上具备电介质和金属材料的全部光学特性。当半导体材料从外界以某种形式（如光、电等）吸收能量，则其电子将从基态被激发到激发态，即光吸收。而处于激发态的电子会自发或受激再从激发态跃迁到基态，并将吸收的能量以光的形式辐射出来（辐射复合），即发光；当然也可以无辐射的形式如发热将吸收的能量发散出来（无辐射复合）

金属的光吸收要同时考虑束缚电子与自由电子的作用。对于红外线或更低频率的辐射，自由电子起主要作用；而对于紫外线及更高频率的辐射，则束缚电子的作用比较显著，这时金属实际上表现出与电介质相似的光学性质。

##  光的衍射（Diffraction）

衍射是指当光波遇到障碍物或狭缝时发生的各种现象。它被定义为围绕障碍物或孔的角落的波浪弯曲到障碍物的几何阴影区域中。

由于光具有波动性，所以也会产生衍射。  

![[1679148479671.png]]

  
_光波穿过单波长的缝隙后发生了衍射现象。_

当光波穿过具有变化的折射率的介质时，也会发生衍射的效果。所有波都会发生衍射，包括声波、水波和电磁波（可见光、X 射线和无线电波）。

光的衍射产生的原理可以从两方面解释：

*   波动光学：根据惠更斯 - 菲涅耳原理和波叠加原理，衍射是由于波传播的方式而产生的。通过将波前传输介质的每个粒子视为二次球面波的点源，可以可视化波的传播，任何后续点的波位移是这些二次波的总和。当这些波被加在一起时，它们的总和由相对相位以及各个波的幅度确定，使得波的总和幅度可以具有零和各个幅度之和之间的任何值
*   量子光学：在通过狭缝传播光时，每个光子具有波函数，波函数描述了从发射器通过狭缝到屏幕的路径。波函数（光子将采取的路径）由物理环境决定，例如狭缝形状、屏幕距离和光子创建时的初始条件。

##  光的叠加和干涉（Superposition and interference）

若干个光波组合在一起形成的复合效果便是光的叠加。

更准确地说，在没有非线性效应的情况下，叠加原理可用于通过简单地添加干涉来预测相互作用波形的形状。产生光波的复合图案的相互作用通常被称为干涉，干涉可能导致不同的结果。  

![[1679148479725.png]]

  
_光波在不同相位产生的叠加效果。_

光产生叠加和干涉现象的原理与衍射类型，便不再累述。

## 光的偏振（Polarization）

偏振是波的一般属性，描述了它们的振荡方向。由于光具有波动性，所以也会偏振。

偏振为横向波（如许多电磁波）描述了垂直于行进波方向的平面中的振荡方向。振荡可以在单个方向上（线性偏振），或者随着波行进方向而旋转（圆形或椭圆形偏振）。  

![[1679148479961.png]]

  
_左：线性偏振；中：圆形偏振；右：椭圆偏振。_

# 4 几何光学（Geometry optics）

**几何光学**是将光的波长视作无限小，以致可以将光当成直线来研究的一门物理分支。它以光线为基础，研究光的传播和成像规律。

在几何光学中，把组成物体的物点看作是几何点，把它所发出的光束看作是无数几何光线的集合，光线的方向代表光能的传播方向。

**几何光学中光线的概念与光的波动性质相违背**。因为从能量和光的波动性现象（如衍射）来看，这种几何光线都是不可能存在的。**几何光学只是波动光学的近似**，把所有光当成波长极小的情况处理，小到光线被当成了直线。但是，**简化后的几何光学可以不涉及光的物理本性，而能以其简便的方法解决光学仪器中的光学技术问题和计算机图形渲染的复杂度问题。**

在几何光学中，特别是在计算机图形学中，光线处理做了以下简化或遵循以下基本定律：

*   **直线传播**：光在均匀介质中沿直线传播。直线意味着将光波长视作极小。
*   **独立传播**：两束光在传播途中相遇时互不干扰，仍按各自的途径继续传播。而当两束光会聚于同一点时，在该点上的光能量是简单的相加。
*   **反射和折射**：光在传播途中遇到两种不同介质的光滑分界面时，一部分光线反射，它们的传播方向遵循反射定律；另外另一部分折射，它们的传播方向遵循折射定律。
*   **路径可逆性**：一束光线从一点出发经过无论多少次反射和折射，如在最后遇到与光束成直角的界面反射，光束必然准确地循原路返回出发点。
*   **介质各向同性**：将光线传播的介质简化成均匀的，即各向同性（isotropic）。所谓各向同性是指介质任意一点的所有方向的物理性质（如密度、弹性、摩擦系数等等）和化学性质是一样的。
*   **分界面简化**：将光线经过两个介质的分界面处的点当做平面上的点处理。
*   **单色光源**：真实的发光源基本是复合色光源，但在几何光学中，简化成了单色光，避开色散、傅里叶积分、能量积分等复杂问题。
*   **麦克斯韦方程的特化**：由于很多参数作了特例化和简化，所以几何光学的光照计算实际上使用的是麦克斯韦方程简化和特化后的版本。

由于 PBR 的相关技术及诸多理论跟几何光学相关，所以本节将深入地探讨几何光学的内容。

### 反射定律（Law of Reflection）

反射定律描述了反射光的角度：入射光的角度与反射光的角度相同。  

![[1679148480248.png]]

如上图所示，入射光线 P 射在介质点 O 上，反射光线是 Q，点 O 的法线是 normal，则根据反射定律：

$$\theta_i = \theta_r$$

即入射角$\theta_i$和反射角$\theta_r$相同。它们的另外一种等效表达形式：

$$\theta_r = \pi - \theta_i$$

需要注意的是，反射定律描述的是反射角问题，并不涉及能量分配。

反射还涉及到反射率的问题。**反射率**是反射波的功率与入射波的功率之比。每种材料的反射率不一样，并且跟入射光与介质的夹角有关，这种现象叫**菲涅尔反射效应**，与之相关的方程是[菲涅尔方程（Fresnel equations）](https://en.wikipedia.org/wiki/Fresnel_equations)。  

![[1679148480311.png]]

  
_上图：菲涅尔反射效应，球体的反射率从中心到边缘以某种曲线提升。_

实际上，当光照射到介质表面时，光可能产生的结果：

*   被吸收：部分光被介质吸收，转化其它形式的能力。
*   被折射：部分折射的光如果透过介质进入另外的介质，就会形成透射效果。
*   被反射：部分光被反射，其中反射分成了镜面反射和漫反射。

### 折射定律（Law of Refraction）

**折射定律**也叫**斯涅尔定律**（Snell's law，Snell–Descartes law），描述了光在两种介质之间折射后的角度、折射率、光速的关系。  

![[1679148480364.png]]

  
_上图：折射定律动画示意图。_

![[1679148480438.png]]

  
如上图所示，光在介质之间发生了折射，介质 1 的入射角、折射率和光速分别是$\theta_1$、$n_1$、$v_1$，介质 2 的入射角、折射率和光速分别是$\theta_2$、$n_2$、$v_2$，则根据折射定律，它们有以下的关系：

$$\frac{\text{sin}\theta_2}{\text{sin}\theta_1} = \frac{v_2}{v_1} = \frac{n_2}{n_1}$$

用折射定律会出现一种**异常**情况：当光从较**高折射率**的介质传播到较**低折射率**的介质时，在入射角足够大的情况下，折射定律似乎要求折射角的正弦大于 1。

这当然是不可能的。实际上，在这种情况下，光线完全被边界反射，这种现象称为**全内反射（Total internal reflection）**。仍能导致折射的最大入射角称为**临界角**，此时折射角是 $90^\circ$。

![[1679148480491.png]]

如上图所示，光线从较高折射率的水射到较低折射率的空气中，当入射角大于临界角时，会出现图右的全内反射。

其中，临界角$\theta_\text{crit}$可由折射定律推导出来：

$$\theta_\text{crit} = \text{arcsin} \left( \frac{n_2}{n_1}\text{sin}\theta_2 \right)$$



### 几何光学的其它定律

在几何光学中，除了反射定律和折射定律之外，还有以下定律：

*   拉格朗日积分不变式。
*   费马原理。
*   马吕斯和杜平定律。

由于这些定律跟 PBR 技术关联不大，本文不详述，有兴趣的可以另外找资料。

# 5 物质属性

物质的属性有很多，从不同角度有不同的属性，但常见的物理和化学属性有：体积、尺寸、质量、密度、硬度、导电性、导磁性、磁性、范性（可塑性）、透光性（透明度）、比热容、弹性、可燃性、助燃性、酸碱性等等。

下面只阐述跟 PBR 相关的物质属性。

## 导电性

**导电性**是指物质内载电荷粒子的运动。含有电荷的粒子称为**电荷载子**，它们的运动形成了**电流**。

电流产生的原因有两种：

*   受到电场的作用。
*   电荷载子分布不均匀引发的扩散机制。

根据导电性，可以将物质分为：

*   **绝缘体**：也称电介质，常见的绝缘体包含干燥的木材、塑料、橡胶、纸张等。
*   **半导体**：处于导体和绝缘体之间，半导体的电传导是由电场作用和扩散这两种物理机制共同引发。常见的半导体有硅、锗、砷化镓等。
*   **导体**：导电性强，常见的导体有金属、电解质、液体等。
*   **超导体**：导电性非常强，没有电阻，通常在绝对零度左右的极限条件下才能出现。

## 粗糙度

**粗糙度**是反映物质微观表面的轮廓紊乱的程度。

根据粗糙程度可以将物体分成以下几类：

*   **光滑物体**：粗糙度非常小，几乎为 0，摩擦系数很小；微观表面轮廓几乎是一条直线，易产生镜面反射。
*   **半光滑物体**：粗糙度较小，摩擦系数较小；微观表面轮廓是较平整，产生介于镜面和漫反射之间的反射。
*   **粗糙物体**：粗糙度很大，接近 1.0，摩擦系数很大；微观表面轮廓非常不平坦，产生漫反射。

![[1679148480615.png]]

  
有很多估算物体粗糙度的方法：

![[1679148480644.png]]

*   $R_a$：算术平均偏差法，公式：

$$R_a = \frac{1}{n}\sum_{i=1}^n|y_i|$$

*   $R_q$：均方根法，公式：

$$R_q = \sqrt{\frac{1}{n}\sum_{i=1}^n y_i^2}$$

*   $R_{sk}$：偏态分布法，公式：

$$R_{sk} = \frac{1}{nR_{q^3}}\sum_{i=1}^n y_i^3$$

*   $R_{ku}$：峰态法，公式：

$$R_{ku} = \frac{1}{nR_{q^4}}\sum_{i=1}^n y_i^4$$

还有 $R_zDIN$、$R_zJIS$法，但最常用的是 $R_a$。

##  透光性

**透光性**亦即透明度，描述物质透过光线的程度。

物体的透光性主要取决于物质内部结构对外来光子的吸收和散射。

金属物质在可见光波段的电子轨道密集（有能带），能强烈地吸收对应能量的光子并发射（相同能量或较小能量的）光子，即其表面可以强烈地反射光，是不透明的。

物质内部对光的散射，主要取决于其内部缺陷的多少，缺陷多的物质，散射率高。普通陶瓷材料，其内部充斥着大量的微气孔等缺陷，气孔会对经过的光产生强烈的散射，所以普通陶瓷是不透明的；而气孔率保持极低的陶瓷材料是可以像玻璃一样透明的。单晶体（如天然水晶）和液体（如水）由于内部排列规则，缺陷极少，是透明的。

##  各向性

各向性是描述物质任意一点的物理和化学等属性跟方向是否相关，如果与方向无关叫**各向同性（isortropy）**，否则叫**各向异性（anisortropy）**。

比如清澈平静的水是各向同性，因为水的每个部分的属性（密度、压力、温度、折射率质量等等）都与方向无关；而飘忽不定的烟或雾则是各向异性，很明显同个部位不同方向有着不一样的密度或外力。

在计算机图形学，特别是实时渲染领域，通常将物体简化成均匀的，即各向同性的。几何光学也通常将光线传播的介质看成各向同性。

# 6 能量理论

##  能量是什么？

**能量**是必须转移到物体以便对物体进行影响或加热的定量属性。能量是物质运动转换的量度，是表征物理系统做功本领的量度。

能量的单位与功的单位相同，在国际单位制中是焦耳（J）；在微观研究领域，常用电子伏（eV）作为单位。

## 能量类型

能量存在的形式多种多样，在不同学科不同分支不同角度有着不同的类别，主要有：

*   **机械能**：物体运动（平移、旋转）宏观的能量（动能、势能）的总和。
*   **电能**：由电场引起或存储的势能。
*   **磁能**：由磁场引起或存储的势能。
*   **重力势能**：由重力场引起或存储的势能。
*   **化学能**：由化学键引起的势能。
*   **电离能**：由电子与其原子或分子结合引起的势能。
*   **核能**：结合原子形成原子核和核反应的势能。
*   **胶子结合能**：结合夸克形成强子的势能。
*   **弹性能**：由于材料（或其容器）的变形而出现恢复力的势能。
*   **机械波能**：由于机械波的传播引发的弹性材料中的动能和势能。
*   **声波能**：声波是机械波的一种。
*   **辐射能**：存储在电磁辐射传播的场中的势能，包括光。
*   **静止能**：由物体的静止质量引发的势能。
*   **热能**：粒子微观运动的动能，是一种无序等效的机械能。

##  能量转化

能量的类型多钟多样，而且它们之间是可以相互转化的。

能量的转化在生活中随处可见。比如，“利用太阳能发的电煮开了水，水蒸气一直往上冒”，蕴含了很多能量转化的过程：

*   太阳内部的核能通过核反应转变成太阳光的辐射能；
*   太阳发电站的太阳板吸收辐射能形成了电能；
*   利用煮水电器将电能转化成了水的热能；
*   水蒸气向上冒的过程转化成了重力势能。

## 质能等值

爱因斯坦在二十世纪初提出了著名的质能转化公式：

$$E = Pc = mc\cdot c = mc^2$$

其中 $E$是能量，$m$是物质的静止质量，$c$是真空的光速，约 $3\times10^8m/s$。

质能等值公式揭示了任意有静止质量的物质都可以转化成能量，而且很少一部分的物质转成能量后是非常巨量的。

比如，1kg 的物质转成能量后：

$$E_{1kg} \approx 1.0 \times (3\times10^8)^2 = 9\times10^{16} J$$

其能量相当于：

*   250 亿千瓦时（$2000GW\cdot h$）；
*   三峡水电站（全球发电量最大）一整个季度的发电量；
*   21.5 万亿千卡（$21Pcal$）；
*   21 万吨 TNT；
*   26.3 亿升汽油。

由此可见，物质转化成能量后，是非常恐怖的。一块小石头，足以毁掉一个小星球。

幸好，目前尚没有很便捷地将物质转化成能量的方法。然而，虽然核爆（原子弹、中子弹、氢弹）不是利用质能转化定理，但是核能表现出的威力已经足够令人望而生畏了。

## 能量守恒 (Conservation of energy)

传统物理学上，**能量守恒定律**表明在封闭的系统中，能量不会凭空出现或消失，只会从一种形式转成另外一种形式，能量的总量保持不变。

现代物理学上，由于质量和能量可以相互转化，能量守恒扩展到能量和质量的总和保持不变。

诺埃德定理（Noether's theorem）可以严格证明能量守恒，它也表明了永动机是不可行的。

![[1679148481033.png]]

比如，上图所示，光线照到物质表面上时，光能可能一部分被镜面反射（黄色），一部分被散射（深蓝色），一部分被吸收（褐色），还有一部分被透射（图中未标识）。与之对应的能量分别是反射部分依旧是光能，吸收部分转化成热能、电能等形式，透射部分依旧还是光能，并且：

$$E_{in} = E_{specular} + E_{diffuse} + E_{absorb} + E_{transmit}$$

亦即入射光能与反射（包含镜面反射和散射）、吸收、透射部分的总光能相等，遵循了能量守恒定律。

PBR 的 BRDF 也遵循了这一守恒定律，引入粗糙度、反射率等概念，使得原理上更加物理正确，渲染效果上更加真实。

# 7 PBR 与光学

本节将阐述本章前几节涉及的光学理论与 PBR 结合的理论，特别是物质和光的交互原理及理论。主要参考了 **Naty Hoffman** 在 2013~2015 年（特别是 2015 年）的 SIGGRAPH 公开课中演讲的主题：**《Physics and Math of Shading》**。

##  光谱能量分布（SPD）

回顾一下 [[Electromagnetic theory)](#4.2.5.3 光的电磁理论(Electromagnetic theory|4.2.5.3 光的电磁理论(Electromagnetic theory)]]) 描述的电磁理论：

光是电磁波，在介质中作为能量以特定波长（Wavelength）和频率振荡着向前方传播。电磁波可被分解成电场（Electric）和磁场（Magnetic），并且它们相互垂直（如下图）。

![[1679148481071.png]]

人类可见的光波波长分布在 400nm~780nm 之间，可见光的波长跟蜘蛛丝宽度相仿，但远小于人类头发丝的宽度（下图）。

![[1679148481121.png]]

_上图：可见光波长（图左）与蜘蛛丝（图右斜灰线）、人类头发丝（图右黄色区域）宽度比较。_

实际上，绝大多数光包含了很多个波段的电磁场，每个波段的电磁场包含了不同的能量。比如下图的位于 500~550nm 波段的电磁波，在左上角的**光谱能量分布（Spectral Power Distribution，SPD）**中显示出了绿色光的能量。激光可以发出单色的光。

![[1679148481171.png]]

下图左 R、G、B 的光谱能量分布乘以各自的缩放因子，将它们的结果相加之后就成了下图右的摸样。

![[1679148481224.png]]

这个原理与已投入影院使用的 R、G、B 激光投影系统类似。

上图所示的是能量分布图，如果将它们用波形图表示，会显得更加复杂，因为涉及到光的叠加和干涉，见下图：

![[1679148481270.png]]

但是，由于大多数光源都不是单一波长的光波，而是有一定宽度的连续的复合光波，于是它们的最终叠加的波形更加复杂。举个例子，以标准白光光源 D65 为例，它的光谱能量分布图和复合波形如下：

![[1679148481319.png]]

有趣的是，下图的两种 SPD 虽然不一样（上部分是连续的分布，下部分是离散的 RGB 分布），但是刚好跟人类视觉成像原理（详见 [[#4.2.3 人眼感知可见光原理|4.2.3 人眼感知可见光原理]]）匹配，所以人类并没有发现它们之间的差别。也就是说，人类的视觉是有损的，将无限维度的 SPD 简化成了三维视觉空间。

![[1679148481353.png]]

###  物质与光交互

在纳米级别，当一束电磁光波和原子或分子相遇后，会发生什么呢？

![[1679148481398.png]]

答案是，光波会引发原子、分子偏振，并且使它们的正负电荷分离，形成偶极子（dipole）。这就意味着进入的光波被吸收了。

![[1679148481430.png]]

吸收了能量并且极化后的原子、分子会迅速恢复，重新向外辐射，形成二次光波。当然被吸收的部分能量可能转化成了热运动，即热能。

![[1679148481454.png]]

对均匀介质（Homogeneous Medium）来说，光线是沿着直线传播。由于所有物质在原子维度上看是不可能完全均匀的，所以均匀介质是在实践中抽象出来的概念。

在渲染技术中，会使用宏观的统计和组合为材质提供参数。这个参数就是**折射率（Index of refraction，IOR）**，它由两个部分组成：

*   一部分描述光在介质中的速率。
*   另外一部分描述光在介质被吸收的比例。

对于介质中局部不均匀的部分将被建模成粒子（原子核等），折射率不连续的物质会散射入射光，散射出的光方向向着四面八方。

![[1679148481498.png]]

虽然这跟前面讨论的单一分子或原子的极化类似，但可以将这些微粒组合起来，形成宏观模型。

下图是吸收系数和散射系数组合成的宏观维度的材质表现图。

![[1679148481523.png]]

**横轴**是**散射**系数，从左到右可以看出物质从清澈到混浊的程度；**纵轴**是**吸收**系数，从下到上表示物质从透明（光被全透射而表现出跟入射光几乎一样的颜色）到不透明（光被全吸收而表现出与入射光不一样的颜色）的程度。比如牛奶，它是吸收系数低而散射系数高的物质，所以它表现出入射光一致的白色，并且是混浊的。有色液体能很轻易吸某些波段的光，而其它波段的就没那么容易。

从光学角度上看，最重要的事情是所有材质的表面都是粗糙的。没有表面是完全平坦的，至少在原子维度上是不规则的。原子间排布距离如果跟光波差不多或更小，就会引起一种现象，它就是之前章节涉及过的**衍射**。

**惠根斯 - 菲涅尔原理（Huygens-Fresnel Principle）**可以解释这个现象。当光波遇到跟它波长相仿的障碍时，会 “绕弯” 传播，绕到了障碍后面：

![[1679148481572.png]]

在纳米维度，当光波传播到光学平坦的表面时，惠根斯 - 菲涅尔原理同样适用。当与入射光碰撞后，每个粒子都会发射球面波，有些强有些弱。这些不平行的球面波结合起来，就会形成复杂的波形，在很多方向发射不一样的光：

![[1679148481612.png]]

纳米几何体（Namogeometry）越小，越少光波被衍射。入射光与单个原子碰撞后，少部分会被衍射。

现在聊回几何和射线光学，它们都是更简化的并且广泛应用于计算机图形领域。其中一种简化方法是忽略纳米级别的不规则和衍射，将光学平坦的表面当成完全平坦。由此可以应用几何光学的反射和折射定律。

很多材质表面看起来是平滑的，但实际并非如此，对于微观几何体（Microgeometry），它们一样凹凸不平：

![[1679148481843.png]]

上图的上部分由于物体更加平滑，所以在微观的表面看起来更加规则，反射的光也相对规则，宏观表现就是被反射的光更加清晰，反射的画面更容易表达出被反射物体的轮廓；而下部分由于微观更加不规则，反射的光线取向更紊乱，所以宏观表现就是高光变模糊了，被反射的物体看不清楚。

**对于折射进入介质的光，会发生什么呢？**

对这个问题，需要对物质的导电性进行分类，然后分开探讨：

*   **导体（Conductor）**：导体是金属、电解质等导电性强的物质，由于它们的微粒组合特性，会立即吸收折射光形成热运动。
    
    ![[1679148481889.png]]
    
*   **绝缘体（Dielectric）**：即电介质，指没有导电性的物质。如前面章节描述的一样，折射光进入除了透明的电介质后，小部分被吸收，相当一部分在介质内部被多次散射并重新射出表面形成漫反射。
    
    ![[1679148481927.png]]
    
    重新被散射出介质表面的光线形成了不同的散射距离。散射距离的分布取决于散射微粒的密度和属性。
    
    ![[1679148482178.png]]
    
    如下图所示，如果像素尺寸（绿色标识区域）大于散射距离（黄色线段），就可以无视次表面散射效果。
    
    ![[1679148482435.png]]
    
    由于忽略次表面散射的效果，所以入射光附近的区域可以当成一个点来处理（下图），采用经典的关照计算方式，比如 Lambert 或 Phong 光照模型。
    
    ![[1679148482457.png]]
    
    当成单点处理后，便可以将光照分成两个部分：镜面反射和漫反射（包含了折射、吸收、散射和重新折射回表面的光），见下图：
    
    ![[1679148482521.png]]
    
    对于下图中所示的，散射范围（黄色线段）大于像素尺寸（绿色小圆区域），就不能采用上面的简化模型，而需要采取次表面散射（Subsurface scattering）渲染技术。
    
    ![[1679148482560.png]]
    
*   **半导体（Semiconductor）**：由于半导体与光交互的特性介于金属和非金属之间，在实际渲染中，常用迪尼斯原则的金属度系数来模拟半导体特性。
    
# 7 公式推导

##  麦克斯韦方程组（Maxwell's equations）

既然光的很多现象，包括反射、折射定律都可以用麦克斯韦方程组解释，那我们就有必要揭开它的神秘面纱。

**麦克斯韦方程组**是描述了电场、磁场与电荷密度、电流密度之间关系的偏微分方程。利用麦克斯韦方程组，可以推论出电磁波在真空中以光速传播，并进而做出光是电磁波的猜想。

实际上，麦克斯韦方程组虽然由英国物理数学家詹姆斯 · 克拉克 · 麦克斯韦（James Clerk Maxwell）提出，但最初提出来时有 20 个方程和 20 个变量。后来由英国物理学家奥利弗 · 赫维赛德（Oliver Heaviside）和美国物理数学家约西亚 · 威拉德 · 吉布斯（Josiah Willard Gibbs）以矢量分析的形式重新表达，也就是现在我们使用的形式。

麦克斯韦方程组和洛伦兹力方程是经典电磁学的基础方程。从这些基础方程的相关理论，发展出现代的电力科技与电子科技。

它由 4 个方程组成：

*   **高斯定律**（Gauss' law）：描述电场与空间中电荷分布的关系。
*   **高斯磁定律**（Gauss's law for magnetism）：表明磁场的散度等于零，也就是说进入任何区域的磁场线，必需从该区域离开。
*   **法拉第定律**（Faraday's law）：描述时变磁场怎样感应出电场。
*   **麦克斯韦 - 安培定律**（Ampère's law with Maxwell's addition）：阐明磁场的产生方式有两种：一种是靠传导电流；另一种是靠时变电场，或称位移电流。

###  高斯定律（Gauss' law）

高斯定律表明在静电场中，穿过任一封闭曲面的电场通量只与封闭曲面内的电荷的代数和有关，且等于封闭曲面的电荷的代数和除以真空中的电容率。用积分形式表达的公式：

$$\Phi_{\boldsymbol E} = \frac{Q}{\varepsilon_0}$$

其中，$\Phi_E$ 是穿过封闭曲面的电场通量，$Q$ 是封闭曲面内的总电荷，$\varepsilon_0$ 是真空中的电容率。

若是更严谨一些，引入封闭曲面 $S$ 和及封闭曲面包含的体积 $V$，则有积分形式的公式：

$$\Phi_{\boldsymbol E} = \oint_{\boldsymbol S} \boldsymbol E\cdot dA$$

其中 $\boldsymbol E$ 是电场，$dA$ 是是封闭曲面的一块极小的面积，$\oint_S$ 表示封闭曲面面积，有些文献会写成 $\iiint_S$、$\iint_S$、$\int_S$，表达的都是曲面面积。

还可以用微分的形式表达：

$$\triangle \cdot \boldsymbol E = \frac{\rho}{\varepsilon_0}$$

其中 $\triangle \cdot \boldsymbol E$ 是电场散度，$\rho$ 是电荷密度。

由于微分形式是从微观层面描述的，从宏观维度上，可表达成：

$$D = \varepsilon \boldsymbol E$$

其中 $\boldsymbol D$ 表示电场散度，$\varepsilon$ 表示材质电容率，$\boldsymbol E$ 表示电场。此公式只适应与均匀、各向同性、非分散的线性物质。

###  高斯磁定律（Gauss's law for magnetism）

高斯磁定律表明磁场的散度等于零，因此磁场是一个螺线矢量场，还可以推断磁单极子不存在（下图）。磁的基本实体是磁偶极子，而不是磁荷。

![[1679148483414.png]]

用微分形式的公式：

$$\triangle \cdot \boldsymbol B = 0$$

$\triangle \cdot \boldsymbol B$ 表示磁场的散度。

同样地，可以用积分形式：

$$\newcommand{\oiint}{\bigcirc \hspace{-1.3em}\int \hspace{-0.8em}\int} \oiint_{\delta\Omega}\boldsymbol E \cdot d\boldsymbol S = \frac{1}{\varepsilon_0}\iiint_\Omega \rho dV$$

### 法拉第定律（Faraday's law）

法拉第定律描述时变磁场怎样感应出电场。在积分形式，它表明在闭环移动电荷所需的每单位电荷的工作量等于通过封闭表面的磁通量的减少速率。微分形式：

$$\Delta \times \boldsymbol E = -\frac{\delta \boldsymbol B }{\delta t }$$

积分形式：

$$\oint_{\delta \sum} \boldsymbol E \cdot d\boldsymbol l = -\frac{d}{dt}\iint_{\sum}\boldsymbol B \cdot d \boldsymbol S$$

### 麦克斯韦 - 安培定律（Ampère's law with Maxwell's addition）

麦克斯韦 - 安培定律表明，磁场的产生有两种：

*   靠传导电流，也就是原本的安培定律；
*   靠时变电场，也被称作位移电流，这点是麦克斯韦修正项所提出。

微分形式的公式：

$$\Delta \times \boldsymbol B = \mu_0\bigg(\boldsymbol J + \varepsilon_0\frac{\delta\boldsymbol E}{\delta t} \bigg)$$

积分形式复杂一些：

$$\oint_{\delta \sum} \boldsymbol B \cdot d\boldsymbol l = \mu_0\bigg(\iint_{\sum} \boldsymbol J \cdot d \boldsymbol S + \varepsilon_0\frac{d}{dt}\iint_{\sum}\boldsymbol E\cdot d \boldsymbol S \bigg)$$

由于标准的 $L_AT^EX$ 无法表示闭合曲面的符号，可能跟维基百科的有些出入，具体参看维基百科的麦克斯韦方程组。

##  几何光学基本定律的推导

几何光学有三条基本定律：

*   第一定律：入射波、反射波、折射波的波矢，与界面的法线共同包含于**入射平面**（下图）。
*   第二定律：反射角等于入射角。这定律称为**反射定律**。
*   第三定律：$n_{1}\sin \theta _{1}=n_{2}\sin \theta _{2}$，也叫**斯涅尔定律**或**折射定律**。

它们可以由麦克斯韦方程组推导出来。

![[1679148483452.png]]

光波是电磁辐射，必须满足麦克斯韦方程组与伴随的边界条件，其中一条边界条件为，在边界的临近区域，电场平行于边界的分量必须具有连续性。假设边界为 xy - 平面，则在边界，有：

$$E_{{||,i}}(x,y,0)+E_{{||,r}}(x,y,0)=E_{{||,t}}(x,y,0)$$

其中，$E_{{||,i}}$、 $E_{{||,r}}$、$E_{{||,t}}$ 分别为在入射波、反射波、折射波（透射波）的电场平行于边界的分量。

假设入射波是频率为 $\omega$ 的单色平面波，则为了在任意时间满足边界条件，反射波、折射波的频率必定为  $\omega$ 。设定 $E_{{||,i}}$、$E_{{||,r}}$、$E_{{||,t}}$ 的形式分别为

$E_{{||,i}}=E_{{||,i0}}\ e^{{i{\mathbf {k}}_{i}\cdot {\mathbf {r}}-\omega t}}$、

$E_{{||,r}}=E_{{||,r0}}\ e^{{i{\mathbf {k}}_{r}\cdot {\mathbf {r}}-\omega t}}$、

$E_{{||,t}}=E_{{||,t0}}\ e^{{i{\mathbf {k}}_{t}\cdot {\mathbf {r}}-\omega t}}$，

其中，$\mathbf{k}_i$、 ${\mathbf {k}}_{r}$、${\mathbf {k}}_{t}$ 分别是入射波、反射波、折射波的波矢，$E_{{||,i0}}$、$E_{{||,r0}}$、$E_{{||,t0}}$ 分别是入射波、反射波、折射波的波幅（可能是复值）。

为了在边界任意位置 $(x,y,0)$ 满足边界条件，相位变化必须一样，必须设定  
$k_{{ix}}x+k_{{iy}}y=k_{{rx}}x+k_{{ry}}y=k_{{tx}}x+k_{{ty}}y$。  
因此，

$k_{{ix}}=k_{{rx}}=k_{{tx}}$、  
$k_{{iy}}=k_{{ry}}=k_{{ty}}$。  
不失一般性，假设 $k_{{iy}}=k_{{ry}}=k_{{ty}}=0$，则立刻可以推断**第一定律成立**，入射波、反射波、折射波的波矢，与界面的法线共同包含于入射平面。

从波矢 x - 分量的相等式，可以得到

$k_{{i}}\sin \theta _{i}=k_{{r}}\sin \theta _{r}$。  
而在同一介质里，$k_{{i}}=k_{{r}}$。所以，**第二定律成立**，入射角 $\theta _{i}$ 等于反射角 $\theta _{r}$。

应用折射率 $n$ 的定义式：

$n\ {\stackrel {def}{=}}\ {\frac {c}{v}}={\frac {ck}{\omega }}$，  
可以推断**第三定律成立**：

$n_{i}\sin \theta _{i}=n_{t}\sin \theta _{t}$；  
其中，$n_{t}$、$\theta _{t}$ 分别是折射介质的折射率与折射角。

从入射波、反射波、折射波之间的相位关系，就可以推导出几何光学的三条基础定律。

此外，还可以用费马原理、惠更斯原理、平移对称性推导出来，更多参看维基百科的 Snell's Law。

# 8 色度学

辐射度量学存粹处理物理量，不考虑人类感知。相关领域 **光度学 (photometry)** 与辐射度量学相似，但它通过人眼的敏感性对所有物体进行加权。辐射计算结果通过乘以 CIE 光度曲线转换为广度单位，该曲线是以 555nm 为中心的钟形曲线，代表了眼睛对各种波长的光的响应。CIE 光度曲线如下所示。

![[c22f1643397ed1e815e772b3ea67c84f_MD5.jpg]]

光度学理论和辐射度量学理论之间唯一区别在于 CIE 光度曲线和测量单位。每个辐射度量都有一个相应的光度计量单位。下表显示了各自的名称和单位，这些单位都有预期的关系。

![[ff3ef5af7ed104536d3ef67e2dfc8a00_MD5.jpg]]

# 9 色度测量学

上面提到，人眼对光颜色的感知与光的 SPD 密切相关，并且这不是一个简单的一对一关系 (不同 SPD 的光可能被识别为相同颜色)。**色度测量学 (colorimetry)** 处理了光谱功率分布于颜色感知之间的关系。

人眼结构模型如下图。视网膜是感知光的地方，视网膜上存在感光细胞。感光细胞分为视杆细胞和视锥细胞。视杆细胞是一种棒状细胞，数量多，但只感知光的强度。视锥细胞是一种锥形细胞，数量少，用来感知光的颜色。不同人的视锥细胞分布非常不同。

![[2dc84aa2db10c51d6453e07f58f2aaff_MD5.jpg]]

**视锥细胞** 又分为 S, M, L 三种，用来感知不同波长的光。L 负责红色区间，M 负责绿色区间，S 负责蓝色区间。因此，对于给定 SPD，我们大脑只接受来自这些受体的三个不同信号。这就是为什么只需要 3 个数字就可以精确表示任何颜色刺激的原因。

![[be6d887fb1c399a93dd0e64b6720a815_MD5.jpg]]

为了找到这 3 个表示任何颜色刺激的 3 个数字，CIE (国际照明委员会) 提出了一组测量颜色的标准条件，并使用它们进行了色匹配实验。实验方式大致如下，观察者观察由三基色光源组合的光颜色，当组合颜色与光源颜色匹配时，则认为这三基色组合为该颜色。

![[7f87f455ec88e6f0fc4aae92b234e540_MD5.jpg]]

下图显示了称为 r, g, b 三基色的一组测试结果。

![[0bbb1ab0952f63fc100509124ab3f637_MD5.jpg]]

直接实验得到的 rgb 光源的加权不能直接用来表示所有可见颜色，因为它们的色匹配函数波长上存在负权重。CIE 提出三种假象光源，使得可见波长权重均为正值。这些曲线是原始 rgb 色匹配函数的线性组合。

 $\begin{align} r'&=\frac{r}{r+g+b}\\ g'&=\frac{g}{r+g+b}\\ b'&=\frac{b}{r+g+b} \end{align}$

严格来说，RGB 值代表的是感知量而不是物理量。在基于物理的渲染中使用它们在技术上是一个类别错误。正确的方法是使用光谱量进行所有渲染计算，可以通过密集采样或投影到适当基础上表示，只在最后将其转换为 RGB 颜色。

然而，对于大多数渲染系统，特别是那些用于交互式应用程序的系统，它们并不旨在产生预测性模拟，RGB 渲染效果出奇地好。即使在电影特效的离线渲染中，也只是最近开始使用光谱渲染，并且远未普及。
