# Numpy
NumPy 是使用 Python 进行科学计算的基础包。它包含如下的内容：

-   一个强大的N维数组对象。
-   复杂的（广播）功能。
-   用于集成C / C ++和Fortran代码的工具。
-   有用的线性代数，傅里叶变换和随机数功能。

除了明显的科学用途外，NumPy还可以用作通用数据的高效多维容器。可以定义任意数据类型。这使NumPy能够无缝快速地与各种数据库集成。

在这篇文章中，我们将介绍使用 NumPy 的基础知识，NumPy 是一个功能强大的 Python 库，允许更高级的数据操作和数学计算。
```python nums
#导入Numpy，通过写成这样的形式，之后 NumPy 相关的方法均可通过 np 来调用。
import numpy as np
```
# 数组基础

## 创建一个数组

NumPy 围绕这些称为数组的事物展开。实际上它被称之为 `ndarrays`，你不知道没事儿。使用 NumPy 提供的这些数组，我们就可以以闪电般的速度执行各种有用的操作，如矢量和矩阵、线性代数等数学运算！

```python nums
# 1D Array
a = np.array([0, 1, 2, 3, 4])
b = np.array((0, 1, 2, 3, 4))
c = np.arange(5)
d = np.linspace(0, 2*np.pi, 5)

print(a) # >>>[0 1 2 3 4]
print(b) # >>>[0 1 2 3 4]
print(c) # >>>[0 1 2 3 4]
print(d) # >>>[ 0.          1.57079633  3.14159265  4.71238898  6.28318531]
print(a[3]) # >>>3
```

上面的代码显示了创建数组的 4 种不同方法。**最基本的方法是将序列传递给 NumPy 的 array() 函数; 你可以传递任何序列（类数组），而不仅仅是常见的列表（list）数据类型。**
对数组进行索引就像列表或任何其他 Python 序列一样。你也可以对它们进行切片。

上面的数组示例是如何使用 NumPy 表示向量的，接下来我们将看看如何使用多维数组表示矩阵和更多的信息。

```python nums
# MD Array,
a = np.array([[11, 12, 13, 14, 15],
              [16, 17, 18, 19, 20],
              [21, 22, 23, 24, 25],
              [26, 27, 28 ,29, 30],
              [31, 32, 33, 34, 35]])
 
print(a[2,4]) # >>>25
```

为了创建一个 2D（二维）数组，我们传递一个列表的列表（或者是一个序列的序列）给 array() 函数。
如果我们想要一个 3D（三维）数组，我们就要传递一个列表的列表的列表，
如果是一个 4D（四维）数组，那就是列表的列表的列表的列表，以此类推。

请注意 2D（二维）数组（在我们的朋友空格键的帮助下）是如何按行和列排列的。要索引 2D（二维）数组，我们只需引用行数和列数即可。

##  多维数组切片

切片多维数组比 1D 数组复杂一点，并且在使用 NumPy 时你也会经常需要使用到。

```python nums
# MD slicing
print(a[0, 1:4]) # >>>[12 13 14]
print(a[1:4, 0]) # >>>[16 21 26]
print(a[::2,::2]) # >>>[[11 13 15]
                  #     [21 23 25]
                  #     [31 33 35]]
print(a[:, 1]) # >>>[12 17 22 27 32]
```

如你所见，通过对每个以逗号分隔的维度执行单独的切片，你可以对多维数组进行切片。因此，对于 2D 数组，我们的**第一片定义了行的切片，第二片定义了列的切片**。

注意，只需输入数字就可以指定行或列。上面的第一个示例从数组中选择第 0 列。

下面的图表说明了给定的示例切片是如何进行工作的。

![[1681625876015.png]]
## 访问元素
元素的索引从 0 开始。对各个元素的访问可按如下方式进行。
```python nums
>>> X = np.array([[51, 55], [14, 19], [0, 4]]) 
>>> print(X)
[[51 55]
 [14 19]
 [ 0  4]]
>>> X[0]    # 第 0行 
array([51, 55])
>>> X[0][1] # (0,1)的元素 
55
```

也可以使用 for 语句访问各个元素。
```python nums
>>> for row in X:
print(row)
...
[51 55] 
[14 19] 
[0 4]
```

除了前面介绍的索引操作，NumPy 还可以使用数组访问各个元素。
```python nums
>>> X = X.flatten()         # 将 X转换为一维数组 
>>> print(X)
[51 55 14 19  0  4]
>>> X[np.array([0, 2, 4])] # 获取索引为 0、2、4的元素 
array([51, 14,  0])
```
运用这个标记法，可以获取满足一定条件的元素。例如，要从 X 中抽出大于 15 的元素，可以写成如下形式。
```python nums
>>> X > 15
array([ True,  True, False,  True, False, False], dtype=bool) 
>>> X[X>15]
array([51, 55, 19])
```
##  数组属性

在使用 NumPy 时，你会想知道数组的某些信息。很幸运，在这个包里边包含了很多便捷的方法，可以给你想要的信息。

```python nums
# Array properties
a = np.array([[11, 12, 13, 14, 15],
              [16, 17, 18, 19, 20],
              [21, 22, 23, 24, 25],
              [26, 27, 28 ,29, 30],
              [31, 32, 33, 34, 35]])

print(type(a)) # >>><class 'numpy.ndarray'>
print(a.dtype) # >>>int64
print(a.size) # >>>25
print(a.shape) # >>>(5, 5)
print(a.itemsize) # >>>8
print(a.ndim) # >>>2
print(a.nbytes) # >>>200
```

正如你在上面的代码中看到的，NumPy 数组实际上被称为 ndarray。

数组的形状是它有多少行和列，上面的数组有 5 行和 5 列，所以它的形状是 (5，5)。

`itemsize`属性是每个项占用的字节数。这个数组的数据类型是 int 64，一个 int 64 中有 64 位，一个字节中有 8 位，除以 64 除以 8，你就可以得到它占用了多少字节，在本例中是 8。

`ndim` 属性是数组的维数。这个有 2 个。例如，向量只有 1。

`nbytes` 属性是数组中的所有数据消耗掉的字节数。你应该注意到，这并不计算数组的开销，因此数组占用的实际空间将稍微大一点。

#  使用数组
### 基本操作符


```python nums
# Basic Operators
a = np.arange(25)
a = a.reshape((5, 5))

b = np.array([10, 62, 1, 14, 2, 56, 79, 2, 1, 45,
              4, 92, 5, 55, 63, 43, 35, 6, 53, 24,
              56, 3, 56, 44, 78])
b = b.reshape((5,5))

print(a + b)
print(a - b)
print(a * b)
print(a / b)
print(a ** 2)
print(a < b) print(a > b)

print(a.dot(b))
```

除了 dot()点乘 之外，这些操作符都是对数组进行逐元素运算。比如 (a, b, c) + (d, e, f) 的结果就是 (a+d, b+e, c+f)。它将分别对每一个元素进行配对，然后对它们进行运算。它返回的结果是一个数组。
逻辑运算符 “<” 和 “>”，返回的是一个布尔型数组

dot() 函数计算两个数组的点积。它返回的是一个标量（只有大小没有方向的一个值）而不是数组。

这里需要注意的是，数组 x 和数组 y 的元素个数是相同的（两者均是元素个数为 3 的一维数组）。
- 当 x 和 y 的元素个数相同时，可以对各个元素进行算术运算。
- 如果元素个数不同，程序就会报错
- NumPy 数组还可以和单一标量进行运算，这个功能也被称为**广播**。
```python nums
>>> x = np.array([1.0, 2.0, 3.0]) 
>>> x / 2.0
array([ 0.5,  1. ,  1.5])
```

### 广播
NumPy 中，**形状不同的数组之间也可以进行运算**。之前的例子中，在 2×2 的矩阵 A 和标量 10 之间进行了乘法运算。在这个过程中，如图 1-1 所示，标量 10 被扩展成了 2 × 2 的形状，然后再与矩阵 A 进行乘法运算。这个巧妙的功能称为**广播（broadcast）**。
![[Pasted image 20230418224226.png]]
```python nums
>>> A = np.array([[1, 2], [3, 4]]) 
>>> B = np.array([10, 20])
>>> A * B
array([[ 10, 40], 
       [ 30, 80]])
```
在这个运算中，如图 1-2 所示，一维数组 B 被“巧妙地”变成了和二维数 组 A 相同的形状，然后再以对应元素的方式进行运算。综上，因为 NumPy 有广播功能，所以不同形状的数组之间也可以顺利地进行运算。
### 数组特殊运算符

```python nums
# dot, sum, min, max, cumsum
a = np.arange(10)

print(a.sum()) # >>>45
print(a.min()) # >>>0
print(a.max()) # >>>9
print(a.cumsum()) # >>>[ 0  1  3  6 10 15 21 28 36 45]
```

`sum()`、`min()` 和 `max()` 函数的作用非常明显。将所有元素相加，找出最小和最大元素。

然而，`cumsum()` 函数就不那么明显了。它将像 sum() 这样的每个元素相加，但是它首先将第一个元素和第二个元素相加，并将计算结果存储在一个列表中，然后将该结果添加到第三个元素中，然后再将该结果存储在一个列表中。这将对数组中的所有元素执行此操作，并返回作为列表的数组之和的运行总数。
## 类型转换
 `astype()` 方法转换 NumPy 数组的类型。
 `astype()` 方法通过参数指定期望的类型，这个例子中是 np. int 型。Python 中将 bool 型转换为 int 型后，True 会转换为 1，False 会转换为 0。
```python nums
>>> y
array([False,  True,  True], dtype=bool)
>>> y = y.astype(np.int) 
>>> y
array([0, 1, 1])
```
##  索引进阶

###  花式索引

`花式索引` 是获取数组中我们想要的特定元素的有效方法。

```python nums
# Fancy indexing
a = np.arange(0, 100, 10)
indices = [1, 5, -1]
b = a[indices]
print(a) # >>>[ 0 10 20 30 40 50 60 70 80 90]
print(b) # >>>[10 50 90]
```

正如你在上面的示例中所看到的，我们使用我们想要检索的特定索引序列对数组进行索引。这反过来返回我们索引的元素的列表。

###  布尔屏蔽

布尔屏蔽是一个有用的功能，它允许我们根据我们指定的条件检索数组中的元素。

```python nums
# Boolean masking
import matplotlib.pyplot as plt

a = np.linspace(0, 2 * np.pi, 50)
b = np.sin(a)
plt.plot(a,b)
mask = b >= 0
plt.plot(a[mask], b[mask], 'bo')
mask = (b >= 0) & (a <= np.pi / 2)
plt.plot(a[mask], b[mask], 'go')
plt.show()
```

上面的示例显示了如何进行布尔屏蔽。你所要做的就是将数组传递给涉及数组的条件，它将为你提供一个值的数组，为该条件返回 true。

该示例生成以下图：

![[1681625876478.png]]

我们利用这些条件来选择图上的不同点。蓝色点 (在图中还包括绿点，但绿点掩盖了蓝色点)，显示值大于 0 的所有点。绿色点表示值大于 0 且小于一半π的所有点。

### 缺省索引

不完全索引是从多维数组的第一个维度获取索引或切片的一种方便方法。例如，如果数组 `a=[1，2，3，4，5]，[6，7，8，9，10]`，那么 `[3]` 将在数组的第一个维度中给出索引为 3 的元素，这里是值 4。

```python nums
# Incomplete Indexing
a = np.arange(0, 100, 10)
b = a[:5]
c = a[a >= 50]
print(b) # >>>[ 0 10 20 30 40]
print(c) # >>>[50 60 70 80 90]
```

###  Where 函数

`where()` 函数是另外一个根据条件返回数组中的值的有效方法。只需要把条件传递给它，它就会返回一个使得条件为真的元素的列表。

```python nums
# Where
a = np.arange(0, 100, 10)
b = np.where(a < 50) 
c = np.where(a >= 50)[0]
print(b) # >>>(array([0, 1, 2, 3, 4]),)
print(c) # >>>[5 6 7 8 9]
```




# Matpoltlib
在深度学习的实验中，图形的绘制和数据的可视化非常重要。Matplotlib 是用于绘制图形的库，使用 Matplotlib 可以轻松地绘制图形和实现数据的可视化。这里，我们来介绍一下图形的绘制方法和图像的显示方法。

## 绘制简单图形
可以使用 matplotlib 的 pyplot 模块绘制图形。话不多说，我们来看一个绘制 sin 函数曲线的例子。
```python nums
import numpy as np  
import matplotlib.pyplot as plt  
  
# 生成数据  
x = np.arange(0, 6, 0.1) # 以 0.1为单位，生成 0到 6的数据  
y1 = np.sin(x)  
y2 = np.cos(x)  
  
# 绘制图形  
plt.plot(x, y1, label="sin")  
plt.plot(x, y2, linestyle="--", label="cos") # 用虚线绘制  
plt.xlabel("x") # x轴标签  
plt.ylabel("y") # y轴标签  
plt.title('sin & cos') # 标题  
plt.legend()  
plt.show()
```
![[Pasted image 20230418225800.png]]
## 显示图像
pyplot 中还提供了用于显示图像的方法 `imshow ()`。
可以使用 matplotlib. image 模块的 `imread ()` 方法读入图像。
```python nums
import matplotlib.pyplot as plt  
from matplotlib.image import imread  
  
img = imread('lena.png') # 读入图像（设定合适的路径！）  
plt.imshow(img)  
plt.show()
```
