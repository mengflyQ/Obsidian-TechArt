---
title: "Gaussian Frosting: Editable Complex Radiance Fields with Real-Time Rendering"
uid: "202404072138"
create_time: 2024-04-04 23:04
title translation: 高斯糖霜：实时渲染的可编辑复杂辐射场
grade: 
author: Antoine Guédon
date: 
DOI: 
url:
  - https://anttwo.github.io/frosting/
banner: "[[Pasted image 20240407213942.png]]"
---

> [!abstract] 
我们提出了 Gaussian Frosting，这是一种新的基于网格的表示，用于实时高质量渲染和编辑复杂的 3D 效果。我们的方法建立在最近的 3D 高斯泼溅框架的基础上，该框架优化了一组 3D 高斯以近似图像的辐射场。  
**我们建议在优化期间首先从高斯中提取基础网格，然后在网格周围构建和细化具有可变厚度的自适应高斯层，以更好地捕捉表面附近的精细细节（fine details）和体积效果**，例如头发或草。我们将这一层称为**高斯糖霜**，因为它类似于蛋糕上的糖霜涂层。材质越绒软（fuzzier，毛发柔软卷曲的），糖霜就越厚。  **我们还引入了高斯参数化以强制它们留在糖霜层内，并在变形、重新缩放、编辑或对网格动画处理时自动调整其参数。**  
我们的表示允许使用高斯泼溅进行高效渲染，以及通过修改基础网格进行编辑和动画。我们证明了我们的方法在各种合成和真实场景上的有效性，并表明它优于现有的基于表面的方法。我们将发布我们的代码和基于网络的查看器作为额外的贡献。
> 
>**Keywords:** Gaussian Splatting Mesh Differentiable rendering

![[Pasted image 20240407224738.png]]
>图 1：我们提出通过覆盖有由 3D 高斯构成的不同厚度的“糖霜”层的网格来表示表面。  这种表示捕捉了由猫的头发或草等绒软材质以及平坦表面产生的复杂体积效果。它仅由 RGB 图像构建，可以使用传统动画工具进行实时渲染和动画处理。在上面的示例中，我们能够为 Buzz 和小猫制作动画，改变它们的原始姿势 (a)，同时保留高质量渲染 (b)：与 SuGaR 不同，可以看到非常精细的绒毛/草的细节，例如小猫的头发以逼真的方式覆盖巴兹的腿 (c)。
# 1 简介
3DGS 最近征服了 3D 重建和基于图像的渲染（IBR）领域。通过用大量微小高斯表示场景，3DGS 可以快速重建和渲染，同时很好地捕捉精细细节和复杂的灯光效果。与早期的神经渲染方法（例如 NeRFs）相比，3DGS 在重建和渲染阶段都更加高效。
然而，与 NeRF 一样，原版 3DGS 不允许对重建场景进行简单编辑。高斯是非结构化的，彼此分离，并且不清楚设计师如何操纵它们，例如为场景设置动画。最近，SuGaR 展示了如何从 3DGS 的输出中提取网格。然后，通过限制高斯留在网格上，可以使用传统的计算机图形工具来编辑场景以操纵网格。但通过将高斯扁平化（flattening）到到网格上，SuGaR 失去了 3DGS 用于绒软材质和体积效果可能达到的渲染质量。在本文中，我们介绍了**高斯糖霜（后文简称糖霜或Frosting）**，它是 3D 场景的混合表示，可作为网格进行编辑，同时提供至少与 3DGS 相当、有时优于 3DGS 的渲染质量。

**糖霜的关键思想是用包含高斯的层来扩充（augment）网格。糖霜层的厚度会根据场景的材质进行局部调整**：对于平坦的表面，该层应较薄，以避免出现不良的体积效果；对于绒软材质，该层应较厚，以实现真实感渲染，如图 2 所示，使用 Frosting 表示，我们不仅可以检索高精度的可编辑网格，还可以实时渲染复杂的体积效果。
![[Pasted image 20240407225147.png]]
>图 2：示例中磨砂层厚度的可视化。较厚的层显示为较亮的值。我们的方法会自动为绒软区域（例如小熊猫毛绒的毛皮）构建厚的磨砂层，并为桌子或地板等平坦表面自动构建薄的磨砂层。  
调整磨砂层的厚度可以在表面附近需要更多体积渲染的区域分配更多高斯，从而在场景中实现高斯的有效分布。  正如我们在论文中所演示的，使用自适应厚度比使用预定义的恒定厚度可以获得更高的性能，并减少网格动画时的伪影。

**糖霜让人想起自适应壳表示（Adaptive Shells）[40]，它依赖于从有向距离场（SDF） 中提取的两个显式三角形网格来控制体积效果。  尽管如此，糖霜将优于自适应壳的渲染质量与 3DGS 重建和渲染的速度效率结合在一起，同时由于它依赖于单个网格而易于编辑。**

虽然糖霜表示很简单，但**定义糖霜层的局部厚度具有挑战性**。  **为了提取网格，我们本质上依赖于 SuGaR，我们使用一种技术（在补充材料中描述）对其进行了改进，以自动调整关键超参数。**  

> [!NOTE] 补充材料
> Contents

为了估计糖霜厚度，我们引入了一种方法，根据 3DGS 最初检索到的网格周围的高斯，定义该网格每个顶点处糖霜层的内外边界。 
最后，我们用随机采样的高斯填充糖霜层，并优化这些限制在层内的高斯。我们还提出了一种简单的方法，可以在网格动画时自动地实时调整高斯的参数。

总之，我们提出了一种简单但功能强大的表面表示，可以捕获复杂的体积效果，可以使用传统工具进行编辑，并且可以实时渲染。我们还提出了一种基于高斯泼溅最新进展的从图像构建这种表示的方法。作为额外贡献，我们将发布我们的代码，包括可在浏览器中使用的查看器。


![[Pasted image 20240407225525.png]]
>图 3：场景组合。使用 Blender 中的网格编辑工具，我们能够组合多个场景 (a) 中的各种元素来构建一个全新的场景 (c)。我们还使用 Blender 中的索具工具（rigging tool）改变了角色的姿势 (b)。与 SuGaR  等基于表面的方法类似，Frosting 可用于编辑和合成场景，但可以更好地渲染复杂的体积效果和绒软材质，例如头发或草。

# 2 相关工作
基于图像的渲染 (IBR) 目标是从给定的一组图像创建场景的表示，以便生成场景的新图像。人们已经提出了不同类型的场景表示，从显式和可编辑的（如三角形网格或点云）到隐式或不可编辑的（如体素网格、多平面图像或神经隐式函数）。
**体积 IBR 方法**： IBR 的最新突破是神经辐射场 (NeRF) ，它使用多层感知机(MLP) 来模拟密度和颜色的连续体积函数。 NeRF 可以通过使用体积光线步进来渲染具有高质量和视角相关效果的新视图。然而，NeRF 速度慢且内存消耗大。有几项工作试图通过使用离散体积表示（如体素网格和哈希表）来存储可学习的特征来提高 NeRF 的效率和训练速度，这些特征可作为更小的 MLP 的输入 [5,15,24,37,45]，或者改进通过使用分层采样策略来提高渲染性能[2,13,29,46]。其他作品还建议修改 NeRF 的辐射度表示，并包含显式光照模型，以提高具有镜面材质的场景的渲染质量 [38,3,21,36,47]。然而，大多数体积方法依赖于隐式表示，与三角形网格相比，这些隐式表示不适合编辑，而大多数标准图形硬件和软件都是针对三角形网格定制的。

**基于表面的 IBR 方法**：在从运动恢复结构 (SfM) [ 35] 和多视图立体 (MVS) [ 10] 启用表面 3D 重建之后，三角形网格已成为一种流行的 3D 表示，用于生成场景的新视图 [41,4,12] 。基于深度学习的网格表示[30, 31]也已被用于使用显式表面网格来改进视图合成；然而，尽管基于网格的方法可以实现非常高效的渲染，但它们在捕获复杂且非常精细的几何形状以及绒软材质方面遇到了困难。

**混合 IBR 方法**：一些方法使用混合体积表示来恢复适合下游图形应用程序的表面网格，同时有效地建模依赖于视图的外观。具体来说，一些工作优化了神经辐射场，其中密度被隐式有向距离场 SDF 取代，这为底层几何提供了更强的正则化（regularization）[25,42,39,22,9,8]。然而，这些方法大多数都不是针对实时渲染的。为了缓解这个问题，其他方法通过在使用专用的依赖于视图的外观模型优化后将渲染计算“烘焙”到提取的网格中来大大加速渲染[7,43,28]。尽管这些基于表面的方法在优化期间使用由 MLP 表示的体积函数对表面进行编码，但与体积方法相比，它们在捕获精细细节或模糊材料方面存在困难。

**自适应壳（Adaptive Shells）**[40]是一种最新的方法，它通过使用真正的混合表面体积方法将 NeRF 的体积渲染限制在对象周围的薄层，从而显着提高了渲染质量。**该层由两个显式网格界定**，这些网格是在优化基于 SDF 的辐射场后提取的。与单个平面网格相比，该层的可变厚度还提高了渲染质量。该方法通过操作定义了层的两个显式网格，将全体积方法的高质量渲染与基于表面的方法的可编辑性结合起来。然而，自适应壳依赖于神经 SDF [39]，其在重建精确表面的能力方面存在一些限制，并且需要超过 8 个小时来优化单个合成场景，这比最近的高斯泼溅方法要长得多。

**高斯泼溅**。高斯溅射 [17] 是一种新的体积表示，其灵感来自基于点云的辐射场 [20, 32]，它的优化速度非常快，并且允许以非常好的质量进行实时渲染。其最大的优势之一是其显式的 3D 表示，这使得编辑任务成为可能，因为每个高斯单独存在，并且可以轻松地实时调整。一些外观编辑和分割方法已经被提出[6,14,18,44]，但是点云中缺乏结构使得 3D 艺术家或动画师几乎不可能轻松地修改、雕刻或添加动画。三角形网格仍然是这些应用的标准 3D 结构。最近的一项工作 SuGaR [11] 通过将高斯与曲面对齐并从中提取网格来扩展此框架。高斯最终被展平并固定在网格的表面上，这提供了一种将网格的可编辑性与高斯泼溅的高质量渲染相结合的混合表示。然而，SuGaR 仍然是基于表面的表示，在重建和渲染绒软材料和体积效果方面的能力有限，导致与原生高斯泼溅相比性能下降。

# 3 3DGS 和表面重建

我们的方法依赖于原始的 3D 高斯分布 (3DGS) 方法 [17] 进行初始化，并依赖 SuGaR [11] 将高斯与场景表面对齐并促进网格的提取。我们在本节中简要描述 3DGS 和 SuGaR，然后在下一节中描述我们的方法。

## 3.1 3D 高斯分布

3DGS 将场景表示为一组高斯。每个高斯 $g$ 都配有均值 $\mu_g∈ℝ^3$ 和正定协方差矩阵 $\Sigma_g∈ℝ^{3×3}$ 。协方差矩阵由缩放向量 $s_g∈ℝ^3$ 和编码高斯旋转的四元数 $q_g∈ℝ4$ 参数化。

此外，每个高斯都有一个由不透明度 $\alpha_g∈[0,1]$ 表示的与视图相关的辐射率和一组定义向所有方向发射的颜色的球谐坐标。为了从给定的视点渲染图像，光栅化器将 3D 高斯“泼溅”为平行于图像平面的 2D 高斯分布，并根据分布的不透明度和深度来混合这些分布。  这种渲染速度非常快，这是 3DGS 相对于 NeRF 中的体积渲染的优势之一，例如 [23,24,2]。

高斯泼溅可以看作是辐射场的传统体积渲染的近似，其密度函数 $d$ 计算公公式为：
$$
d(p)=\sum_g\alpha_g\exp\left(-\frac{1}{2}(p-\mu_g)^T\Sigma_g^{-1}(p-\mu_g)\right)\tag{1}

$$

**我们使用原版 3DGS 优化来初始化高斯糖霜方法：使用 SfM [35] 算法（如 COLMAP [34, 33]）生成的点云来初始化高斯，需要计算相机位姿。然后，使用仅由像素级 L1 距离和结构性更强的 D-SSIM 项组合而成渲染 loss，对高斯参数（3D 均值（means）、缩放向量、四元数、不透明度和球谐坐标）进行优化，以使渲染图像与 GT 相匹配。**


## 3.2 SuGaR 网格提取
原版 3DGS 没有明确鼓励高斯与场景的真实表面对齐的正则化项。我们的高斯糖霜表示依赖于近似该表面的网格，以便可以通过传统工具进行编辑。**为了获得这个网格，我们依靠 SuGaR [11] 中提出的方法，并通过自动选择关键超参数来改进该方法。**

SuGaR 提出了一个正则化项，鼓励在高斯泼溅的优化期间将 3D 高斯与场景的真实表面对齐，还提出了一个网格提取方法。执行正则化后，优化提供的高斯大部分与表面对齐，尽管并不完美：**我们注意到，在实践中，正则化高斯与提取的网格之间存在较大差异**，表明存在需要体积渲染的绒软材质或表面。  **因此，我们利用这种差异作为评估糖霜应该更厚的地方的线索。**

## 4 从图像创建糖霜层


在本节中，我们将描述高斯糖霜创建方法：首先，我们使用 SuGaR 提取具有最佳分辨率的可编辑表面。然后，我们详细介绍如何使用这个基于表面的模型返回到围绕网格构建的**体积但可编辑的表示（volumetric but editable representation）**。  这种表示适应场景的复杂性及其对更多体积效果的需求。最后，我们描述如何参数化和细化这种表示。图 4 提供了概述。

![[Pasted image 20240408092707.png]]
>图 4：**创建一层高斯糖霜**。为了构建我们提出的 Frosting 表示，我们首先使用渲染 loss 优化高斯泼溅表示，而无需任何额外的约束，让高斯自己定位。我们将这些高斯称为**无约束高斯（unconstrained）**。然后，我们对这些高斯进行正则化，以强制它们与表面对齐，并提取一个网格作为 Frosting 的基础。 
>
接下来，我们使用**表面对齐高斯（称为正则化高斯 regularized）** 的对齐偏差（misalignment）来识别需要更多体积渲染的区域，并围绕网格的顶点 $v_i$ → 构建搜索间隔 $J_i$ 。最后，我们使用无约束高斯的密度函数来**细化间隔**，从而产生糖霜层。我们最终在层内采样了一组新的、致密的高斯。

### 4.1 forward 前向过程：从体积到曲面
We start by optimizing an unconstrained Gaussian Splatting representation for a short period of time to let Gaussians position themselves. We will refer to such Gaussians as _unconstrained_. We save these Gaussians aside, and apply the regularization term from SuGaR to enforce the alignment of the Gaussians with the real surface. We will refer to these Gaussians as _regularized_.  
我们首先在短时间内优化无约束的高斯泼溅表示，让高斯自行定位。我们将此类高斯称为**无约束高斯（unconstrained）**。我们将这些高斯函数放在一边，并应用 SuGaR 中的正则化项来强制高斯与真实表面的对齐。我们将这些高斯函数称为**正则化高斯（regularized）**。

一旦我们获得了正则化高斯，我们就可以从高斯泼溅表示中提取表面网格。该表面网格作为我们表示的基础。像 SuGaR [11] 一样，我们然后在高斯泼溅密度函数的可见水平集（visible level set）上采样点，并应用泊松重建。
 
**在补充材料中，我们描述了自动估计泊松重建所使用的一个关键超参数（即八叉树深度 $D$ ）的良好值（good value）的技术**。正如我们将在实验部分中展示的那样，在应用泊松重建时为 $D$ 选择正确的值可以极大地提高网格质量和模型的渲染性能。图 5 说明了这一点。
![[Pasted image 20240408095425.png]]
>图 5：SuGaR 从 Shelly 数据集中提取的网格的比较，根据场景的复杂程度，我们可以自动调整泊松重建中的八叉树深度 D。 。我们的技术（底部）极大地减少了许多场景的表面伪影，例如使用 [11]中的默认值时表面上的孔和椭圆体凹凸。


### 4.2 backward 反向过程：从曲面到体积

提取基础网格后，我们构建一个厚度可变、在该网格周围包含高斯的糖霜层。我们希望该层在表面附近需要更多体积渲染的区域更厚，例如头发或草等绒软材质。相反，该层在场景中与明确的平坦表面（例如木材或塑料）对应的部分附近应该非常薄。

![[Pasted image 20240408100849.png]] 
>图 6：我们如何定义糖霜层的内外边界。参见第 4.2 节中的文字。

如图 6 所示，为了定义该层，我们为提取的基础网格 $M$ 的每个顶点 $v_i$ 引入两个值 $\delta_i^{\mathrm{in}}$ 和 $\delta_i^{\mathrm{out}}$ 。这给出了两个分别具有顶点 $(\boldsymbol{v}_i+\delta_i^\mathrm{in}\boldsymbol{n}_i)_i$ 和 $(\boldsymbol{v}_i+\delta_i^\mathrm{out}\boldsymbol{n}_i)_i$ 的曲面，其中 $n_i$ 是顶点 $v_i$ 处的网格法线。这两个表面定义了磨砂层的内外边界。请注意，我们不必显式构建它们，因为它们直接依赖于基础网格以及  $\delta_i^{\mathrm{in}}$ 和 $\delta_i^{\mathrm{out}}$  。 
**为了找到  $\delta_i^{\mathrm{in}}$ 和 $\delta_i^{\mathrm{out}}$  的良好值，我们最初尝试直接使用无约束高斯，即在应用 SuGaR 正则化项之前获得的高斯**。不幸的是，如果没有正则化，即使对于“非绒软”表面，高斯泼溅也倾向于检索厚的高斯层，这将导致  $\delta_i^{\mathrm{in}}$ 和 $\delta_i^{\mathrm{out}}$  的值过大。此外，无约束高斯通常包含许多透明漂浮物（floater）和其他离群高斯（outlier）。这种高斯也可能使偏移偏向不必要的大值。
**另一方面，仅使用正则化高斯函数**来设置  $\delta_i^{\mathrm{in}}$ 和 $\delta_i^{\mathrm{out}}$  可能会错过绒软区域，因为这些高斯通过正则化变得更加平坦。
**因此，我们的解决方案是考虑无约束高斯和正则化高斯。** 更确切地说，我们通过寻找无约束高斯的等值面，根据它们的厚度来估计糖霜层厚度，但是为了确保我们考虑接近场景表面的等值面，我们搜索接近正则化高斯的等值面：即使在受 SuGaR 正则化项的影响，高斯模型与具有绒软细节的表面周围的几何形状也不能很好地对齐。  **因此，正则化高斯的局部厚度可以指示材料的绒软程度。**

图 6 说明了我们如何修复   $\delta_i^{\mathrm{in}}$ 和 $\delta_i^{\mathrm{out}}$  ：
- 为了限制搜索，我们为每个顶点 $v_i$ 定义第一个区间 $I_i=[-3\sigma_i,3\sigma_i]$ ，其中 $\sigma_i$ 是最接近 $v_i$ 的正则化高斯在 $n_i$ 正方向上的标准差。
-  $I_i$ 是 $t$ 的 1D 高斯函数沿法线的 99.7 置信水平的置信区间。绒软部分通常会导致较大的 $I_i$ 。我们可以使用  $I_i$  来限制对无约束高斯等值面的搜索。**通过在  $I_i$  内沿 $n_i$ 查找正则化高斯函数的等值面，可以获得更可靠的搜索区间 $J_i$ ：**
$$
\epsilon_i^\mathrm{in}=\inf(T),\epsilon_i^\mathrm{out}=\sup(T),\text{其中}T=\{t\in I_i|d_r(\boldsymbol{v}_i+t\boldsymbol{n}_i)\geq\lambda\}\tag{2}
$$
其中，$d_r$ 是公式 (1) 中定义的正则化高斯的密度函数。在实践中，我们使用等值面水平 $\lambda=0.01$ ，即接近于零。

- **最后，我们可以将内部和外部移位   $\delta_i^{\mathrm{in}}$ 和 $\delta_i^{\mathrm{out}}$  计算为：**$$
\delta_i^\mathrm{in}=\inf(V),\delta_i^\mathrm{out}=\sup(V),\text{其中}V=\{t\in J_i|d_u(\boldsymbol{v}_i+t\boldsymbol{n}_i)\geq\lambda\}\tag{3}
$$
- 使用 $\epsilon_{i}^{\mathrm{in}}$ 和 $\epsilon_{i}^{\mathrm{out}}$ 定义区间 $J_{i}\colon J_{i}=\begin{bmatrix}\epsilon_{i}^{\mathrm{mid}}-k\epsilon_{i}^{\mathrm{half}},\epsilon_{i}^{\mathrm{mid}}+k\epsilon_{i}^{\mathrm{half}}\end{bmatrix}$ ，其中 $\displaystyle \epsilon_{i}^{\mathrm{mid}}=\frac{\epsilon^{\mathrm{in}}+\epsilon^{\mathrm{out}}}{2}\mathrm{，}\epsilon_{i}^{\mathrm{half}}=\frac{\epsilon^{\mathrm{out}}-\epsilon^{\mathrm{in}}}{2}$ 。
- 我们取 $k=3$ ，因为它给出的区间足够大，可以包含大多数无约束高斯，同时拒绝离群高斯。

![[Pasted image 20240408110941.png]]
>图 7：使用高斯糖霜渲染复杂场景。
> - 第一行：渲染
> - 第二行：恢复的法线贴图
> - 第三行：估计的糖霜厚度。请注意，正如预期的那样，头发和草等绒软材质上的糖霜很厚，而第四列桌子等平坦表面上的糖霜则非常薄。

## 4.3 糖霜优化
一旦我们构建了糖霜层的内外边界，我们就初始化该层内的一组密集高斯，并使用 3DGS 渲染 loss 对其进行优化作为无约束高斯。  

为了确保高斯在优化期间留在糖霜层内，我们引入了新的高斯参数化（parameterization）。此外，这种参数化可以在编辑场景时轻松调整高斯参数。


###  4.3.1 参数化 parameterization

让我们考虑基础网格 ℳ 的三角形面，其顶点由 �→0,�→1 和 �→2 及其相应的法线 �→0,�→1 表示，和 �→2 。从无约束高斯函数中提取内部和外部位移后，我们获得了六个新顶点 (�→�+��in⁢�→�)�=0,1,2 和 (�→�+��out⁢�→�)�=0,1,2 ，它们分别属于磨砂的内部和外部边界。具体来说，这六个顶点界定出一个不规则三棱柱。我们将这种多面体称为“棱柱形细胞”。我们参数化位于棱柱形单元内的高斯 �∈𝒢 的 3D 平均值 ��∈ℝ3 ，其中一组六个重心坐标分为两个子集 (��(�))�=0,1,2 和 (��(�))�=0,1,2